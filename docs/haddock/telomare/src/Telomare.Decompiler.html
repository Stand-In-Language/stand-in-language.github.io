<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.Decompiler</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html"><span class="hs-identifier">Control.Comonad.Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator">(:&lt;)</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM2</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Max</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileUPT"><span class="hs-identifier hs-type">decompileUPT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-14"></span><span id="decompileUPT"><span class="annot"><span class="annottext">decompileUPT :: UnprocessedParsedTerm -&gt; String
</span><a href="Telomare.Decompiler.html#decompileUPT"><span class="hs-identifier hs-var hs-var">decompileUPT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679207931"><span class="annot"><span class="annottext">lineLimit :: Integer
</span><a href="#local-6989586621679207931"><span class="hs-identifier hs-var hs-var">lineLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">120</span></span><span>
</span><span id="line-16"></span><span>      </span><span class="hs-comment">-- &quot;hello&quot;</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="#local-6989586621679207932"><span class="hs-identifier hs-type">showS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State.State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-18"></span><span>      </span><span id="local-6989586621679207932"><span class="annot"><span class="annottext">showS :: String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var hs-var">showS</span></a></span></span><span> </span><span id="local-6989586621679207933"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207933"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679207935"><span class="annot"><span class="annottext">indent :: Int
</span><a href="#local-6989586621679207935"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207933"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207935"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity () -&gt; State Int String -&gt; State Int String
forall a b.
StateT Int Identity a
-&gt; StateT Int Identity b -&gt; StateT Int Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207933"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-19"></span><span>      </span><span id="local-6989586621679207948"><span class="annot"><span class="annottext">drawIndent :: State Int String
</span><a href="#local-6989586621679207948"><span class="hs-identifier hs-var hs-var">drawIndent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
-&gt; (Int -&gt; State Int String) -&gt; State Int String
forall a b.
StateT Int Identity a
-&gt; (a -&gt; StateT Int Identity b) -&gt; StateT Int Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679207950"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207950"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State Int String) -&gt; String -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207950"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>      </span><span id="local-6989586621679207960"><span class="annot"><span class="annottext">drawList :: [State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var hs-var">drawList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall a b.
(a -&gt; b) -&gt; StateT Int Identity a -&gt; StateT Int Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">(StateT Int Identity [String] -&gt; State Int String)
-&gt; ([State Int String] -&gt; StateT Int Identity [String])
-&gt; [State Int String]
-&gt; State Int String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span>
</span><span id="line-21"></span><span>      </span><span id="local-6989586621679207963"><span class="annot"><span class="annottext">needsParens :: UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679207963"><span class="hs-identifier hs-var hs-var">needsParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-comment">-- will need parens if on right side of application</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="Telomare.html#AppUP"><span class="hs-identifier hs-type">AppUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="Telomare.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="Telomare.html#LeftUP"><span class="hs-identifier hs-type">LeftUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="Telomare.html#RightUP"><span class="hs-identifier hs-type">RightUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="Telomare.html#TraceUP"><span class="hs-identifier hs-type">TraceUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="Telomare.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="Telomare.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-30"></span><span>      </span><span id="local-6989586621679207971"><span class="annot"><span class="annottext">needsFirstParens :: UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679207971"><span class="hs-identifier hs-var hs-var">needsFirstParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="Telomare.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="Telomare.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="Telomare.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-35"></span><span>      </span><span id="local-6989586621679207972"><span class="annot"><span class="annottext">drawParens :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207972"><span class="hs-identifier hs-var hs-var">drawParens</span></a></span></span><span> </span><span id="local-6989586621679207973"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207973"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679207963"><span class="hs-identifier hs-var">needsParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207973"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-36"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207973"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207973"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-38"></span><span>      </span><span id="local-6989586621679207975"><span class="annot"><span class="annottext">drawFirstParens :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207975"><span class="hs-identifier hs-var hs-var">drawFirstParens</span></a></span></span><span> </span><span id="local-6989586621679207976"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207976"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679207971"><span class="hs-identifier hs-var">needsFirstParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207976"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-39"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207976"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-40"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207976"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-41"></span><span>      </span><span class="annot"><a href="#local-6989586621679207974"><span class="hs-identifier hs-type">draw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State.State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-42"></span><span>      </span><span id="local-6989586621679207974"><span class="annot"><span class="annottext">draw :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var hs-var">draw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-43"></span><span>          </span><span class="annot"><a href="Telomare.html#VarUP"><span class="hs-identifier hs-type">VarUP</span></a></span><span> </span><span id="local-6989586621679207978"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207978"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207978"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-44"></span><span>          </span><span class="annot"><a href="Telomare.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span id="local-6989586621679207979"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207979"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679207980"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207980"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679207981"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207981"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207979"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; then &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207980"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; else &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207981"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-45"></span><span>          </span><span class="annot"><a href="Telomare.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679207982"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207982"><span class="hs-identifier hs-var">firstName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679207983"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207983"><span class="hs-identifier hs-var">firstDef</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679207984"><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679207984"><span class="hs-identifier hs-var">bindingsXS</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679207985"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207985"><span class="hs-identifier hs-var">in_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679207984"><span class="hs-identifier hs-var">bindingsXS</span></a></span><span>
</span><span id="line-46"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207982"><span class="hs-identifier hs-var">firstName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207983"><span class="hs-identifier hs-var">firstDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207985"><span class="hs-identifier hs-var">in_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-48"></span><span>            </span><span id="local-6989586621679207987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207987"><span class="hs-identifier hs-var">startIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-49"></span><span>            </span><span id="local-6989586621679207988"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207988"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let &quot;</span></span><span>
</span><span id="line-50"></span><span>            </span><span id="local-6989586621679207989"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">startBind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-51"></span><span>            </span><span id="local-6989586621679207990"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207982"><span class="hs-identifier hs-var">firstName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207983"><span class="hs-identifier hs-var">firstDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679207996"><span class="annot"><span class="annottext">drawOne :: (String, UnprocessedParsedTerm) -&gt; State Int String
</span><a href="#local-6989586621679207996"><span class="hs-identifier hs-var hs-var">drawOne</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679207997"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207997"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679207998"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207998"><span class="hs-identifier hs-var">upt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-53"></span><span>                  </span><span class="annot"><span class="annottext">Int -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">State.put</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">startBind</span></a></span><span>
</span><span id="line-54"></span><span>                  </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679207948"><span class="hs-identifier hs-var">drawIndent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207997"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207998"><span class="hs-identifier hs-var">upt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span>            </span><span id="local-6989586621679208000"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208000"><span class="hs-identifier hs-var">displayedBindings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((String, UnprocessedParsedTerm) -&gt; State Int String)
-&gt; [(String, UnprocessedParsedTerm)]
-&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(String, UnprocessedParsedTerm) -&gt; State Int String
</span><a href="#local-6989586621679207996"><span class="hs-identifier hs-var">drawOne</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679207984"><span class="hs-identifier hs-var">bindingsXS</span></a></span><span>
</span><span id="line-56"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">State.put</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207987"><span class="hs-identifier hs-var">startIn</span></a></span><span>
</span><span id="line-57"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207988"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208000"><span class="hs-identifier hs-var">displayedBindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679207948"><span class="hs-identifier hs-var">drawIndent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679207985"><span class="hs-identifier hs-var">in_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>          </span><span class="annot"><a href="Telomare.html#ListUP"><span class="hs-identifier hs-type">ListUP</span></a></span><span> </span><span id="local-6989586621679208004"><span class="annot"><span class="annottext">[UnprocessedParsedTerm]
</span><a href="#local-6989586621679208004"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208005"><span class="annot"><span class="annottext">insertCommas :: [State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var hs-var">insertCommas</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>                          </span><span class="annot"><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679208006"><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679208006"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679208006"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span>                          </span><span class="annot"><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208007"><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679208007"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679208008"><span class="annot"><span class="annottext">[State Int String]
</span><a href="#local-6989586621679208008"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679208007"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">State Int String -&gt; [State Int String] -&gt; [State Int String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">State Int String -&gt; [State Int String] -&gt; [State Int String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="annot"><span class="annottext">[State Int String]
</span><a href="#local-6989586621679208008"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-61"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall a b.
(a -&gt; b) -&gt; StateT Int Identity a -&gt; StateT Int Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">(StateT Int Identity [String] -&gt; State Int String)
-&gt; ([State Int String] -&gt; StateT Int Identity [String])
-&gt; [State Int String]
-&gt; State Int String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([State Int String] -&gt; StateT Int Identity [String])
-&gt; ([State Int String] -&gt; [State Int String])
-&gt; [State Int String]
-&gt; StateT Int Identity [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="annot"><span class="annottext">([State Int String] -&gt; State Int String)
-&gt; [State Int String] -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; State Int String)
-&gt; [UnprocessedParsedTerm] -&gt; [State Int String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">[UnprocessedParsedTerm]
</span><a href="#local-6989586621679208004"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>          </span><span class="annot"><a href="Telomare.html#IntUP"><span class="hs-identifier hs-type">IntUP</span></a></span><span> </span><span id="local-6989586621679208011"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208011"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State Int String) -&gt; String -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208011"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-63"></span><span>          </span><span class="annot"><a href="Telomare.html#StringUP"><span class="hs-identifier hs-type">StringUP</span></a></span><span> </span><span id="local-6989586621679208014"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208014"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208014"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span>          </span><span class="annot"><a href="Telomare.html#PairUP"><span class="hs-identifier hs-type">PairUP</span></a></span><span> </span><span id="local-6989586621679208016"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208016"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679208017"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208016"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>          </span><span class="annot"><a href="Telomare.html#AppUP"><span class="hs-identifier hs-type">AppUP</span></a></span><span> </span><span id="local-6989586621679208018"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679208019"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207975"><span class="hs-identifier hs-var">drawFirstParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207972"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>          </span><span class="hs-comment">-- TODO flatten nested lambdas</span><span>
</span><span id="line-67"></span><span>          </span><span class="annot"><a href="Telomare.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span id="local-6989586621679208020"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679208021"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208021"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208021"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span>          </span><span class="annot"><a href="Telomare.html#ChurchUP"><span class="hs-identifier hs-type">ChurchUP</span></a></span><span> </span><span id="local-6989586621679208023"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208023"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State Int String) -&gt; String -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208023"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>          </span><span class="annot"><a href="Telomare.html#UnsizedRecursionUP"><span class="hs-identifier hs-type">UnsizedRecursionUP</span></a></span><span> </span><span id="local-6989586621679208025"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208025"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679208026"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208026"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679208027"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208027"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208025"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208026"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208027"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>          </span><span class="annot"><a href="Telomare.html#LeftUP"><span class="hs-identifier hs-type">LeftUP</span></a></span><span> </span><span id="local-6989586621679208028"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208028"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;left &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207972"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208028"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>          </span><span class="annot"><a href="Telomare.html#RightUP"><span class="hs-identifier hs-type">RightUP</span></a></span><span> </span><span id="local-6989586621679208029"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208029"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;right &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207972"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208029"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>          </span><span class="annot"><a href="Telomare.html#TraceUP"><span class="hs-identifier hs-type">TraceUP</span></a></span><span> </span><span id="local-6989586621679208030"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208030"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;trace &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207972"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208030"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>          </span><span class="annot"><a href="Telomare.html#CheckUP"><span class="hs-identifier hs-type">CheckUP</span></a></span><span> </span><span id="local-6989586621679208032"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208032"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679208033"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679207960"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679207932"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; : &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208032"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679208034"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208034"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State Int String -&gt; Int -&gt; String
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">State.evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679207974"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679208034"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">{-
      safeTail s = if null s then [] else tail s
      showMem s = do
        let indent = length . last . takeWhile (not . null) . iterate (safeTail . dropWhile (/= '\n')) $ s
        if elem '\n' s
          then State.put indent
          else State.modify (+ indent)
        pure s
      draw oneLine =
        let showTwo a b = undefined --let long =
            showLine l = do
              indent &lt;- State.get
              let long = intercalate &quot; &quot; l
                         in if length long &gt; lineLimit
                            then

-}</span><span>
</span><span id="line-93"></span><span>              </span><span class="hs-comment">{-m
          drawLineOr x y = if not oneLine &amp;&amp; draw
-}</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-type">decompileTerm1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-98"></span><span id="decompileTerm1"><span class="annot"><span class="annottext">decompileTerm1 :: Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var hs-var">decompileTerm1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParserTermF String String Term1
</span><a href="Telomare.html#TZeroF"><span class="hs-identifier hs-var">TZeroF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TPairF"><span class="hs-identifier hs-type">TPairF</span></a></span><span> </span><span id="local-6989586621679208039"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208039"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679208040"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208040"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208039"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208040"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TVarF"><span class="hs-identifier hs-type">TVarF</span></a></span><span> </span><span id="local-6989586621679208042"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208042"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208042"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TAppF"><span class="hs-identifier hs-type">TAppF</span></a></span><span> </span><span id="local-6989586621679208044"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208044"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679208045"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208045"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208044"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208045"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TCheckF"><span class="hs-identifier hs-type">TCheckF</span></a></span><span> </span><span id="local-6989586621679208047"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208047"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679208048"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208048"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#CheckUP"><span class="hs-identifier hs-var">CheckUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208047"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208048"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TITEF"><span class="hs-identifier hs-type">TITEF</span></a></span><span> </span><span id="local-6989586621679208050"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208050"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679208051"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208051"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679208052"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208052"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208050"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208051"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208052"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLeftF"><span class="hs-identifier hs-type">TLeftF</span></a></span><span> </span><span id="local-6989586621679208054"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208054"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208054"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TRightF"><span class="hs-identifier hs-type">TRightF</span></a></span><span> </span><span id="local-6989586621679208056"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208056"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208056"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TTraceF"><span class="hs-identifier hs-type">TTraceF</span></a></span><span> </span><span id="local-6989586621679208058"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208058"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208058"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLamF"><span class="hs-identifier hs-type">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span id="local-6989586621679208061"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208061"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679208062"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208062"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208061"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208062"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLamF"><span class="hs-identifier hs-type">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span id="local-6989586621679208064"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208064"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679208065"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208065"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208064"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208065"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- not strictly equivalent</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLimitedRecursionF"><span class="hs-identifier hs-type">TLimitedRecursionF</span></a></span><span> </span><span id="local-6989586621679208067"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208067"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679208068"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208068"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679208069"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208069"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208067"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208068"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208069"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm2"><span class="hs-identifier hs-type">decompileTerm2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a></span><span>
</span><span id="line-113"></span><span id="decompileTerm2"><span class="annot"><span class="annottext">decompileTerm2 :: Term2 -&gt; Term1
</span><a href="Telomare.Decompiler.html#decompileTerm2"><span class="hs-identifier hs-var hs-var">decompileTerm2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208076"><span class="annot"><span class="annottext">nameSupply :: [String]
</span><a href="#local-6989586621679208076"><span class="hs-identifier hs-var hs-var">nameSupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; String) -&gt; String -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208077"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208078"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679208077"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208077"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679208076"><span class="hs-identifier hs-var">nameSupply</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208078"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208078"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679208076"><span class="hs-identifier hs-var">nameSupply</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621679208085"><span class="annot"><span class="annottext">getName :: Int -&gt; String
</span><a href="#local-6989586621679208085"><span class="hs-identifier hs-var hs-var">getName</span></a></span></span><span> </span><span id="local-6989586621679208086"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208086"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208086"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679208076"><span class="hs-identifier hs-var">nameSupply</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679208076"><span class="hs-identifier hs-var">nameSupply</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208086"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><a href="#local-6989586621679208090"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span>
</span><span id="line-119"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>      </span><span id="local-6989586621679208090"><span class="annot"><span class="annottext">go :: Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-121"></span><span>        </span><span id="local-6989586621679208091"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208091"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParserTermF () Int Term2
</span><a href="Telomare.html#TZeroF"><span class="hs-identifier hs-var">TZeroF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; (Max Int, Term1)
forall a. a -&gt; (Max Int, a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; (Max Int, Term1)) -&gt; Term1 -&gt; (Max Int, Term1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208091"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParserTermF String String Term1
forall l v r. ParserTermF l v r
</span><a href="Telomare.html#TZeroF"><span class="hs-identifier hs-var">TZeroF</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621679208092"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TPairF"><span class="hs-identifier hs-type">TPairF</span></a></span><span> </span><span id="local-6989586621679208093"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208093"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679208094"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679208095"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208095"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679208096"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208096"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TPairF"><span class="hs-identifier hs-var">TPairF</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208095"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208096"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208093"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (Max Int, a -&gt; b) -&gt; (Max Int, a) -&gt; (Max Int, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621679208097"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208097"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TVarF"><span class="hs-identifier hs-type">TVarF</span></a></span><span> </span><span id="local-6989586621679208098"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208098"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Max Int
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208098"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208097"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParserTermF String String Term1
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679208085"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208098"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>        </span><span id="local-6989586621679208100"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208100"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TAppF"><span class="hs-identifier hs-type">TAppF</span></a></span><span> </span><span id="local-6989586621679208101"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208101"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679208102"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208102"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679208103"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208103"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679208104"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208104"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208100"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TAppF"><span class="hs-identifier hs-var">TAppF</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208103"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208104"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208101"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (Max Int, a -&gt; b) -&gt; (Max Int, a) -&gt; (Max Int, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208102"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span id="local-6989586621679208105"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208105"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TCheckF"><span class="hs-identifier hs-type">TCheckF</span></a></span><span> </span><span id="local-6989586621679208106"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208106"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679208107"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208107"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679208108"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208108"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679208109"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208109"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208105"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TCheckF"><span class="hs-identifier hs-var">TCheckF</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208108"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208109"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208106"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (Max Int, a -&gt; b) -&gt; (Max Int, a) -&gt; (Max Int, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208107"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679208110"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208110"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TITEF"><span class="hs-identifier hs-type">TITEF</span></a></span><span> </span><span id="local-6989586621679208111"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208111"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679208112"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208112"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679208113"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208113"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679208114"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208114"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679208115"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208115"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679208116"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208116"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208110"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TITEF"><span class="hs-identifier hs-var">TITEF</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208114"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208115"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208116"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208111"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall a b. (Max Int, a -&gt; b) -&gt; (Max Int, a) -&gt; (Max Int, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208112"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (Max Int, a -&gt; b) -&gt; (Max Int, a) -&gt; (Max Int, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208113"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621679208117"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208117"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLeftF"><span class="hs-identifier hs-type">TLeftF</span></a></span><span> </span><span id="local-6989586621679208118"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208118"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208117"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParserTermF String String Term1 -&gt; Term1)
-&gt; (Term1 -&gt; ParserTermF String String Term1) -&gt; Term1 -&gt; Term1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLeftF"><span class="hs-identifier hs-var">TLeftF</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208118"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621679208119"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208119"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TRightF"><span class="hs-identifier hs-type">TRightF</span></a></span><span> </span><span id="local-6989586621679208120"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208120"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208119"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParserTermF String String Term1 -&gt; Term1)
-&gt; (Term1 -&gt; ParserTermF String String Term1) -&gt; Term1 -&gt; Term1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TRightF"><span class="hs-identifier hs-var">TRightF</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208120"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621679208121"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208121"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TTraceF"><span class="hs-identifier hs-type">TTraceF</span></a></span><span> </span><span id="local-6989586621679208122"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208122"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208121"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParserTermF String String Term1 -&gt; Term1)
-&gt; (Term1 -&gt; ParserTermF String String Term1) -&gt; Term1 -&gt; Term1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TTraceF"><span class="hs-identifier hs-var">TTraceF</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208122"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span id="local-6989586621679208123"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208123"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLamF"><span class="hs-identifier hs-type">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679208124"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208124"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span id="local-6989586621679208125"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208125"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208126"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Max Int
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208125"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208123"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParserTermF String String Term1 -&gt; Term1)
-&gt; ParserTermF String String Term1 -&gt; Term1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LamType String -&gt; Term1 -&gt; ParserTermF String String Term1
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; LamType String
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679208085"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208125"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Max Int, Term1) -&gt; (Max Int, Term1))
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208124"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- warning, untested</span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679208127"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208127"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLamF"><span class="hs-identifier hs-type">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679208128"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208128"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span id="local-6989586621679208129"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208129"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208130"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208130"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Max Int
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208127"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParserTermF String String Term1 -&gt; Term1)
-&gt; ParserTermF String String Term1 -&gt; Term1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LamType String -&gt; Term1 -&gt; ParserTermF String String Term1
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; LamType String
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679208085"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208129"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208130"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Max Int, Term1) -&gt; (Max Int, Term1))
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208128"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span id="local-6989586621679208131"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208131"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#TLimitedRecursionF"><span class="hs-identifier hs-type">TLimitedRecursionF</span></a></span><span> </span><span id="local-6989586621679208132"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208132"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679208133"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208133"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679208134"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208134"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679208135"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208135"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679208136"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208136"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679208137"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208137"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208131"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF String String Term1 -&gt; Term1
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; Term1 -&gt; ParserTermF String String Term1
forall l v r. r -&gt; r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLimitedRecursionF"><span class="hs-identifier hs-var">TLimitedRecursionF</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208135"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208136"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679208137"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208132"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall a b. (Max Int, a -&gt; b) -&gt; (Max Int, a) -&gt; (Max Int, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208133"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (Max Int, a -&gt; b) -&gt; (Max Int, a) -&gt; (Max Int, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679208134"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1) -&gt; Term1
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Max Int, Term1) -&gt; Term1)
-&gt; (Term2 -&gt; (Max Int, Term1)) -&gt; Term2 -&gt; Term1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679207816"><span class="annot"><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-type">decompileFragMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679207816"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span></span><span>
</span><span id="line-136"></span><span id="decompileFragMap"><span class="annot"><span class="annottext">decompileFragMap :: forall a. Map FragIndex (Cofree (FragExprF a) LocTag) -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-var hs-var">decompileFragMap</span></a></span></span><span> </span><span id="local-6989586621679208140"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF a) LocTag)
</span><a href="#local-6989586621679208140"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679207820"><span class="annot"><a href="#local-6989586621679208141"><span class="hs-identifier hs-type">decomp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679207820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span>
</span><span id="line-138"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span></span><span>
</span><span id="line-139"></span><span>      </span><span id="local-6989586621679208141"><span class="annot"><span class="annottext">decomp :: forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208141"><span class="hs-identifier hs-var hs-var">decomp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208153"><span class="annot"><span class="annottext">recur :: Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208141"><span class="hs-identifier hs-var">decomp</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-140"></span><span>        </span><span id="local-6989586621679208154"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208154"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF a (Cofree (FragExprF a) LocTag)
</span><a href="Telomare.html#ZeroFragF"><span class="hs-identifier hs-var">ZeroFragF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208154"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParserTermF () Int Term2
forall l v r. ParserTermF l v r
</span><a href="Telomare.html#TZeroF"><span class="hs-identifier hs-var">TZeroF</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span id="local-6989586621679208156"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208156"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#PairFragF"><span class="hs-identifier hs-type">PairFragF</span></a></span><span> </span><span id="local-6989586621679208158"><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208158"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679208159"><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208159"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208156"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TPairF"><span class="hs-identifier hs-var">TPairF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208158"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208159"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>        </span><span id="local-6989586621679208160"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208160"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF a (Cofree (FragExprF a) LocTag)
</span><a href="Telomare.html#EnvFragF"><span class="hs-identifier hs-var">EnvFragF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208160"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParserTermF () Int Term2
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-143"></span><span>        </span><span id="local-6989586621679208162"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#SetEnvFragF"><span class="hs-identifier hs-type">SetEnvFragF</span></a></span><span> </span><span id="local-6989586621679208164"><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208164"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TAppF"><span class="hs-identifier hs-var">TAppF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TAppF"><span class="hs-identifier hs-var">TAppF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLeftF"><span class="hs-identifier hs-var">TLeftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParserTermF () Int Term2
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>                                                                                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TRightF"><span class="hs-identifier hs-var">TRightF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParserTermF () Int Term2
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208164"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>        </span><span id="local-6989586621679208165"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208165"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#DeferFragF"><span class="hs-identifier hs-type">DeferFragF</span></a></span><span> </span><span id="local-6989586621679208167"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679208167"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208165"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; ParserTermF () Int Term2)
-&gt; (Cofree (FragExprF a) LocTag -&gt; Term2)
-&gt; Cofree (FragExprF a) LocTag
-&gt; ParserTermF () Int Term2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF a) LocTag -&gt; ParserTermF () Int Term2)
-&gt; Cofree (FragExprF a) LocTag -&gt; ParserTermF () Int Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF a) LocTag)
</span><a href="#local-6989586621679208140"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF a) LocTag)
-&gt; FragIndex -&gt; Cofree (FragExprF a) LocTag
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679208167"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>        </span><span id="local-6989586621679208169"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF a (Cofree (FragExprF a) LocTag)
</span><a href="Telomare.html#AbortFragF"><span class="hs-identifier hs-var">AbortFragF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TCheckF"><span class="hs-identifier hs-var">TCheckF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParserTermF () Int Term2
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParserTermF () Int Term2
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621679208171"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208171"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#GateFragF"><span class="hs-identifier hs-type">GateFragF</span></a></span><span> </span><span id="local-6989586621679208173"><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208173"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679208174"><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208174"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208171"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208171"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; r -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TITEF"><span class="hs-identifier hs-var">TITEF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208171"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParserTermF () Int Term2
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208174"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208173"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>        </span><span id="local-6989586621679208175"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208175"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#LeftFragF"><span class="hs-identifier hs-type">LeftFragF</span></a></span><span> </span><span id="local-6989586621679208177"><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208177"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208175"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLeftF"><span class="hs-identifier hs-var">TLeftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208177"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>        </span><span id="local-6989586621679208178"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208178"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RightFragF"><span class="hs-identifier hs-type">RightFragF</span></a></span><span> </span><span id="local-6989586621679208180"><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208180"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208178"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TRightF"><span class="hs-identifier hs-var">TRightF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208153"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
</span><a href="#local-6989586621679208180"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span id="local-6989586621679208181"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208181"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF a (Cofree (FragExprF a) LocTag)
</span><a href="Telomare.html#TraceFragF"><span class="hs-identifier hs-var">TraceFragF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208181"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; ParserTermF () Int Term2
forall l v r. LamType l -&gt; r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208181"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; ParserTermF () Int Term2
forall l v r. r -&gt; ParserTermF l v r
</span><a href="Telomare.html#TTraceF"><span class="hs-identifier hs-var">TTraceF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208181"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; ParserTermF () Int Term2 -&gt; Term2
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParserTermF () Int Term2
forall l v r. v -&gt; ParserTermF l v r
</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>        </span><span id="local-6989586621679208183"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679208183"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Term2
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decompileFragMap: TODO AuxFrag&quot;</span></span><span> </span><span class="hs-comment">-- TLimitedRecursion</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag -&gt; Term2
forall a. Cofree (FragExprF a) LocTag -&gt; Term2
</span><a href="#local-6989586621679208141"><span class="hs-identifier hs-var">decomp</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF a) LocTag -&gt; Term2)
-&gt; Cofree (FragExprF a) LocTag -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF a) LocTag)
-&gt; Cofree (FragExprF a) LocTag
forall a. Map FragIndex a -&gt; a
</span><a href="Telomare.html#rootFrag"><span class="hs-identifier hs-var">rootFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF a) LocTag)
</span><a href="#local-6989586621679208140"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm4"><span class="hs-identifier hs-type">decompileTerm4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span>
</span><span id="line-158"></span><span id="decompileTerm4"><span class="annot"><span class="annottext">decompileTerm4 :: Term4 -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileTerm4"><span class="hs-identifier hs-var hs-var">decompileTerm4</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679208189"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208189"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term2
forall a. Map FragIndex (Cofree (FragExprF a) LocTag) -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-var">decompileFragMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208189"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm3"><span class="hs-identifier hs-type">decompileTerm3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span>
</span><span id="line-161"></span><span id="decompileTerm3"><span class="annot"><span class="annottext">decompileTerm3 :: Term3 -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileTerm3"><span class="hs-identifier hs-var hs-var">decompileTerm3</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span id="local-6989586621679208192"><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679208192"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  FragIndex
  (Cofree (FragExprF (RecursionSimulationPieces FragExprUR)) LocTag)
-&gt; Term2
forall a. Map FragIndex (Cofree (FragExprF a) LocTag) -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-var">decompileFragMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map
   FragIndex
   (Cofree (FragExprF (RecursionSimulationPieces FragExprUR)) LocTag)
 -&gt; Term2)
-&gt; Map
     FragIndex
     (Cofree (FragExprF (RecursionSimulationPieces FragExprUR)) LocTag)
-&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FragExprUR
 -&gt; Cofree
      (FragExprF (RecursionSimulationPieces FragExprUR)) LocTag)
-&gt; Map FragIndex FragExprUR
-&gt; Map
     FragIndex
     (Cofree (FragExprF (RecursionSimulationPieces FragExprUR)) LocTag)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR
-&gt; Cofree (FragExprF (RecursionSimulationPieces FragExprUR)) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679208192"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileIExpr"><span class="hs-identifier hs-type">decompileIExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-164"></span><span id="decompileIExpr"><span class="annot"><span class="annottext">decompileIExpr :: IExpr -&gt; Term4
</span><a href="Telomare.Decompiler.html#decompileIExpr"><span class="hs-identifier hs-var hs-var">decompileIExpr</span></a></span></span><span> </span><span id="local-6989586621679208196"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208196"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208215"><span class="annot"><span class="annottext">build :: IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-165"></span><span>                         </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a.
a
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag
 -&gt; StateT
      (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
      Identity
      (Cofree (FragExprF Void) LocTag))
-&gt; (FragExpr Void -&gt; Cofree (FragExprF Void) LocTag)
-&gt; FragExpr Void
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; FragExpr Void -&gt; Cofree (Base (FragExpr Void)) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr Void
 -&gt; StateT
      (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
      Identity
      (Cofree (FragExprF Void) LocTag))
-&gt; FragExpr Void
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
forall a. FragExpr a
</span><a href="Telomare.html#ZeroFrag"><span class="hs-identifier hs-var">ZeroFrag</span></a></span><span>
</span><span id="line-166"></span><span>                         </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679208221"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208221"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679208222"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208222"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679208223"><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208223"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679208224"><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208224"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
-&gt; Cofree (FragExprF Void) LocTag
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; Cofree (FragExprF Void) LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
forall a r. r -&gt; r -&gt; FragExprF a r
</span><a href="Telomare.html#PairFragF"><span class="hs-identifier hs-var">PairFragF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208223"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208224"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag
 -&gt; Cofree (FragExprF Void) LocTag
 -&gt; Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208221"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
  Identity
  (Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a b.
StateT
  (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
  Identity
  (a -&gt; b)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     a
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208222"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-167"></span><span>                         </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a.
a
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag
 -&gt; StateT
      (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
      Identity
      (Cofree (FragExprF Void) LocTag))
-&gt; (FragExpr Void -&gt; Cofree (FragExprF Void) LocTag)
-&gt; FragExpr Void
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; FragExpr Void -&gt; Cofree (Base (FragExpr Void)) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr Void
 -&gt; StateT
      (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
      Identity
      (Cofree (FragExprF Void) LocTag))
-&gt; FragExpr Void
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
forall a. FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span>
</span><span id="line-168"></span><span>                         </span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679208228"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208228"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
-&gt; Cofree (FragExprF Void) LocTag
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FragExprF Void (Cofree (FragExprF Void) LocTag)
 -&gt; Cofree (FragExprF Void) LocTag)
-&gt; (Cofree (FragExprF Void) LocTag
    -&gt; FragExprF Void (Cofree (FragExprF Void) LocTag))
-&gt; Cofree (FragExprF Void) LocTag
-&gt; Cofree (FragExprF Void) LocTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#SetEnvFragF"><span class="hs-identifier hs-var">SetEnvFragF</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208228"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-169"></span><span>                         </span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679208230"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208230"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679208231"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208231"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679208232"><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208232"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679208233"><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208233"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
-&gt; Cofree (FragExprF Void) LocTag
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; Cofree (FragExprF Void) LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
forall a r. r -&gt; r -&gt; FragExprF a r
</span><a href="Telomare.html#GateFragF"><span class="hs-identifier hs-var">GateFragF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208232"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
</span><a href="#local-6989586621679208233"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag
 -&gt; Cofree (FragExprF Void) LocTag
 -&gt; Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208230"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
  Identity
  (Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a b.
StateT
  (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
  Identity
  (a -&gt; b)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     a
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208231"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-170"></span><span>                         </span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679208235"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208235"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
-&gt; Cofree (FragExprF Void) LocTag
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FragExprF Void (Cofree (FragExprF Void) LocTag)
 -&gt; Cofree (FragExprF Void) LocTag)
-&gt; (Cofree (FragExprF Void) LocTag
    -&gt; FragExprF Void (Cofree (FragExprF Void) LocTag))
-&gt; Cofree (FragExprF Void) LocTag
-&gt; Cofree (FragExprF Void) LocTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#LeftFragF"><span class="hs-identifier hs-var">LeftFragF</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208235"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-171"></span><span>                         </span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679208237"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208237"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
-&gt; Cofree (FragExprF Void) LocTag
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FragExprF Void (Cofree (FragExprF Void) LocTag)
 -&gt; Cofree (FragExprF Void) LocTag)
-&gt; (Cofree (FragExprF Void) LocTag
    -&gt; FragExprF Void (Cofree (FragExprF Void) LocTag))
-&gt; Cofree (FragExprF Void) LocTag
-&gt; Cofree (FragExprF Void) LocTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; FragExprF Void (Cofree (FragExprF Void) LocTag)
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#RightFragF"><span class="hs-identifier hs-var">RightFragF</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208237"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-172"></span><span>                         </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a.
a
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag
 -&gt; StateT
      (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
      Identity
      (Cofree (FragExprF Void) LocTag))
-&gt; (FragExpr Void -&gt; Cofree (FragExprF Void) LocTag)
-&gt; FragExpr Void
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; FragExpr Void -&gt; Cofree (Base (FragExpr Void)) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr Void
 -&gt; StateT
      (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
      Identity
      (Cofree (FragExprF Void) LocTag))
-&gt; FragExpr Void
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
forall a. FragExpr a
</span><a href="Telomare.html#TraceFrag"><span class="hs-identifier hs-var">TraceFrag</span></a></span><span>
</span><span id="line-173"></span><span>                         </span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679208241"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208241"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT
  (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
  Identity
  (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a b. Show a =&gt; BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT
   (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
   Identity
   (Cofree (FragExprF Void) LocTag)
 -&gt; StateT
      (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
      Identity
      (Cofree (FragExprF Void) LocTag))
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208241"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-174"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4
</span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4)
-&gt; (BreakState' Void Any
    -&gt; Map FragIndex (Cofree (FragExprF Void) LocTag))
-&gt; BreakState' Void Any
-&gt; Term4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BreakState' Void Any
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag)
forall a b.
BreakState' a b -&gt; Map FragIndex (Cofree (FragExprF a) LocTag)
</span><a href="Telomare.html#buildFragMap"><span class="hs-identifier hs-var">buildFragMap</span></a></span><span> </span><span class="annot"><span class="annottext">(BreakState' Void Any -&gt; Term4) -&gt; BreakState' Void Any -&gt; Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; BreakState' Void Any
forall {b}.
IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
     Identity
     (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679208196"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-175"></span></pre></body></html>