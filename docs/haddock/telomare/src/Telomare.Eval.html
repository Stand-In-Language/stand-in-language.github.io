<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms     #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-deferred-out-of-scope-variables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html"><span class="hs-identifier">Control.Comonad.Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator">(:&lt;)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#hoistCofree"><span class="hs-identifier">hoistCofree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/fn5r8vd6lkpbiy7gl9dwbkx2mwiyxydf-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html"><span class="hs-identifier">Control.Lens.Plated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/fn5r8vd6lkpbiy7gl9dwbkx2mwiyxydf-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#Plated"><span class="hs-identifier">Plated</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/fn5r8vd6lkpbiy7gl9dwbkx2mwiyxydf-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier">transformM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fold</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Max</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Min</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Trans.Cofree.html"><span class="hs-identifier">Control.Comonad.Trans.Cofree</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CofreeT</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html"><span class="hs-identifier">Data.Functor.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#Base"><span class="hs-identifier">Base</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#cata"><span class="hs-identifier">cata</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#embed"><span class="hs-identifier">embed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#para"><span class="hs-identifier">para</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PrettyPrint.html"><span class="hs-identifier">PrettyPrint</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#AbstractRunTime"><span class="hs-identifier">AbstractRunTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#BreakState"><span class="hs-identifier">BreakState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#BreakState%27"><span class="hs-identifier">BreakState'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#ExprA"><span class="hs-identifier">ExprA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>                 </span><span class="annot"><a href="Telomare.html#FragExpr"><span class="hs-identifier">FragExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier">FragExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier">FragIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>                 </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier">IExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExprF"><span class="hs-identifier">IExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier">LocTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#PartialType"><span class="hs-identifier">PartialType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>                 </span><span class="annot"><a href="Telomare.html#Pattern"><span class="hs-identifier">Pattern</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier">RecursionPieceFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#RecursionSimulationPieces"><span class="hs-identifier">RecursionSimulationPieces</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                 </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier">RunTimeError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#TelomareLike"><span class="hs-identifier">TelomareLike</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier">Term3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier">Term3</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                 </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier">Term4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier">Term4</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>                 </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#UnsizedRecursionToken"><span class="hs-identifier">UnsizedRecursionToken</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#app"><span class="hs-identifier">app</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>                 </span><span class="annot"><a href="Telomare.html#appF"><span class="hs-identifier">appF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#cataFragExprUR"><span class="hs-identifier">cataFragExprUR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#convertAbortMessage"><span class="hs-identifier">convertAbortMessage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#deferF"><span class="hs-identifier">deferF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#eval"><span class="hs-identifier">eval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>                 </span><span class="annot"><a href="Telomare.html#forget"><span class="hs-identifier">forget</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#g2s"><span class="hs-identifier">g2s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#innerChurchF"><span class="hs-identifier">innerChurchF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#insertAndGetKey"><span class="hs-identifier">insertAndGetKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#pairF"><span class="hs-identifier">pairF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#rootFrag"><span class="hs-identifier">rootFrag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>                 </span><span class="annot"><a href="Telomare.html#s2g"><span class="hs-identifier">s2g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#setEnvF"><span class="hs-identifier">setEnvF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#tag"><span class="hs-identifier">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#unFragExprUR"><span class="hs-identifier">unFragExprUR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Parser.html"><span class="hs-identifier">Telomare.Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier">AnnotatedUPT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#parseModule"><span class="hs-identifier">parseModule</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#parseOneExprOrTopLevelDefs"><span class="hs-identifier">parseOneExprOrTopLevelDefs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>                        </span><span class="annot"><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier">parsePrelude</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Possible.html"><span class="hs-identifier">Telomare.Possible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Possible.html#abortExprToTerm4"><span class="hs-identifier">abortExprToTerm4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#abortPossibilities"><span class="hs-identifier">abortPossibilities</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#appB"><span class="hs-identifier">appB</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>                          </span><span class="annot"><a href="Telomare.Possible.html#buildUnsizedLocMap"><span class="hs-identifier">buildUnsizedLocMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#deferB"><span class="hs-identifier">deferB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#evalA"><span class="hs-identifier">evalA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#getSizesM"><span class="hs-identifier">getSizesM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>                          </span><span class="annot"><a href="Telomare.Possible.html#sizeTermM"><span class="hs-identifier">sizeTermM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#term3ToUnsizedExpr"><span class="hs-identifier">term3ToUnsizedExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#term4toAbortExpr"><span class="hs-identifier">term4toAbortExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html"><span class="hs-identifier">Telomare.PossibleData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.PossibleData.html#AbortExpr"><span class="hs-identifier">AbortExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier">CompiledExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#SizedRecursion"><span class="hs-identifier">SizedRecursion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>                              </span><span class="annot"><a href="Telomare.PossibleData.html#VoidF"><span class="hs-identifier">VoidF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#envB"><span class="hs-identifier">envB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#leftB"><span class="hs-identifier">leftB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#pairB"><span class="hs-identifier">pairB</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#AbortFW"><span class="hs-identifier">AbortFW</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>                              </span><span class="annot"><a href="Telomare.PossibleData.html#rightB"><span class="hs-identifier">rightB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#setEnvB"><span class="hs-identifier">setEnvB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Resolver.html"><span class="hs-identifier">Telomare.Resolver</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Resolver.html#main2Term3"><span class="hs-identifier">main2Term3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Resolver.html#process"><span class="hs-identifier">process</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Resolver.html#resolveAllImports"><span class="hs-identifier">resolveAllImports</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.RunTime.html"><span class="hs-identifier">Telomare.RunTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier">rEval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.TypeChecker.html"><span class="hs-identifier">Telomare.TypeChecker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.TypeChecker.html#TypeCheckError"><span class="hs-identifier">TypeCheckError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.TypeChecker.html#typeCheck"><span class="hs-identifier">typeCheck</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/cpbijcsgm9np1zixx9xcijmcljl31jqz-megaparsec-9.5.0-doc/share/doc/megaparsec-9.5.0/html/src/Text.Megaparsec.html"><span class="hs-identifier">Text.Megaparsec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/cpbijcsgm9np1zixx9xcijmcljl31jqz-megaparsec-9.5.0-doc/share/doc/megaparsec-9.5.0/html/src/Text.Megaparsec.Error.html#errorBundlePretty"><span class="hs-identifier">errorBundlePretty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/cpbijcsgm9np1zixx9xcijmcljl31jqz-megaparsec-9.5.0-doc/share/doc/megaparsec-9.5.0/html/src/Text.Megaparsec.html#runParser"><span class="hs-identifier">runParser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Telomare.Eval.html#debug"><span class="hs-identifier hs-type">debug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-53"></span><span id="debug"><span class="annot"><span class="annottext">debug :: Bool
</span><a href="Telomare.Eval.html#debug"><span class="hs-identifier hs-var hs-var">debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621679276950"><span class="annot"><a href="Telomare.Eval.html#debugTrace"><span class="hs-identifier hs-type">debugTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679276950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679276950"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-56"></span><span id="debugTrace"><span class="annot"><span class="annottext">debugTrace :: forall a. String -&gt; a -&gt; a
</span><a href="Telomare.Eval.html#debugTrace"><span class="hs-identifier hs-var hs-var">debugTrace</span></a></span></span><span> </span><span id="local-6989586621679277558"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277558"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679277559"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277559"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Telomare.Eval.html#debug"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; a
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277558"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277559"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277559"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span> </span><span id="EvalError"><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-var">EvalError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RTE"><span class="annot"><a href="Telomare.Eval.html#RTE"><span class="hs-identifier hs-var">RTE</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TCE"><span class="annot"><a href="Telomare.Eval.html#TCE"><span class="hs-identifier hs-var">TCE</span></a></span></span><span> </span><span class="annot"><a href="Telomare.TypeChecker.html#TypeCheckError"><span class="hs-identifier hs-type">TypeCheckError</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StaticCheckError"><span class="annot"><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CompileConversionError"><span class="annot"><a href="Telomare.Eval.html#CompileConversionError"><span class="hs-identifier hs-var">CompileConversionError</span></a></span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RecursionLimitError"><span class="annot"><a href="Telomare.Eval.html#RecursionLimitError"><span class="hs-identifier hs-var">RecursionLimitError</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#UnsizedRecursionToken"><span class="hs-identifier hs-type">UnsizedRecursionToken</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679277566"><span id="local-6989586621679277577"><span class="annot"><span class="annottext">EvalError -&gt; EvalError -&gt; Bool
(EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool) -&gt; Eq EvalError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: EvalError -&gt; EvalError -&gt; Bool
== :: EvalError -&gt; EvalError -&gt; Bool
$c/= :: EvalError -&gt; EvalError -&gt; Bool
/= :: EvalError -&gt; EvalError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277585"><span id="local-6989586621679277594"><span id="local-6989586621679277598"><span id="local-6989586621679277601"><span id="local-6989586621679277604"><span id="local-6989586621679277607"><span id="local-6989586621679277610"><span class="annot"><span class="annottext">Eq EvalError
Eq EvalError =&gt;
(EvalError -&gt; EvalError -&gt; Ordering)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; EvalError)
-&gt; (EvalError -&gt; EvalError -&gt; EvalError)
-&gt; Ord EvalError
EvalError -&gt; EvalError -&gt; Bool
EvalError -&gt; EvalError -&gt; Ordering
EvalError -&gt; EvalError -&gt; EvalError
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: EvalError -&gt; EvalError -&gt; Ordering
compare :: EvalError -&gt; EvalError -&gt; Ordering
$c&lt; :: EvalError -&gt; EvalError -&gt; Bool
&lt; :: EvalError -&gt; EvalError -&gt; Bool
$c&lt;= :: EvalError -&gt; EvalError -&gt; Bool
&lt;= :: EvalError -&gt; EvalError -&gt; Bool
$c&gt; :: EvalError -&gt; EvalError -&gt; Bool
&gt; :: EvalError -&gt; EvalError -&gt; Bool
$c&gt;= :: EvalError -&gt; EvalError -&gt; Bool
&gt;= :: EvalError -&gt; EvalError -&gt; Bool
$cmax :: EvalError -&gt; EvalError -&gt; EvalError
max :: EvalError -&gt; EvalError -&gt; EvalError
$cmin :: EvalError -&gt; EvalError -&gt; EvalError
min :: EvalError -&gt; EvalError -&gt; EvalError
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277614"><span id="local-6989586621679277628"><span id="local-6989586621679277631"><span class="annot"><span class="annottext">Int -&gt; EvalError -&gt; ShowS
[EvalError] -&gt; ShowS
EvalError -&gt; String
(Int -&gt; EvalError -&gt; ShowS)
-&gt; (EvalError -&gt; String)
-&gt; ([EvalError] -&gt; ShowS)
-&gt; Show EvalError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; EvalError -&gt; ShowS
showsPrec :: Int -&gt; EvalError -&gt; ShowS
$cshow :: EvalError -&gt; String
show :: EvalError -&gt; String
$cshowList :: [EvalError] -&gt; ShowS
showList :: [EvalError] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Telomare.Eval.html#convertPT"><span class="hs-identifier hs-type">convertPT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#UnsizedRecursionToken"><span class="hs-identifier hs-type">UnsizedRecursionToken</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-66"></span><span id="convertPT"><span class="annot"><span class="annottext">convertPT :: (UnsizedRecursionToken -&gt; Int) -&gt; Term3 -&gt; Term4
</span><a href="Telomare.Eval.html#convertPT"><span class="hs-identifier hs-var hs-var">convertPT</span></a></span></span><span> </span><span id="local-6989586621679277635"><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; Int
</span><a href="#local-6989586621679277635"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span id="local-6989586621679277636"><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679277636"><span class="hs-identifier hs-var">termMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679277637"><span class="annot"><span class="annottext">unURedMap :: Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277637"><span class="hs-identifier hs-var hs-var">unURedMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex FragExprUR
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679277636"><span class="hs-identifier hs-var">termMap</span></a></span><span>
</span><span id="line-68"></span><span>      </span><span id="local-6989586621679277641"><span class="annot"><span class="annottext">startKey :: FragIndex
</span><a href="#local-6989586621679277641"><span class="hs-identifier hs-var hs-var">startKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragIndex
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex -&gt; FragIndex)
-&gt; ((FragIndex, FragExprUR) -&gt; FragIndex)
-&gt; (FragIndex, FragExprUR)
-&gt; FragIndex
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex, FragExprUR) -&gt; FragIndex
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((FragIndex, FragExprUR) -&gt; FragIndex)
-&gt; (FragIndex, FragExprUR) -&gt; FragIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR -&gt; (FragIndex, FragExprUR)
forall k a. Map k a -&gt; (k, a)
</span><span class="hs-identifier hs-var">Map.findMax</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679277636"><span class="hs-identifier hs-var">termMap</span></a></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><a href="#local-6989586621679277646"><span class="hs-identifier hs-type">changeFrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span>
</span><span id="line-70"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State.State</span></span><span>
</span><span id="line-71"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>                       </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span>
</span><span id="line-73"></span><span>                         </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-74"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>      </span><span id="local-6989586621679277646"><span class="annot"><span class="annottext">changeFrag :: Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277646"><span class="hs-identifier hs-var hs-var">changeFrag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621679277647"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679277647"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#NestedSetEnvs"><span class="hs-identifier hs-type">NestedSetEnvs</span></a></span><span> </span><span id="local-6989586621679277650"><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679277650"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; Int
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. LocTag -&gt; Int -&gt; BreakState' a b
</span><a href="Telomare.html#innerChurchF"><span class="hs-identifier hs-var">innerChurchF</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679277647"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Int
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; Int
</span><a href="#local-6989586621679277635"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679277650"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#SizingWrapper"><span class="hs-identifier hs-type">SizingWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679277652"><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679277652"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall (m :: * -&gt; *) a.
(Monad m, Plated a) =&gt;
(a -&gt; m a) -&gt; a -&gt; m a
</span><a href="file:///nix/store/fn5r8vd6lkpbiy7gl9dwbkx2mwiyxydf-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier hs-var">transformM</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277646"><span class="hs-identifier hs-var">changeFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679277652"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#CheckingWrapper"><span class="hs-identifier hs-type">CheckingWrapper</span></a></span><span> </span><span id="local-6989586621679277654"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679277654"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span id="local-6989586621679277655"><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679277655"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679277656"><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679277656"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679277677"><span class="annot"><span class="annottext">performTC :: State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277677"><span class="hs-identifier hs-var hs-var">performTC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. Show a =&gt; BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679277678"><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277678"><span class="hs-identifier hs-var">ia</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#setEnvF"><span class="hs-identifier hs-var">setEnvF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. BreakState' a b -&gt; BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#pairF"><span class="hs-identifier hs-var">pairF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#setEnvF"><span class="hs-identifier hs-var">setEnvF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. BreakState' a b -&gt; BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#pairF"><span class="hs-identifier hs-var">pairF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a.
a
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExpr RecursionPieceFrag
-&gt; Cofree (Base (FragExpr RecursionPieceFrag)) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679277654"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr RecursionPieceFrag
forall a. FragExpr a
</span><a href="Telomare.html#AbortFrag"><span class="hs-identifier hs-var">AbortFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277678"><span class="hs-identifier hs-var">ia</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>                                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a.
a
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; (FragExpr RecursionPieceFrag
    -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; FragExpr RecursionPieceFrag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExpr RecursionPieceFrag
-&gt; Cofree (Base (FragExpr RecursionPieceFrag)) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679277654"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr RecursionPieceFrag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; FragExpr RecursionPieceFrag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr RecursionPieceFrag -&gt; FragExpr RecursionPieceFrag
forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#RightFrag"><span class="hs-identifier hs-var">RightFrag</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr RecursionPieceFrag
forall a. FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(State
   ((), FragIndex,
    Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
   (Cofree (FragExprF RecursionPieceFrag) LocTag)
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b.
(Show a, Enum b, Show b) =&gt;
BreakState' a b -&gt; BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#appF"><span class="hs-identifier hs-var">appF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a.
a
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; (FragExpr RecursionPieceFrag
    -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; FragExpr RecursionPieceFrag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExpr RecursionPieceFrag
-&gt; Cofree (Base (FragExpr RecursionPieceFrag)) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679277654"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr RecursionPieceFrag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; FragExpr RecursionPieceFrag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr RecursionPieceFrag -&gt; FragExpr RecursionPieceFrag
forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#LeftFrag"><span class="hs-identifier hs-var">LeftFrag</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr RecursionPieceFrag
forall a. FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                                                                                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a.
a
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; (FragExpr RecursionPieceFrag
    -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; FragExpr RecursionPieceFrag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExpr RecursionPieceFrag
-&gt; Cofree (Base (FragExpr RecursionPieceFrag)) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679277654"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr RecursionPieceFrag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; FragExpr RecursionPieceFrag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr RecursionPieceFrag -&gt; FragExpr RecursionPieceFrag
forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#RightFrag"><span class="hs-identifier hs-var">RightFrag</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr RecursionPieceFrag
forall a. FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#setEnvF"><span class="hs-identifier hs-var">setEnvF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. BreakState' a b -&gt; BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#pairF"><span class="hs-identifier hs-var">pairF</span></a></span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277677"><span class="hs-identifier hs-var">performTC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. BreakState' a b -&gt; BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#pairF"><span class="hs-identifier hs-var">pairF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall (m :: * -&gt; *) a.
(Monad m, Plated a) =&gt;
(a -&gt; m a) -&gt; a -&gt; m a
</span><a href="file:///nix/store/fn5r8vd6lkpbiy7gl9dwbkx2mwiyxydf-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier hs-var">transformM</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277646"><span class="hs-identifier hs-var">changeFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679277655"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall (m :: * -&gt; *) a.
(Monad m, Plated a) =&gt;
(a -&gt; m a) -&gt; a -&gt; m a
</span><a href="file:///nix/store/fn5r8vd6lkpbiy7gl9dwbkx2mwiyxydf-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier hs-var">transformM</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277646"><span class="hs-identifier hs-var">changeFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679277656"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>        </span><span id="local-6989586621679277683"><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679277683"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a.
a
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679277683"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><a href="#local-6989586621679277684"><span class="hs-identifier hs-type">insertChanged</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-86"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span>
</span><span id="line-87"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#BreakState"><span class="hs-identifier hs-type">BreakState</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>      </span><span id="local-6989586621679277684"><span class="annot"><span class="annottext">insertChanged :: FragIndex
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; BreakState RecursionPieceFrag () ()
</span><a href="#local-6989586621679277684"><span class="hs-identifier hs-var hs-var">insertChanged</span></a></span></span><span> </span><span id="local-6989586621679277685"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277685"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621679277686"><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679277686"><span class="hs-identifier hs-var">nv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((), FragIndex,
  Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
 -&gt; ((), FragIndex,
     Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)))
-&gt; BreakState RecursionPieceFrag () ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277688"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277688"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277689"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277689"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277688"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277685"><span class="hs-identifier hs-var">nk</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679277686"><span class="hs-identifier hs-var">nv</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277689"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>      </span><span id="local-6989586621679277699"><span class="annot"><span class="annottext">builder :: StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  (Map FragIndex ())
</span><a href="#local-6989586621679277699"><span class="hs-identifier hs-var hs-var">builder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (BreakState RecursionPieceFrag () ())
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     (Map FragIndex ())
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a.
Monad m =&gt;
Map FragIndex (m a) -&gt; m (Map FragIndex a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (BreakState RecursionPieceFrag () ())
 -&gt; StateT
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      Identity
      (Map FragIndex ()))
-&gt; Map FragIndex (BreakState RecursionPieceFrag () ())
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     (Map FragIndex ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex
 -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; BreakState RecursionPieceFrag () ())
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex (BreakState RecursionPieceFrag () ())
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679277702"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277702"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679277703"><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679277703"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall (m :: * -&gt; *) a.
(Monad m, Plated a) =&gt;
(a -&gt; m a) -&gt; a -&gt; m a
</span><a href="file:///nix/store/fn5r8vd6lkpbiy7gl9dwbkx2mwiyxydf-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier hs-var">transformM</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277646"><span class="hs-identifier hs-var">changeFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679277703"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; (Cofree (FragExprF RecursionPieceFrag) LocTag
    -&gt; BreakState RecursionPieceFrag () ())
-&gt; BreakState RecursionPieceFrag () ()
forall a b.
StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  a
-&gt; (a
    -&gt; StateT
         ((), FragIndex,
          Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
         Identity
         b)
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; BreakState RecursionPieceFrag () ()
</span><a href="#local-6989586621679277684"><span class="hs-identifier hs-var">insertChanged</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277702"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277637"><span class="hs-identifier hs-var">unURedMap</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FragIndex
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679277704"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277704"><span class="hs-identifier hs-var">newMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  (Map FragIndex ())
-&gt; ((), FragIndex,
    Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; ((), FragIndex,
    Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
forall s a. State s a -&gt; s -&gt; s
</span><span class="hs-identifier hs-var">State.execState</span></span><span> </span><span class="annot"><span class="annottext">StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  (Map FragIndex ())
</span><a href="#local-6989586621679277699"><span class="hs-identifier hs-var">builder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277641"><span class="hs-identifier hs-var">startKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277637"><span class="hs-identifier hs-var">unURedMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>      </span><span id="local-6989586621679277014"><span id="local-6989586621679277015"><span id="local-6989586621679277016"><span class="annot"><a href="#local-6989586621679277706"><span class="hs-identifier hs-type">changeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679277014"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679277015"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679277016"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679277015"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-92"></span><span>      </span><span id="local-6989586621679277706"><span class="annot"><span class="annottext">changeType :: forall a x b. FragExprF a x -&gt; FragExprF b x
</span><a href="#local-6989586621679277706"><span class="hs-identifier hs-var hs-var">changeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#ZeroFragF"><span class="hs-identifier hs-var">ZeroFragF</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#ZeroFragF"><span class="hs-identifier hs-var">ZeroFragF</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><a href="Telomare.html#PairFragF"><span class="hs-identifier hs-type">PairFragF</span></a></span><span> </span><span id="local-6989586621679277711"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277711"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679277712"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277712"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; FragExprF b x
forall a r. r -&gt; r -&gt; FragExprF a r
</span><a href="Telomare.html#PairFragF"><span class="hs-identifier hs-var">PairFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277711"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277712"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#EnvFragF"><span class="hs-identifier hs-var">EnvFragF</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#EnvFragF"><span class="hs-identifier hs-var">EnvFragF</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><a href="Telomare.html#SetEnvFragF"><span class="hs-identifier hs-type">SetEnvFragF</span></a></span><span> </span><span id="local-6989586621679277715"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277715"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; FragExprF b x
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#SetEnvFragF"><span class="hs-identifier hs-var">SetEnvFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277715"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><a href="Telomare.html#DeferFragF"><span class="hs-identifier hs-type">DeferFragF</span></a></span><span> </span><span id="local-6989586621679277717"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277717"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragExprF b x
forall a r. FragIndex -&gt; FragExprF a r
</span><a href="Telomare.html#DeferFragF"><span class="hs-identifier hs-var">DeferFragF</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679277717"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#AbortFragF"><span class="hs-identifier hs-var">AbortFragF</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#AbortFragF"><span class="hs-identifier hs-var">AbortFragF</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="Telomare.html#GateFragF"><span class="hs-identifier hs-type">GateFragF</span></a></span><span> </span><span id="local-6989586621679277720"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277720"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679277721"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277721"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; FragExprF b x
forall a r. r -&gt; r -&gt; FragExprF a r
</span><a href="Telomare.html#GateFragF"><span class="hs-identifier hs-var">GateFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277720"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277721"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><a href="Telomare.html#LeftFragF"><span class="hs-identifier hs-type">LeftFragF</span></a></span><span> </span><span id="local-6989586621679277723"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277723"><span class="hs-identifier hs-var">x</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; FragExprF b x
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#LeftFragF"><span class="hs-identifier hs-var">LeftFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277723"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><a href="Telomare.html#RightFragF"><span class="hs-identifier hs-type">RightFragF</span></a></span><span> </span><span id="local-6989586621679277725"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277725"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; FragExprF b x
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#RightFragF"><span class="hs-identifier hs-var">RightFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679277725"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#TraceFragF"><span class="hs-identifier hs-var">TraceFragF</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#TraceFragF"><span class="hs-identifier hs-var">TraceFragF</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span id="local-6989586621679277727"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277727"><span class="hs-identifier hs-var">z</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; FragExprF b x
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convertPT should be no AuxFrags here TODO&quot;</span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4
</span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4)
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; Cofree (FragExprF Void) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag)
forall a b. (a -&gt; b) -&gt; Map FragIndex a -&gt; Map FragIndex b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. FragExprF RecursionPieceFrag x -&gt; FragExprF Void x)
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; Cofree (FragExprF Void) LocTag
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
Functor f =&gt;
(forall x. f x -&gt; g x) -&gt; Cofree f a -&gt; Cofree g a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#hoistCofree"><span class="hs-identifier hs-var">hoistCofree</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF RecursionPieceFrag x -&gt; FragExprF Void x
forall x. FragExprF RecursionPieceFrag x -&gt; FragExprF Void x
forall a x b. FragExprF a x -&gt; FragExprF b x
</span><a href="#local-6989586621679277706"><span class="hs-identifier hs-var">changeType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679277704"><span class="hs-identifier hs-var">newMap</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Telomare.Eval.html#findChurchSizeD"><span class="hs-identifier hs-type">findChurchSizeD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-107"></span><span id="findChurchSizeD"><span class="annot"><span class="annottext">findChurchSizeD :: Bool -&gt; Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#findChurchSizeD"><span class="hs-identifier hs-var hs-var">findChurchSizeD</span></a></span></span><span> </span><span id="local-6989586621679277730"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679277730"><span class="hs-identifier hs-var">useSizing</span></a></span></span><span> </span><span id="local-6989586621679277731"><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277731"><span class="hs-identifier hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679277730"><span class="hs-identifier hs-var">useSizing</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#calculateRecursionLimits"><span class="hs-identifier hs-var">calculateRecursionLimits</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277731"><span class="hs-identifier hs-var">t3</span></a></span><span>  </span><span class="hs-comment">-- Use sizing algorithm</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnsizedRecursionToken -&gt; Int) -&gt; Term3 -&gt; Term4
</span><a href="Telomare.Eval.html#convertPT"><span class="hs-identifier hs-var">convertPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; UnsizedRecursionToken -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277731"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Use fixed size of 255</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-type">findChurchSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-113"></span><span id="findChurchSize"><span class="annot"><span class="annottext">findChurchSize :: Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-var hs-var">findChurchSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#findChurchSizeD"><span class="hs-identifier hs-var">findChurchSizeD</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- True</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- rather than remove checks, we should extract them so that they can be run separately, if that gives a performance benefit</span><span>
</span><span id="line-116"></span><span class="hs-comment">{-
removeChecks :: Term4 -&gt; Term4
removeChecks (Term4 m) =
  let f = \case
        anno :&lt; AbortFragF -&gt; anno :&lt; DeferFragF ind
        x                  -&gt; x
      (ind, newM) = State.runState builder m
      builder = do
        envDefer &lt;- insertAndGetKey $ DummyLoc :&lt; EnvFragF
        insertAndGetKey $ DummyLoc :&lt; DeferFragF envDefer
  in Term4 $ Map.map (transform f) newM
-}</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-type">removeChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-129"></span><span id="removeChecks"><span class="annot"><span class="annottext">removeChecks :: Term4 -&gt; Term4
</span><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-var hs-var">removeChecks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Term4
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-type">runStaticChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-132"></span><span id="runStaticChecks"><span class="annot"><span class="annottext">runStaticChecks :: Term4 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-var hs-var">runStaticChecks</span></a></span></span><span> </span><span id="local-6989586621679277738"><span class="annot"><span class="annottext">t :: Term4
</span><a href="#local-6989586621679277738"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679277739"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679277739"><span class="hs-identifier hs-var">termMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679277740"><span class="annot"><span class="annottext">result :: Maybe IExpr
</span><a href="#local-6989586621679277740"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StaticCheckExpr -&gt; Maybe IExpr
</span><a href="Telomare.Possible.html#evalA"><span class="hs-identifier hs-var">evalA</span></a></span><span> </span><span class="annot"><span class="annottext">StaticCheckExpr
</span><a href="#local-6989586621679277741"><span class="hs-identifier hs-var">scTerm</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621679277741"><span class="annot"><span class="annottext">scTerm :: StaticCheckExpr
</span><a href="#local-6989586621679277741"><span class="hs-identifier hs-var hs-var">scTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; StaticCheckExpr
forall g (f :: * -&gt; *).
(Base g ~ f, BasicBase f, StuckBase f, AbortBase f,
 Corecursive g) =&gt;
Term4 -&gt; g
</span><a href="Telomare.Possible.html#term4toAbortExpr"><span class="hs-identifier hs-var">term4toAbortExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679277738"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe IExpr -&gt; Maybe IExpr
forall a. String -&gt; a -&gt; a
</span><a href="Telomare.Eval.html#debugTrace"><span class="hs-identifier hs-var">debugTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;running static checks for:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; String
forall p. PrettyPrintable p =&gt; p -&gt; String
</span><a href="PrettyPrint.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679277738"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
</span><a href="#local-6989586621679277740"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679277738"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679277757"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277757"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError Term4
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError Term4)
-&gt; (String -&gt; EvalError) -&gt; String -&gt; Either EvalError Term4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; EvalError
</span><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either EvalError Term4)
-&gt; String -&gt; Either EvalError Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
</span><a href="Telomare.html#convertAbortMessage"><span class="hs-identifier hs-var">convertAbortMessage</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277757"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><a href="Telomare.Eval.html#compileMain"><span class="hs-identifier hs-type">compileMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span>
</span><span id="line-140"></span><span id="compileMain"><span class="annot"><span class="annottext">compileMain :: Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileMain"><span class="hs-identifier hs-var hs-var">compileMain</span></a></span></span><span> </span><span id="local-6989586621679277759"><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277759"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PartialType -&gt; Term3 -&gt; Maybe TypeCheckError
</span><a href="Telomare.TypeChecker.html#typeCheck"><span class="hs-identifier hs-var">typeCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PartialType -&gt; PartialType -&gt; PartialType
</span><a href="Telomare.html#PairTypeP"><span class="hs-identifier hs-var">PairTypeP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PartialType -&gt; PartialType -&gt; PartialType
</span><a href="Telomare.html#ArrTypeP"><span class="hs-identifier hs-var">ArrTypeP</span></a></span><span> </span><span class="annot"><span class="annottext">PartialType
</span><a href="Telomare.html#ZeroTypeP"><span class="hs-identifier hs-var">ZeroTypeP</span></a></span><span> </span><span class="annot"><span class="annottext">PartialType
</span><a href="Telomare.html#ZeroTypeP"><span class="hs-identifier hs-var">ZeroTypeP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PartialType
</span><a href="Telomare.html#AnyType"><span class="hs-identifier hs-var">AnyType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277759"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679277764"><span class="annot"><span class="annottext">TypeCheckError
</span><a href="#local-6989586621679277764"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError CompiledExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError CompiledExpr)
-&gt; EvalError -&gt; Either EvalError CompiledExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeCheckError -&gt; EvalError
</span><a href="Telomare.Eval.html#TCE"><span class="hs-identifier hs-var">TCE</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCheckError
</span><a href="#local-6989586621679277764"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">Maybe TypeCheckError
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Either EvalError Term4)
-&gt; Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277759"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-comment">-- TODO add runStaticChecks back in</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- for testing</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Telomare.Eval.html#compileMain%27"><span class="hs-identifier hs-type">compileMain'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span>
</span><span id="line-146"></span><span id="compileMain%27"><span class="annot"><span class="annottext">compileMain' :: Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileMain%27"><span class="hs-identifier hs-var hs-var">compileMain'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Either EvalError Term4)
-&gt; Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-type">compileUnitTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span>
</span><span id="line-149"></span><span id="compileUnitTest"><span class="annot"><span class="annottext">compileUnitTest :: Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-var hs-var">compileUnitTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Either EvalError Term4)
-&gt; Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-var">runStaticChecks</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- TODO kind of a hack, really CompiledExpr should be the basis for TelomareLike</span><span>
</span><span id="line-152"></span><span class="annot"><a href="Telomare.Eval.html#compileUnitTestNoAbort"><span class="hs-identifier hs-type">compileUnitTestNoAbort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span>
</span><span id="line-153"></span><span id="compileUnitTestNoAbort"><span class="annot"><span class="annottext">compileUnitTestNoAbort :: Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileUnitTestNoAbort"><span class="hs-identifier hs-var hs-var">compileUnitTestNoAbort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CompiledExpr -&gt; CompiledExpr)
-&gt; Either EvalError CompiledExpr -&gt; Either EvalError CompiledExpr
forall a b. (a -&gt; b) -&gt; Either EvalError a -&gt; Either EvalError b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Base CompiledExpr CompiledExpr -&gt; CompiledExpr)
-&gt; CompiledExpr -&gt; CompiledExpr
forall t a. Recursive t =&gt; (Base t a -&gt; a) -&gt; t -&gt; a
forall a. (Base CompiledExpr a -&gt; a) -&gt; CompiledExpr -&gt; a
</span><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#cata"><span class="hs-identifier hs-var">cata</span></a></span><span> </span><span class="annot"><span class="annottext">Base CompiledExpr CompiledExpr -&gt; CompiledExpr
</span><a href="#local-6989586621679277769"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either EvalError CompiledExpr -&gt; Either EvalError CompiledExpr)
-&gt; (Term3 -&gt; Either EvalError CompiledExpr)
-&gt; Term3
-&gt; Either EvalError CompiledExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-var">compileUnitTest</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679277769"><span class="annot"><span class="annottext">f :: Base CompiledExpr CompiledExpr -&gt; CompiledExpr
</span><a href="#local-6989586621679277769"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Telomare.PossibleData.html#AbortFW"><span class="hs-identifier hs-type">AbortFW</span></a></span><span> </span><span class="annot"><span class="annottext">AbortableF CompiledExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CompiledExpr -&gt; CompiledExpr
forall g (f :: * -&gt; *).
(Base g ~ f, StuckBase f, Recursive g, Corecursive g) =&gt;
Int -&gt; g -&gt; g
</span><a href="Telomare.Possible.html#deferB"><span class="hs-identifier hs-var">deferB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompiledExpr
forall g (f :: * -&gt; *).
(Base g ~ f, BasicBase f, Corecursive g) =&gt;
g
</span><a href="Telomare.PossibleData.html#envB"><span class="hs-identifier hs-var">envB</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679277786"><span class="annot"><span class="annottext">Base CompiledExpr CompiledExpr
</span><a href="#local-6989586621679277786"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Base CompiledExpr CompiledExpr -&gt; CompiledExpr
forall t. Corecursive t =&gt; Base t t -&gt; t
</span><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#embed"><span class="hs-identifier hs-var">embed</span></a></span><span> </span><span class="annot"><span class="annottext">Base CompiledExpr CompiledExpr
</span><a href="#local-6989586621679277786"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span>
</span><span id="line-159"></span><span id="compile"><span class="annot"><span class="annottext">compile :: (Term4 -&gt; Either EvalError Term4)
-&gt; Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span id="local-6989586621679277787"><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
</span><a href="#local-6989586621679277787"><span class="hs-identifier hs-var">staticCheck</span></a></span></span><span> </span><span id="local-6989586621679277788"><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277788"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either EvalError CompiledExpr -&gt; Either EvalError CompiledExpr
forall a. String -&gt; a -&gt; a
</span><a href="Telomare.Eval.html#debugTrace"><span class="hs-identifier hs-var">debugTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compiling term3:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; String
forall p. PrettyPrintable p =&gt; p -&gt; String
</span><a href="PrettyPrint.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277788"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="annottext">(Either EvalError CompiledExpr -&gt; Either EvalError CompiledExpr)
-&gt; Either EvalError CompiledExpr -&gt; Either EvalError CompiledExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; CompiledExpr
forall g (f :: * -&gt; *).
(Base g ~ f, BasicBase f, StuckBase f, AbortBase f,
 Corecursive g) =&gt;
Term4 -&gt; g
</span><a href="Telomare.Possible.html#term4toAbortExpr"><span class="hs-identifier hs-var">term4toAbortExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; CompiledExpr)
-&gt; (Term4 -&gt; Term4) -&gt; Term4 -&gt; CompiledExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Term4
</span><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-var">removeChecks</span></a></span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; CompiledExpr)
-&gt; Either EvalError Term4 -&gt; Either EvalError CompiledExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-var">findChurchSize</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277788"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Either EvalError Term4
-&gt; (Term4 -&gt; Either EvalError Term4) -&gt; Either EvalError Term4
forall a b.
Either EvalError a
-&gt; (a -&gt; Either EvalError b) -&gt; Either EvalError b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
</span><a href="#local-6989586621679277787"><span class="hs-identifier hs-var">staticCheck</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- converts between easily understood Haskell types and untyped IExprs around an iteration of a Telomare expression</span><span>
</span><span id="line-163"></span><span class="annot"><a href="Telomare.Eval.html#funWrap"><span class="hs-identifier hs-type">funWrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679277055"><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#AbstractRunTime"><span class="hs-identifier hs-type">AbstractRunTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679277055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span id="funWrap"><span class="annot"><span class="annottext">funWrap :: forall a.
(Show a, AbstractRunTime a) =&gt;
a
-&gt; (a -&gt; a -&gt; a)
-&gt; Maybe (String, IExpr)
-&gt; (String, Either RunTimeError a)
</span><a href="Telomare.Eval.html#funWrap"><span class="hs-identifier hs-var hs-var">funWrap</span></a></span></span><span> </span><span id="local-6989586621679277806"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277806"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679277807"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679277807"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span id="local-6989586621679277808"><span class="annot"><span class="annottext">Maybe (String, IExpr)
</span><a href="#local-6989586621679277808"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679277809"><span class="annot"><span class="annottext">iexpInp :: IExpr
</span><a href="#local-6989586621679277809"><span class="hs-identifier hs-var hs-var">iexpInp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (String, IExpr)
</span><a href="#local-6989586621679277808"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">Maybe (String, IExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679277811"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277811"><span class="hs-identifier hs-var">userInp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277812"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277812"><span class="hs-identifier hs-var">oldState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IExpr
</span><a href="Telomare.html#s2g"><span class="hs-identifier hs-var">s2g</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277811"><span class="hs-identifier hs-var">userInp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277812"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either RunTimeError a
forall a. AbstractRunTime a =&gt; a -&gt; Either RunTimeError a
</span><a href="Telomare.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679277807"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277806"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; a
forall a. TelomareLike a =&gt; IExpr -&gt; a
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var">fromTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277809"><span class="hs-identifier hs-var">iexpInp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679277815"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277815"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe IExpr
forall a. TelomareLike a =&gt; a -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var">toTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277815"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error converting iteration value:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277815"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; Either RunTimeError a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; Either RunTimeError a)
-&gt; RunTimeError -&gt; Either RunTimeError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; RunTimeError
</span><a href="Telomare.html#AbortRunTime"><span class="hs-identifier hs-var">AbortRunTime</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;aborted&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; Either RunTimeError a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; Either RunTimeError a)
-&gt; RunTimeError -&gt; Either RunTimeError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; RunTimeError
</span><a href="Telomare.html#AbortRunTime"><span class="hs-identifier hs-var">AbortRunTime</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679277819"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277819"><span class="hs-identifier hs-var">disp</span></a></span></span><span> </span><span id="local-6989586621679277820"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277820"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; String
</span><a href="Telomare.html#g2s"><span class="hs-identifier hs-var">g2s</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277819"><span class="hs-identifier hs-var">disp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either RunTimeError a
forall a. a -&gt; Either RunTimeError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either RunTimeError a) -&gt; a -&gt; Either RunTimeError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; a
forall a. TelomareLike a =&gt; IExpr -&gt; a
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var">fromTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277820"><span class="hs-identifier hs-var">newState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679277821"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277821"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unexpected runtime value, dumped:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277821"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; Either RunTimeError a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; Either RunTimeError a)
-&gt; RunTimeError -&gt; Either RunTimeError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; RunTimeError
</span><a href="Telomare.html#GenericRunTimeError"><span class="hs-identifier hs-var">GenericRunTimeError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unexpected runtime value&quot;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277821"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679277823"><span class="annot"><span class="annottext">RunTimeError
</span><a href="#local-6989586621679277823"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;runtime error:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError
</span><a href="#local-6989586621679277823"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; Either RunTimeError a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError
</span><a href="#local-6989586621679277823"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span id="local-6989586621679277060"><span class="annot"><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-type">runMainCore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679277060"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679277060"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-177"></span><span id="runMainCore"><span class="annot"><span class="annottext">runMainCore :: forall a.
[(String, String)] -&gt; String -&gt; (CompiledExpr -&gt; IO a) -&gt; IO a
</span><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-var hs-var">runMainCore</span></a></span></span><span> </span><span id="local-6989586621679277845"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277845"><span class="hs-identifier hs-var">modulesStrings</span></a></span></span><span> </span><span id="local-6989586621679277846"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277846"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679277847"><span class="annot"><span class="annottext">CompiledExpr -&gt; IO a
</span><a href="#local-6989586621679277847"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679277848"><span class="hs-identifier hs-type">parsedModules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>      </span><span id="local-6989586621679277848"><span class="annot"><span class="annottext">parsedModules :: [(String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277848"><span class="hs-identifier hs-var hs-var">parsedModules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String, String)
 -&gt; (String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)]))
-&gt; [(String, String)]
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((String, String)
  -&gt; (String,
      Either String [Either AnnotatedUPT (String, AnnotatedUPT)]))
 -&gt; [(String, String)]
 -&gt; [(String,
      Either String [Either AnnotatedUPT (String, AnnotatedUPT)])])
-&gt; ((String
     -&gt; Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
    -&gt; (String, String)
    -&gt; (String,
        Either String [Either AnnotatedUPT (String, AnnotatedUPT)]))
-&gt; (String
    -&gt; Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; [(String, String)]
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; (String, String)
-&gt; (String,
    Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
forall a b. (a -&gt; b) -&gt; (String, a) -&gt; (String, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parseModule"><span class="hs-identifier hs-var">parseModule</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277845"><span class="hs-identifier hs-var">modulesStrings</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><a href="#local-6989586621679277849"><span class="hs-identifier hs-type">parsedModulesErrors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>      </span><span id="local-6989586621679277849"><span class="annot"><span class="annottext">parsedModulesErrors :: [(String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277849"><span class="hs-identifier hs-var hs-var">parsedModulesErrors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
 -&gt; Bool)
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679277850"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277850"><span class="hs-identifier hs-var">moduleStr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277851"><span class="annot"><span class="annottext">Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
</span><a href="#local-6989586621679277851"><span class="hs-identifier hs-var">parsed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
</span><a href="#local-6989586621679277851"><span class="hs-identifier hs-var">parsed</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>                                      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-183"></span><span>                                      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">[Either AnnotatedUPT (String, AnnotatedUPT)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                                   </span><span class="annot"><span class="annottext">[(String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277848"><span class="hs-identifier hs-var">parsedModules</span></a></span><span>
</span><span id="line-185"></span><span>      </span><span id="local-6989586621679277854"><span class="annot"><span class="annottext">flattenLeft :: Either a b -&gt; a
</span><a href="#local-6989586621679277854"><span class="hs-identifier hs-var hs-var">flattenLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679277855"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277855"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277855"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679277856"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679277856"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;flattenLeft error: got a Right when it should be Left&quot;</span></span><span>
</span><span id="line-188"></span><span>      </span><span id="local-6989586621679277859"><span class="annot"><span class="annottext">flattenRight :: Either a b -&gt; b
</span><a href="#local-6989586621679277859"><span class="hs-identifier hs-var hs-var">flattenRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679277860"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679277860"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679277860"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679277861"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679277861"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;flattenRight error: got a Left when it should be Right&quot;</span></span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><a href="#local-6989586621679277862"><span class="hs-identifier hs-type">modules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>      </span><span id="local-6989586621679277862"><span class="annot"><span class="annottext">modules :: [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277862"><span class="hs-identifier hs-var hs-var">modules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277849"><span class="hs-identifier hs-var">parsedModulesErrors</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
 -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)]))
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((String,
   Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
  -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)]))
 -&gt; [(String,
      Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
 -&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])])
-&gt; ((Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
     -&gt; [Either AnnotatedUPT (String, AnnotatedUPT)])
    -&gt; (String,
        Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
    -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)]))
-&gt; (Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
    -&gt; [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
 -&gt; [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; (String,
    Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)])
forall a b. (a -&gt; b) -&gt; (String, a) -&gt; (String, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
-&gt; [Either AnnotatedUPT (String, AnnotatedUPT)]
forall {a} {b}. Either a b -&gt; b
</span><a href="#local-6989586621679277859"><span class="hs-identifier hs-var">flattenRight</span></a></span><span> </span><span class="annot"><span class="annottext">[(String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277848"><span class="hs-identifier hs-var">parsedModules</span></a></span><span>
</span><span id="line-195"></span><span>          </span><span id="local-6989586621679277863"><span class="annot"><span class="annottext">[(String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277863"><span class="hs-identifier hs-var">errors</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679277864"><span class="hs-identifier hs-type">moduleWithError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>                        </span><span id="local-6989586621679277864"><span class="annot"><span class="annottext">moduleWithError :: [(String, String)]
</span><a href="#local-6989586621679277864"><span class="hs-identifier hs-var hs-var">moduleWithError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
 -&gt; (String, String))
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [(String, String)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((String,
   Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
  -&gt; (String, String))
 -&gt; [(String,
      Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
 -&gt; [(String, String)])
-&gt; ((Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
     -&gt; String)
    -&gt; (String,
        Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
    -&gt; (String, String))
-&gt; (Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
    -&gt; String)
-&gt; [(String,
     Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [(String, String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
 -&gt; String)
-&gt; (String,
    Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; (String, String)
forall a b. (a -&gt; b) -&gt; (String, a) -&gt; (String, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
-&gt; String
forall {a} {b}. Either a b -&gt; a
</span><a href="#local-6989586621679277854"><span class="hs-identifier hs-var">flattenLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[(String,
  Either String [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277849"><span class="hs-identifier hs-var">parsedModulesErrors</span></a></span><span>
</span><span id="line-197"></span><span>                        </span><span class="annot"><a href="#local-6989586621679277865"><span class="hs-identifier hs-type">joinModuleError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-198"></span><span>                        </span><span id="local-6989586621679277865"><span class="annot"><span class="annottext">joinModuleError :: (String, String) -&gt; String
</span><a href="#local-6989586621679277865"><span class="hs-identifier hs-var hs-var">joinModuleError</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679277866"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277866"><span class="hs-identifier hs-var">moduleName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277867"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277867"><span class="hs-identifier hs-var">errorStr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error in module &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277866"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277867"><span class="hs-identifier hs-var">errorStr</span></a></span><span>
</span><span id="line-199"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])])
-&gt; ([String] -&gt; String)
-&gt; [String]
-&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String]
 -&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])])
-&gt; [String]
-&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
</span><a href="#local-6989586621679277865"><span class="hs-identifier hs-var">joinModuleError</span></a></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String) -&gt; [(String, String)] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277864"><span class="hs-identifier hs-var">moduleWithError</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileMain"><span class="hs-identifier hs-var">compileMain</span></a></span><span> </span><span class="annot"><span class="annottext">(Term3 -&gt; Either EvalError CompiledExpr)
-&gt; Either String Term3
-&gt; Either String (Either EvalError CompiledExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; String -&gt; Either String Term3
</span><a href="Telomare.Resolver.html#main2Term3"><span class="hs-identifier hs-var">main2Term3</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679277862"><span class="hs-identifier hs-var">modules</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277846"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679277869"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277869"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO a) -&gt; String -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;failed to parse &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277846"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277869"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679277871"><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277871"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; IO a
</span><a href="#local-6989586621679277847"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277871"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-205"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679277872"><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679277872"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO a) -&gt; String -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compilation failed somehow, with result:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679277872"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><a href="Telomare.Eval.html#runMain_"><span class="hs-identifier hs-type">runMain_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-208"></span><span id="runMain_"><span class="annot"><span class="annottext">runMain_ :: [(String, String)] -&gt; String -&gt; IO String
</span><a href="Telomare.Eval.html#runMain_"><span class="hs-identifier hs-var hs-var">runMain_</span></a></span></span><span> </span><span id="local-6989586621679277874"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277874"><span class="hs-identifier hs-var">modulesStrings</span></a></span></span><span> </span><span id="local-6989586621679277875"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277875"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
-&gt; String -&gt; (CompiledExpr -&gt; IO String) -&gt; IO String
forall a.
[(String, String)] -&gt; String -&gt; (CompiledExpr -&gt; IO a) -&gt; IO a
</span><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-var">runMainCore</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277874"><span class="hs-identifier hs-var">modulesStrings</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277875"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; IO String
</span><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-var">evalLoop_</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Telomare.Eval.html#runMain"><span class="hs-identifier hs-type">runMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span id="runMain"><span class="annot"><span class="annottext">runMain :: [(String, String)] -&gt; String -&gt; IO ()
</span><a href="Telomare.Eval.html#runMain"><span class="hs-identifier hs-var hs-var">runMain</span></a></span></span><span> </span><span id="local-6989586621679277878"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277878"><span class="hs-identifier hs-var">modulesStrings</span></a></span></span><span> </span><span id="local-6989586621679277879"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277879"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(String, String)] -&gt; String -&gt; (CompiledExpr -&gt; IO ()) -&gt; IO ()
forall a.
[(String, String)] -&gt; String -&gt; (CompiledExpr -&gt; IO a) -&gt; IO a
</span><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-var">runMainCore</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277878"><span class="hs-identifier hs-var">modulesStrings</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277879"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; IO ()
</span><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-var">evalLoop</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Telomare.Eval.html#runMainWithInput"><span class="hs-identifier hs-type">runMainWithInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-214"></span><span id="runMainWithInput"><span class="annot"><span class="annottext">runMainWithInput :: [String] -&gt; [(String, String)] -&gt; String -&gt; IO String
</span><a href="Telomare.Eval.html#runMainWithInput"><span class="hs-identifier hs-var hs-var">runMainWithInput</span></a></span></span><span> </span><span id="local-6989586621679277882"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277882"><span class="hs-identifier hs-var">inputList</span></a></span></span><span> </span><span id="local-6989586621679277883"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277883"><span class="hs-identifier hs-var">modulesStrings</span></a></span></span><span> </span><span id="local-6989586621679277884"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277884"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
-&gt; String -&gt; (CompiledExpr -&gt; IO String) -&gt; IO String
forall a.
[(String, String)] -&gt; String -&gt; (CompiledExpr -&gt; IO a) -&gt; IO a
</span><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-var">runMainCore</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679277883"><span class="hs-identifier hs-var">modulesStrings</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; CompiledExpr -&gt; IO String
</span><a href="Telomare.Eval.html#evalLoopWithInput"><span class="hs-identifier hs-var">evalLoopWithInput</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277882"><span class="hs-identifier hs-var">inputList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Telomare.Eval.html#schemeEval"><span class="hs-identifier hs-type">schemeEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span id="schemeEval"><span class="annot"><span class="annottext">schemeEval :: IExpr -&gt; IO ()
</span><a href="Telomare.Eval.html#schemeEval"><span class="hs-identifier hs-var hs-var">schemeEval</span></a></span></span><span> </span><span id="local-6989586621679277887"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277887"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scheme.txt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277887"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679277889"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679277889"><span class="hs-identifier hs-var">mhout</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">createProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; CreateProcess
</span><span class="hs-identifier hs-var">shell</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;chez-script runtime.so&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">std_out</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CreatePipe</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679277894"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277894"><span class="hs-identifier hs-var">scheme</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><span class="hs-identifier hs-var">hGetContents</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679277889"><span class="hs-identifier hs-var">mhout</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277894"><span class="hs-identifier hs-var">scheme</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-type">evalLoopCore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span>
</span><span id="line-224"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-226"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-228"></span><span id="evalLoopCore"><span class="annot"><span class="annottext">evalLoopCore :: CompiledExpr
-&gt; (String -&gt; String -&gt; IO String)
-&gt; String
-&gt; [String]
-&gt; IO String
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var hs-var">evalLoopCore</span></a></span></span><span> </span><span id="local-6989586621679277898"><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277898"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621679277899"><span class="annot"><span class="annottext">String -&gt; String -&gt; IO String
</span><a href="#local-6989586621679277899"><span class="hs-identifier hs-var">accumFn</span></a></span></span><span> </span><span id="local-6989586621679277900"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277900"><span class="hs-identifier hs-var">initAcc</span></a></span></span><span> </span><span id="local-6989586621679277901"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277901"><span class="hs-identifier hs-var">manualInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679277902"><span class="hs-identifier hs-type">wrappedEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>      </span><span id="local-6989586621679277902"><span class="annot"><span class="annottext">wrappedEval :: Maybe (String, IExpr) -&gt; (String, Either RunTimeError CompiledExpr)
</span><a href="#local-6989586621679277902"><span class="hs-identifier hs-var hs-var">wrappedEval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompiledExpr
-&gt; (CompiledExpr -&gt; CompiledExpr -&gt; CompiledExpr)
-&gt; Maybe (String, IExpr)
-&gt; (String, Either RunTimeError CompiledExpr)
forall a.
(Show a, AbstractRunTime a) =&gt;
a
-&gt; (a -&gt; a -&gt; a)
-&gt; Maybe (String, IExpr)
-&gt; (String, Either RunTimeError a)
</span><a href="Telomare.Eval.html#funWrap"><span class="hs-identifier hs-var">funWrap</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277898"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; CompiledExpr -&gt; CompiledExpr
forall g (f :: * -&gt; *).
(Base g ~ f, BasicBase f, StuckBase f, Recursive g,
 Corecursive g) =&gt;
g -&gt; g -&gt; g
</span><a href="Telomare.Possible.html#appB"><span class="hs-identifier hs-var">appB</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621679277925"><span class="annot"><span class="annottext">mainLoop :: String -&gt; [String] -&gt; Maybe (String, IExpr) -&gt; IO String
</span><a href="#local-6989586621679277925"><span class="hs-identifier hs-var hs-var">mainLoop</span></a></span></span><span> </span><span id="local-6989586621679277926"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277926"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679277927"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277927"><span class="hs-identifier hs-var">strInput</span></a></span></span><span> </span><span id="local-6989586621679277928"><span class="annot"><span class="annottext">Maybe (String, IExpr)
</span><a href="#local-6989586621679277928"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679277929"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277929"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277930"><span class="annot"><span class="annottext">Either RunTimeError CompiledExpr
</span><a href="#local-6989586621679277930"><span class="hs-identifier hs-var">nextState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (String, IExpr) -&gt; (String, Either RunTimeError CompiledExpr)
</span><a href="#local-6989586621679277902"><span class="hs-identifier hs-var">wrappedEval</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, IExpr)
</span><a href="#local-6989586621679277928"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span id="local-6989586621679277931"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277931"><span class="hs-identifier hs-var">newAcc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO String
</span><a href="#local-6989586621679277899"><span class="hs-identifier hs-var">accumFn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277926"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277929"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; Maybe IExpr
forall a. TelomareLike a =&gt; a -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var">toTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">(CompiledExpr -&gt; Maybe IExpr)
-&gt; Either RunTimeError CompiledExpr
-&gt; Either RunTimeError (Maybe IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either RunTimeError CompiledExpr
</span><a href="#local-6989586621679277930"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277926"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-236"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277931"><span class="hs-identifier hs-var">newAcc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\ndone&quot;</span></span><span>
</span><span id="line-237"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277931"><span class="hs-identifier hs-var">newAcc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;done&quot;</span></span><span>
</span><span id="line-238"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679277932"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277932"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-239"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679277933"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277933"><span class="hs-identifier hs-var">inp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679277934"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277934"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-240"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277927"><span class="hs-identifier hs-var">strInput</span></a></span><span>
</span><span id="line-241"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, [String]))
-&gt; IO String -&gt; IO (String, [String])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getLine</span></span><span>
</span><span id="line-242"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(String, [String]) -&gt; IO (String, [String])
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277927"><span class="hs-identifier hs-var">strInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277927"><span class="hs-identifier hs-var">strInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Maybe (String, IExpr) -&gt; IO String
</span><a href="#local-6989586621679277925"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277931"><span class="hs-identifier hs-var">newAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277934"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (String, IExpr) -&gt; IO String)
-&gt; Maybe (String, IExpr) -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, IExpr) -&gt; Maybe (String, IExpr)
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277933"><span class="hs-identifier hs-var">inp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
forall a. TelomareLike a =&gt; IExpr -&gt; a
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var">fromTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277932"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Maybe (String, IExpr) -&gt; IO String
</span><a href="#local-6989586621679277925"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277900"><span class="hs-identifier hs-var">initAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277901"><span class="hs-identifier hs-var">manualInput</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, IExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-type">evalLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span id="evalLoop"><span class="annot"><span class="annottext">evalLoop :: CompiledExpr -&gt; IO ()
</span><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-var hs-var">evalLoop</span></a></span></span><span> </span><span id="local-6989586621679277939"><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277939"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO String -&gt; IO ()) -&gt; IO String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
-&gt; (String -&gt; String -&gt; IO String)
-&gt; String
-&gt; [String]
-&gt; IO String
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var">evalLoopCore</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277939"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO String
forall {p}. p -&gt; String -&gt; IO String
</span><a href="#local-6989586621679277940"><span class="hs-identifier hs-var">printAcc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621679277940"><span class="annot"><span class="annottext">printAcc :: p -&gt; String -&gt; IO String
</span><a href="#local-6989586621679277940"><span class="hs-identifier hs-var hs-var">printAcc</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679277943"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277943"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277943"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><a href="Telomare.Eval.html#evalLoopWithInput"><span class="hs-identifier hs-type">evalLoopWithInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-254"></span><span id="evalLoopWithInput"><span class="annot"><span class="annottext">evalLoopWithInput :: [String] -&gt; CompiledExpr -&gt; IO String
</span><a href="Telomare.Eval.html#evalLoopWithInput"><span class="hs-identifier hs-var hs-var">evalLoopWithInput</span></a></span></span><span> </span><span id="local-6989586621679277944"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277944"><span class="hs-identifier hs-var">inputList</span></a></span></span><span> </span><span id="local-6989586621679277945"><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277945"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompiledExpr
-&gt; (String -&gt; String -&gt; IO String)
-&gt; String
-&gt; [String]
-&gt; IO String
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var">evalLoopCore</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277945"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO String
forall {f :: * -&gt; *}. Applicative f =&gt; String -&gt; String -&gt; f String
</span><a href="#local-6989586621679277946"><span class="hs-identifier hs-var">printAcc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679277944"><span class="hs-identifier hs-var">inputList</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679277946"><span class="annot"><span class="annottext">printAcc :: String -&gt; String -&gt; f String
</span><a href="#local-6989586621679277946"><span class="hs-identifier hs-var hs-var">printAcc</span></a></span></span><span> </span><span id="local-6989586621679277957"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277957"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679277958"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277958"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277957"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-257"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; f String
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277958"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-258"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; f String
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277957"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277958"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><span class="hs-comment">-- |Same as `evalLoop`, but keeping what was displayed.</span></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-type">evalLoop_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#CompiledExpr"><span class="hs-identifier hs-type">CompiledExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-262"></span><span id="evalLoop_"><span class="annot"><span class="annottext">evalLoop_ :: CompiledExpr -&gt; IO String
</span><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-var hs-var">evalLoop_</span></a></span></span><span> </span><span id="local-6989586621679277959"><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277959"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompiledExpr
-&gt; (String -&gt; String -&gt; IO String)
-&gt; String
-&gt; [String]
-&gt; IO String
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var">evalLoopCore</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679277959"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO String
forall {f :: * -&gt; *}. Applicative f =&gt; String -&gt; String -&gt; f String
</span><a href="#local-6989586621679277960"><span class="hs-identifier hs-var">printAcc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679277960"><span class="annot"><span class="annottext">printAcc :: String -&gt; String -&gt; f String
</span><a href="#local-6989586621679277960"><span class="hs-identifier hs-var hs-var">printAcc</span></a></span></span><span> </span><span id="local-6989586621679277970"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277970"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679277971"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277971"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277970"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-265"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; f String
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277971"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-266"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; f String
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277970"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277971"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Telomare.Eval.html#calculateRecursionLimits"><span class="hs-identifier hs-type">calculateRecursionLimits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-269"></span><span id="calculateRecursionLimits"><span class="annot"><span class="annottext">calculateRecursionLimits :: Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#calculateRecursionLimits"><span class="hs-identifier hs-var hs-var">calculateRecursionLimits</span></a></span></span><span> </span><span id="local-6989586621679277972"><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277972"><span class="hs-identifier hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679277973"><span class="hs-identifier hs-type">abortExprToTerm4'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.PossibleData.html#AbortExpr"><span class="hs-identifier hs-type">AbortExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621679277973"><span class="annot"><span class="annottext">abortExprToTerm4' :: AbortExpr -&gt; Either IExpr Term4
</span><a href="#local-6989586621679277973"><span class="hs-identifier hs-var hs-var">abortExprToTerm4'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbortExpr -&gt; Either IExpr Term4
forall g (f :: * -&gt; *).
(Base g ~ f, BasicBase f, StuckBase f, AbortBase f, Foldable f,
 Recursive g) =&gt;
g -&gt; Either IExpr Term4
</span><a href="Telomare.Possible.html#abortExprToTerm4"><span class="hs-identifier hs-var">abortExprToTerm4</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span id="local-6989586621679277975"><span class="annot"><span class="annottext">limitSize :: Int
</span><a href="#local-6989586621679277975"><span class="hs-identifier hs-var hs-var">limitSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(AbortExpr -&gt; Either IExpr Term4)
-&gt; Either UnsizedRecursionToken AbortExpr
-&gt; Either UnsizedRecursionToken (Either IExpr Term4)
forall a b.
(a -&gt; b)
-&gt; Either UnsizedRecursionToken a -&gt; Either UnsizedRecursionToken b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">AbortExpr -&gt; Either IExpr Term4
</span><a href="#local-6989586621679277973"><span class="hs-identifier hs-var">abortExprToTerm4'</span></a></span><span> </span><span class="annot"><span class="annottext">(Either UnsizedRecursionToken AbortExpr
 -&gt; Either UnsizedRecursionToken (Either IExpr Term4))
-&gt; (UnsizedExpr -&gt; Either UnsizedRecursionToken AbortExpr)
-&gt; UnsizedExpr
-&gt; Either UnsizedRecursionToken (Either IExpr Term4)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnsizedExpr -&gt; Either UnsizedRecursionToken AbortExpr
</span><a href="Telomare.Possible.html#sizeTermM"><span class="hs-identifier hs-var">sizeTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679277975"><span class="hs-identifier hs-var">limitSize</span></a></span><span> </span><span class="annot"><span class="annottext">(UnsizedExpr -&gt; Either UnsizedRecursionToken (Either IExpr Term4))
-&gt; UnsizedExpr -&gt; Either UnsizedRecursionToken (Either IExpr Term4)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term3 -&gt; UnsizedExpr
</span><a href="Telomare.Possible.html#term3ToUnsizedExpr"><span class="hs-identifier hs-var">term3ToUnsizedExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679277975"><span class="hs-identifier hs-var">limitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679277972"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679277976"><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679277976"><span class="hs-identifier hs-var">urt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError Term4
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError Term4)
-&gt; EvalError -&gt; Either EvalError Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; EvalError
</span><a href="Telomare.Eval.html#RecursionLimitError"><span class="hs-identifier hs-var">RecursionLimitError</span></a></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679277976"><span class="hs-identifier hs-var">urt</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679277977"><span class="annot"><span class="annottext">Either IExpr Term4
</span><a href="#local-6989586621679277977"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IExpr Term4
</span><a href="#local-6989586621679277977"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679277978"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277978"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError Term4
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError Term4)
-&gt; (IExpr -&gt; EvalError) -&gt; IExpr -&gt; Either EvalError Term4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; EvalError
</span><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; EvalError) -&gt; (IExpr -&gt; String) -&gt; IExpr -&gt; EvalError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
</span><a href="Telomare.html#convertAbortMessage"><span class="hs-identifier hs-var">convertAbortMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; Either EvalError Term4)
-&gt; IExpr -&gt; Either EvalError Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679277978"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679277979"><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679277979"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679277979"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- takes a main function and sizes the unsized recursion and then displays the results as comments in the original source</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Telomare.Eval.html#showSizingInSource"><span class="hs-identifier hs-type">showSizingInSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-281"></span><span id="showSizingInSource"><span class="annot"><span class="annottext">showSizingInSource :: String -&gt; ShowS
</span><a href="Telomare.Eval.html#showSizingInSource"><span class="hs-identifier hs-var hs-var">showSizingInSource</span></a></span></span><span> </span><span id="local-6989586621679277981"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277981"><span class="hs-identifier hs-var">prelude</span></a></span></span><span> </span><span id="local-6989586621679277982"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277982"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679277985"><span class="annot"><span class="annottext">asLines :: [(Int, String)]
</span><a href="#local-6989586621679277985"><span class="hs-identifier hs-var hs-var">asLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [String] -&gt; [(Int, String)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [(Int, String)]) -&gt; [String] -&gt; [(Int, String)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277982"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span id="local-6989586621679277988"><span class="annot"><span class="annottext">parsed :: Either String Term3
</span><a href="#local-6989586621679277988"><span class="hs-identifier hs-var hs-var">parsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [(String, AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier hs-var">parsePrelude</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277981"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">Either String [(String, AnnotatedUPT)]
-&gt; ([(String, AnnotatedUPT)] -&gt; Either String Term3)
-&gt; Either String Term3
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, AnnotatedUPT)] -&gt; String -&gt; Either String Term3
</span><a href="Telomare.Eval.html#parseMain"><span class="hs-operator hs-var">`parseMain`</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679277982"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621679277991"><span class="annot"><span class="annottext">unsizedExpr :: Either String UnsizedExpr
</span><a href="#local-6989586621679277991"><span class="hs-identifier hs-var hs-var">unsizedExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term3 -&gt; UnsizedExpr
</span><a href="Telomare.Possible.html#term3ToUnsizedExpr"><span class="hs-identifier hs-var">term3ToUnsizedExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">(Term3 -&gt; UnsizedExpr)
-&gt; Either String Term3 -&gt; Either String UnsizedExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String Term3
</span><a href="#local-6989586621679277988"><span class="hs-identifier hs-var">parsed</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621679277996"><span class="annot"><span class="annottext">sizedRecursion :: Either String SizedRecursion
</span><a href="#local-6989586621679277996"><span class="hs-identifier hs-var hs-var">sizedRecursion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either String UnsizedExpr
</span><a href="#local-6989586621679277991"><span class="hs-identifier hs-var">unsizedExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Either String UnsizedExpr
-&gt; (UnsizedExpr -&gt; Either String SizedRecursion)
-&gt; Either String SizedRecursion
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnsizedRecursionToken -&gt; String)
-&gt; Either UnsizedRecursionToken SizedRecursion
-&gt; Either String SizedRecursion
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not size token: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; (UnsizedRecursionToken -&gt; String)
-&gt; UnsizedRecursionToken
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either UnsizedRecursionToken SizedRecursion
 -&gt; Either String SizedRecursion)
-&gt; (UnsizedExpr -&gt; Either UnsizedRecursionToken SizedRecursion)
-&gt; UnsizedExpr
-&gt; Either String SizedRecursion
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnsizedExpr -&gt; Either UnsizedRecursionToken SizedRecursion
</span><a href="Telomare.Possible.html#getSizesM"><span class="hs-identifier hs-var">getSizesM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>        </span><span id="local-6989586621679277998"><span class="annot"><span class="annottext">sizeLocs :: Either String [(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679277998"><span class="hs-identifier hs-var hs-var">sizeLocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map UnsizedRecursionToken LocTag
-&gt; [(UnsizedRecursionToken, LocTag)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">(Map UnsizedRecursionToken LocTag
 -&gt; [(UnsizedRecursionToken, LocTag)])
-&gt; (UnsizedExpr -&gt; Map UnsizedRecursionToken LocTag)
-&gt; UnsizedExpr
-&gt; [(UnsizedRecursionToken, LocTag)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UnsizedExpr -&gt; Map UnsizedRecursionToken LocTag
</span><a href="Telomare.Possible.html#buildUnsizedLocMap"><span class="hs-identifier hs-var">buildUnsizedLocMap</span></a></span><span> </span><span class="annot"><span class="annottext">(UnsizedExpr -&gt; [(UnsizedRecursionToken, LocTag)])
-&gt; Either String UnsizedExpr
-&gt; Either String [(UnsizedRecursionToken, LocTag)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String UnsizedExpr
</span><a href="#local-6989586621679277991"><span class="hs-identifier hs-var">unsizedExpr</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-comment">-- (orphanLocs, lineLocs) = partition ((== DummyLoc) . snd) sizeLocs</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679278007"><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278007"><span class="hs-identifier hs-var">orphanLocs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278008"><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278008"><span class="hs-identifier hs-var">lineLocs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String [(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679277998"><span class="hs-identifier hs-var">sizeLocs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679278009"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278009"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ([(UnsizedRecursionToken, LocTag)],
    [(UnsizedRecursionToken, LocTag)])
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not size: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278009"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679278010"><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278010"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((UnsizedRecursionToken, LocTag) -&gt; Bool)
-&gt; [(UnsizedRecursionToken, LocTag)]
-&gt; ([(UnsizedRecursionToken, LocTag)],
    [(UnsizedRecursionToken, LocTag)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag -&gt; LocTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LocTag -&gt; Bool)
-&gt; ((UnsizedRecursionToken, LocTag) -&gt; LocTag)
-&gt; (UnsizedRecursionToken, LocTag)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UnsizedRecursionToken, LocTag) -&gt; LocTag
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278010"><span class="hs-identifier hs-var">sl</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-comment">-- orphanList = map ((&lt;&gt; &quot; &quot;) . show . fst) orphanLocs</span><span>
</span><span id="line-292"></span><span>        </span><span id="local-6989586621679278018"><span class="annot"><span class="annottext">orphans :: String
</span><a href="#local-6989586621679278018"><span class="hs-identifier hs-var hs-var">orphans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsized with no location: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((UnsizedRecursionToken, LocTag) -&gt; String)
-&gt; [(UnsizedRecursionToken, LocTag)] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; ((UnsizedRecursionToken, LocTag) -&gt; String)
-&gt; (UnsizedRecursionToken, LocTag)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UnsizedRecursionToken -&gt; String)
-&gt; ((UnsizedRecursionToken, LocTag) -&gt; UnsizedRecursionToken)
-&gt; (UnsizedRecursionToken, LocTag)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UnsizedRecursionToken, LocTag) -&gt; UnsizedRecursionToken
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278007"><span class="hs-identifier hs-var">orphanLocs</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span id="local-6989586621679278022"><span class="annot"><span class="annottext">fromEnum' :: LocTag -&gt; Int
</span><a href="#local-6989586621679278022"><span class="hs-identifier hs-var hs-var">fromEnum'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-294"></span><span>          </span><span class="annot"><a href="Telomare.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span id="local-6989586621679278024"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278024"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278024"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-295"></span><span>          </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unexpected DummyLoc&quot;</span></span><span>
</span><span id="line-296"></span><span>        </span><span id="local-6989586621679278028"><span class="annot"><span class="annottext">lookupSize :: UnsizedRecursionToken -&gt; String
</span><a href="#local-6989586621679278028"><span class="hs-identifier hs-var hs-var">lookupSize</span></a></span></span><span> </span><span id="local-6989586621679278029"><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679278029"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String SizedRecursion
</span><a href="#local-6989586621679277996"><span class="hs-identifier hs-var">sizedRecursion</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-297"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.PossibleData.html#SizedRecursion"><span class="hs-identifier hs-type">SizedRecursion</span></a></span><span> </span><span id="local-6989586621679278031"><span class="annot"><span class="annottext">Map UnsizedRecursionToken (Maybe Int)
</span><a href="#local-6989586621679278031"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
-&gt; Map UnsizedRecursionToken (Maybe Int) -&gt; Maybe (Maybe Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679278029"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map UnsizedRecursionToken (Maybe Int)
</span><a href="#local-6989586621679278031"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679278033"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278033"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278033"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-299"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Maybe Int)
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-300"></span><span>          </span><span class="annot"><span class="annottext">Either String SizedRecursion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-comment">-- getSizeMatchingLine x = foldMap ((&lt;&gt; &quot; &quot;) . show) $ filter ((== x) . fromEnum' . snd) lineLocs</span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621679278045"><span class="annot"><span class="annottext">getSizeMatchingLine :: Int -&gt; String
</span><a href="#local-6989586621679278045"><span class="hs-identifier hs-var hs-var">getSizeMatchingLine</span></a></span></span><span> </span><span id="local-6989586621679278046"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278046"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((UnsizedRecursionToken, LocTag) -&gt; Bool)
-&gt; [(UnsizedRecursionToken, LocTag)]
-&gt; [(UnsizedRecursionToken, LocTag)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278046"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool)
-&gt; ((UnsizedRecursionToken, LocTag) -&gt; Int)
-&gt; (UnsizedRecursionToken, LocTag)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; Int
</span><a href="#local-6989586621679278022"><span class="hs-identifier hs-var">fromEnum'</span></a></span><span> </span><span class="annot"><span class="annottext">(LocTag -&gt; Int)
-&gt; ((UnsizedRecursionToken, LocTag) -&gt; LocTag)
-&gt; (UnsizedRecursionToken, LocTag)
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UnsizedRecursionToken, LocTag) -&gt; LocTag
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278008"><span class="hs-identifier hs-var">lineLocs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-304"></span><span>          </span><span id="local-6989586621679278047"><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278047"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;   # &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((UnsizedRecursionToken, LocTag) -&gt; String)
-&gt; [(UnsizedRecursionToken, LocTag)] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679278048"><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679278048"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679278048"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; String
</span><a href="#local-6989586621679278028"><span class="hs-identifier hs-var">lookupSize</span></a></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679278048"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnsizedRecursionToken -&gt; String)
-&gt; ((UnsizedRecursionToken, LocTag) -&gt; UnsizedRecursionToken)
-&gt; (UnsizedRecursionToken, LocTag)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UnsizedRecursionToken, LocTag) -&gt; UnsizedRecursionToken
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UnsizedRecursionToken, LocTag)]
</span><a href="#local-6989586621679278047"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;showSizingInSource\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278018"><span class="hs-identifier hs-var">orphans</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Int, String) -&gt; String) -&gt; [(Int, String)] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679278050"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278050"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278051"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278051"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278051"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679278045"><span class="hs-identifier hs-var">getSizeMatchingLine</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278050"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, String)]
</span><a href="#local-6989586621679277985"><span class="hs-identifier hs-var">asLines</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Telomare.Eval.html#showFunctionIndexesInSource"><span class="hs-identifier hs-type">showFunctionIndexesInSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-308"></span><span id="showFunctionIndexesInSource"><span class="annot"><span class="annottext">showFunctionIndexesInSource :: String -&gt; ShowS
</span><a href="Telomare.Eval.html#showFunctionIndexesInSource"><span class="hs-identifier hs-var hs-var">showFunctionIndexesInSource</span></a></span></span><span> </span><span id="local-6989586621679278053"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278053"><span class="hs-identifier hs-var">prelude</span></a></span></span><span> </span><span id="local-6989586621679278054"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278054"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679278057"><span class="annot"><span class="annottext">asLines :: [(Int, String)]
</span><a href="#local-6989586621679278057"><span class="hs-identifier hs-var hs-var">asLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [String] -&gt; [(Int, String)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [(Int, String)]) -&gt; [String] -&gt; [(Int, String)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278054"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-comment">-- parsed = parsePrelude prelude &gt;&gt;= (\p -&gt; parseMain p s)</span><span>
</span><span id="line-311"></span><span>        </span><span id="local-6989586621679278068"><span class="annot"><span class="annottext">funMap :: Map FragIndex FragExprUR
</span><a href="#local-6989586621679278068"><span class="hs-identifier hs-var hs-var">funMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [(String, AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier hs-var">parsePrelude</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278053"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">Either String [(String, AnnotatedUPT)]
-&gt; ([(String, AnnotatedUPT)] -&gt; Either String Term3)
-&gt; Either String Term3
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, AnnotatedUPT)] -&gt; String -&gt; Either String Term3
</span><a href="Telomare.Eval.html#parseMain"><span class="hs-operator hs-var">`parseMain`</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278054"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-312"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span id="local-6989586621679278069"><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679278069"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679278069"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-313"></span><span>          </span><span id="local-6989586621679278070"><span class="annot"><span class="annottext">Either String Term3
</span><a href="#local-6989586621679278070"><span class="hs-identifier hs-var">e</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Map FragIndex FragExprUR
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;could not parse &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String Term3 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Either String Term3
</span><a href="#local-6989586621679278070"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>        </span><span id="local-6989586621679278071"><span class="annot"><span class="annottext">unAss :: Cofree f a -&gt; a
</span><a href="#local-6989586621679278071"><span class="hs-identifier hs-var hs-var">unAss</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278072"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679278072"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">f (Cofree f a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679278072"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-comment">-- sizeLocs = (\(fi, t) -&gt; (fi))</span><span>
</span><span id="line-316"></span><span>        </span><span id="local-6989586621679278090"><span class="annot"><span class="annottext">reduceL :: CofreeF t LocTag (Min Int, Max Int) -&gt; (Min Int, Max Int)
</span><a href="#local-6989586621679278090"><span class="hs-identifier hs-var hs-var">reduceL</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278091"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679278091"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Trans.Cofree.html#%3A%3C"><span class="hs-operator hs-type">CofreeT.:&lt;</span></a></span><span> </span><span id="local-6989586621679278093"><span class="annot"><span class="annottext">t (Min Int, Max Int)
</span><a href="#local-6989586621679278093"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679278094"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679278094"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; Int
</span><a href="#local-6989586621679278095"><span class="hs-identifier hs-var">fromEnum'</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679278091"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Min Int
forall a. a -&gt; Min a
</span><span class="hs-identifier hs-var">Min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278094"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Max Int
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278094"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Min Int, Max Int) -&gt; (Min Int, Max Int) -&gt; (Min Int, Max Int)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">t (Min Int, Max Int) -&gt; (Min Int, Max Int)
forall m. Monoid m =&gt; t m -&gt; m
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">fold</span></span><span> </span><span class="annot"><span class="annottext">t (Min Int, Max Int)
</span><a href="#local-6989586621679278093"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621679278103"><span class="annot"><span class="annottext">bodyLocs :: [(FragIndex, (Min Int, Max Int))]
</span><a href="#local-6989586621679278103"><span class="hs-identifier hs-var hs-var">bodyLocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FragExprUR -&gt; (Min Int, Max Int))
-&gt; (FragIndex, FragExprUR) -&gt; (FragIndex, (Min Int, Max Int))
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CofreeF (FragExprF RecursionPieceFrag) LocTag (Min Int, Max Int)
 -&gt; (Min Int, Max Int))
-&gt; FragExprUR -&gt; (Min Int, Max Int)
forall c.
(CofreeF (FragExprF RecursionPieceFrag) LocTag c -&gt; c)
-&gt; FragExprUR -&gt; c
</span><a href="Telomare.html#cataFragExprUR"><span class="hs-identifier hs-var">cataFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">CofreeF (FragExprF RecursionPieceFrag) LocTag (Min Int, Max Int)
-&gt; (Min Int, Max Int)
forall {t :: * -&gt; *}.
Foldable t =&gt;
CofreeF t LocTag (Min Int, Max Int) -&gt; (Min Int, Max Int)
</span><a href="#local-6989586621679278090"><span class="hs-identifier hs-var">reduceL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((FragIndex, FragExprUR) -&gt; (FragIndex, (Min Int, Max Int)))
-&gt; [(FragIndex, FragExprUR)] -&gt; [(FragIndex, (Min Int, Max Int))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR -&gt; [(FragIndex, FragExprUR)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679278068"><span class="hs-identifier hs-var">funMap</span></a></span><span>
</span><span id="line-318"></span><span>        </span><span id="local-6989586621679278106"><span class="annot"><span class="annottext">sizeLocs :: [(FragIndex, LocTag)]
</span><a href="#local-6989586621679278106"><span class="hs-identifier hs-var hs-var">sizeLocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FragExprUR -&gt; LocTag)
-&gt; (FragIndex, FragExprUR) -&gt; (FragIndex, LocTag)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag -&gt; LocTag
forall {f :: * -&gt; *} {a}. Cofree f a -&gt; a
</span><a href="#local-6989586621679278071"><span class="hs-identifier hs-var">unAss</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag -&gt; LocTag)
-&gt; (FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; FragExprUR
-&gt; LocTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((FragIndex, FragExprUR) -&gt; (FragIndex, LocTag))
-&gt; [(FragIndex, FragExprUR)] -&gt; [(FragIndex, LocTag)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR -&gt; [(FragIndex, FragExprUR)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679278068"><span class="hs-identifier hs-var">funMap</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679278108"><span class="annot"><span class="annottext">[(FragIndex, LocTag)]
</span><a href="#local-6989586621679278108"><span class="hs-identifier hs-var">orphanLocs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278109"><span class="annot"><span class="annottext">[(FragIndex, LocTag)]
</span><a href="#local-6989586621679278109"><span class="hs-identifier hs-var">lineLocs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FragIndex, LocTag) -&gt; Bool)
-&gt; [(FragIndex, LocTag)]
-&gt; ([(FragIndex, LocTag)], [(FragIndex, LocTag)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag -&gt; LocTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LocTag -&gt; Bool)
-&gt; ((FragIndex, LocTag) -&gt; LocTag) -&gt; (FragIndex, LocTag) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex, LocTag) -&gt; LocTag
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FragIndex, LocTag)]
</span><a href="#local-6989586621679278106"><span class="hs-identifier hs-var">sizeLocs</span></a></span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621679278116"><span class="annot"><span class="annottext">orphans :: String
</span><a href="#local-6989586621679278116"><span class="hs-identifier hs-var hs-var">orphans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;functions with no location: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((FragIndex, LocTag) -&gt; String) -&gt; [(FragIndex, LocTag)] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; ((FragIndex, LocTag) -&gt; String) -&gt; (FragIndex, LocTag) -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex -&gt; String)
-&gt; ((FragIndex, LocTag) -&gt; FragIndex)
-&gt; (FragIndex, LocTag)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex, LocTag) -&gt; FragIndex
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FragIndex, LocTag)]
</span><a href="#local-6989586621679278108"><span class="hs-identifier hs-var">orphanLocs</span></a></span><span>
</span><span id="line-321"></span><span>        </span><span id="local-6989586621679278095"><span class="annot"><span class="annottext">fromEnum' :: LocTag -&gt; Int
</span><a href="#local-6989586621679278095"><span class="hs-identifier hs-var hs-var">fromEnum'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-322"></span><span>          </span><span class="annot"><a href="Telomare.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span id="local-6989586621679278118"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278118"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278118"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-323"></span><span>          </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- error &quot;unexpected DummyLoc&quot;</span><span>
</span><span id="line-324"></span><span>        </span><span id="local-6989586621679278126"><span class="annot"><span class="annottext">getFunMatchingLine :: Int -&gt; String
</span><a href="#local-6989586621679278126"><span class="hs-identifier hs-var hs-var">getFunMatchingLine</span></a></span></span><span> </span><span id="local-6989586621679278127"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278127"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((FragIndex, LocTag) -&gt; Bool)
-&gt; [(FragIndex, LocTag)] -&gt; [(FragIndex, LocTag)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool)
-&gt; ((FragIndex, LocTag) -&gt; Int) -&gt; (FragIndex, LocTag) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; Int
</span><a href="#local-6989586621679278095"><span class="hs-identifier hs-var">fromEnum'</span></a></span><span> </span><span class="annot"><span class="annottext">(LocTag -&gt; Int)
-&gt; ((FragIndex, LocTag) -&gt; LocTag) -&gt; (FragIndex, LocTag) -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex, LocTag) -&gt; LocTag
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FragIndex, LocTag)]
</span><a href="#local-6989586621679278109"><span class="hs-identifier hs-var">lineLocs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-326"></span><span>          </span><span class="hs-comment">-- l -&gt; (&quot;   # &quot; &lt;&gt;) $ foldMap ((\s -&gt; show (fromEnum s) &lt;&gt; &quot;:&quot; &lt;&gt; lookupSize s &lt;&gt; &quot; &quot;) . fst) l</span><span>
</span><span id="line-327"></span><span>          </span><span id="local-6989586621679278128"><span class="annot"><span class="annottext">[(FragIndex, LocTag)]
</span><a href="#local-6989586621679278128"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;   # &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FragIndex, LocTag) -&gt; String) -&gt; [(FragIndex, LocTag)] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; ((FragIndex, LocTag) -&gt; String) -&gt; (FragIndex, LocTag) -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String)
-&gt; ((FragIndex, LocTag) -&gt; Int) -&gt; (FragIndex, LocTag) -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex -&gt; Int)
-&gt; ((FragIndex, LocTag) -&gt; FragIndex) -&gt; (FragIndex, LocTag) -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex, LocTag) -&gt; FragIndex
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FragIndex, LocTag)]
</span><a href="#local-6989586621679278128"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-comment">-- in &quot;showFunInSource\n&quot; &lt;&gt; orphans &lt;&gt; &quot;\nBodyLocs\n&quot; &lt;&gt; show bodyLocs &lt;&gt; &quot;\n&quot; &lt;&gt; foldMap (\(l, s) -&gt; s &lt;&gt; getFunMatchingLine l &lt;&gt; &quot;\n&quot;) asLines</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;showFunInSource\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278116"><span class="hs-identifier hs-var">orphans</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Int, String) -&gt; String) -&gt; [(Int, String)] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679278129"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278129"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278130"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278130"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278130"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679278126"><span class="hs-identifier hs-var">getFunMatchingLine</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278129"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, String)]
</span><a href="#local-6989586621679278057"><span class="hs-identifier hs-var">asLines</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Telomare.Eval.html#parseMain"><span class="hs-identifier hs-type">parseMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^Prelude: [(VariableName, BindedUPT)]</span></span><span>
</span><span id="line-332"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                            </span><span class="annot"><span class="hs-comment">-- ^Raw string to be parserd.</span></span><span>
</span><span id="line-333"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^Error on Left.</span></span><span>
</span><span id="line-334"></span><span id="parseMain"><span class="annot"><span class="annottext">parseMain :: [(String, AnnotatedUPT)] -&gt; String -&gt; Either String Term3
</span><a href="Telomare.Eval.html#parseMain"><span class="hs-identifier hs-var hs-var">parseMain</span></a></span></span><span> </span><span id="local-6989586621679278131"><span class="annot"><span class="annottext">[(String, AnnotatedUPT)]
</span><a href="#local-6989586621679278131"><span class="hs-identifier hs-var">prelude'</span></a></span></span><span> </span><span id="local-6989586621679278132"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278132"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679278133"><span class="hs-identifier hs-type">prelude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>      </span><span id="local-6989586621679278133"><span class="annot"><span class="annottext">prelude :: [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679278133"><span class="hs-identifier hs-var hs-var">prelude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Prelude&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(String, AnnotatedUPT)
-&gt; Either AnnotatedUPT (String, AnnotatedUPT)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">((String, AnnotatedUPT)
 -&gt; Either AnnotatedUPT (String, AnnotatedUPT))
-&gt; [(String, AnnotatedUPT)]
-&gt; [Either AnnotatedUPT (String, AnnotatedUPT)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String, AnnotatedUPT)]
</span><a href="#local-6989586621679278131"><span class="hs-identifier hs-var">prelude'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>      </span><span class="annot"><a href="#local-6989586621679278134"><span class="hs-identifier hs-type">parseAuxModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>      </span><span id="local-6989586621679278134"><span class="annot"><span class="annottext">parseAuxModule :: String -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)])
</span><a href="#local-6989586621679278134"><span class="hs-identifier hs-var hs-var">parseAuxModule</span></a></span></span><span> </span><span id="local-6989586621679278135"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278135"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(String,
 Either String [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; Either
     String (String, [Either AnnotatedUPT (String, AnnotatedUPT)])
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; (String, m a) -&gt; m (String, a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AuxModule&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either String [Either AnnotatedUPT (String, AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parseModule"><span class="hs-identifier hs-var">parseModule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;import Prelude\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278135"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679278136"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278136"><span class="hs-identifier hs-var">e</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)])
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)]))
-&gt; String -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278136"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-341"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679278137"><span class="annot"><span class="annottext">(String, [Either AnnotatedUPT (String, AnnotatedUPT)])
</span><a href="#local-6989586621679278137"><span class="hs-identifier hs-var">pam</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(String, [Either AnnotatedUPT (String, AnnotatedUPT)])
</span><a href="#local-6989586621679278137"><span class="hs-identifier hs-var">pam</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; String -&gt; Either String Term3
</span><a href="Telomare.Resolver.html#main2Term3"><span class="hs-identifier hs-var">main2Term3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)])
</span><a href="#local-6989586621679278134"><span class="hs-identifier hs-var">parseAuxModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278132"><span class="hs-identifier hs-var">str</span></a></span><span class="annot"><span class="annottext">(String, [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679278133"><span class="hs-identifier hs-var">prelude</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AuxModule&quot;</span></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Telomare.Eval.html#getAbortPossibilities"><span class="hs-identifier hs-type">getAbortPossibilities</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-345"></span><span id="getAbortPossibilities"><span class="annot"><span class="annottext">getAbortPossibilities :: String -&gt; String -&gt; Set IExpr
</span><a href="Telomare.Eval.html#getAbortPossibilities"><span class="hs-identifier hs-var hs-var">getAbortPossibilities</span></a></span></span><span> </span><span id="local-6989586621679278139"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278139"><span class="hs-identifier hs-var">prelude</span></a></span></span><span> </span><span id="local-6989586621679278140"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278140"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679278142"><span class="annot"><span class="annottext">parsed :: Either String Term3
</span><a href="#local-6989586621679278142"><span class="hs-identifier hs-var hs-var">parsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [(String, AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier hs-var">parsePrelude</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278139"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">Either String [(String, AnnotatedUPT)]
-&gt; ([(String, AnnotatedUPT)] -&gt; Either String Term3)
-&gt; Either String Term3
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, AnnotatedUPT)] -&gt; String -&gt; Either String Term3
</span><a href="Telomare.Eval.html#parseMain"><span class="hs-operator hs-var">`parseMain`</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278140"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679278144"><span class="annot"><span class="annottext">unsizedExpr :: Either String UnsizedExpr
</span><a href="#local-6989586621679278144"><span class="hs-identifier hs-var hs-var">unsizedExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term3 -&gt; UnsizedExpr
</span><a href="Telomare.Possible.html#term3ToUnsizedExpr"><span class="hs-identifier hs-var">term3ToUnsizedExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">(Term3 -&gt; UnsizedExpr)
-&gt; Either String Term3 -&gt; Either String UnsizedExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String Term3
</span><a href="#local-6989586621679278142"><span class="hs-identifier hs-var">parsed</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String UnsizedExpr
</span><a href="#local-6989586621679278144"><span class="hs-identifier hs-var">unsizedExpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679278145"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278145"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Set IExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Set IExpr) -&gt; String -&gt; Set IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getAbortPossibilities: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278145"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-350"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679278146"><span class="annot"><span class="annottext">UnsizedExpr
</span><a href="#local-6989586621679278146"><span class="hs-identifier hs-var">ue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnsizedExpr -&gt; Set IExpr
</span><a href="Telomare.Possible.html#abortPossibilities"><span class="hs-identifier hs-var">abortPossibilities</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">UnsizedExpr
</span><a href="#local-6989586621679278146"><span class="hs-identifier hs-var">ue</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><a href="Telomare.Eval.html#getAbortPossibilities%27"><span class="hs-identifier hs-type">getAbortPossibilities'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-353"></span><span id="getAbortPossibilities%27"><span class="annot"><span class="annottext">getAbortPossibilities' :: String -&gt; String -&gt; Set String
</span><a href="Telomare.Eval.html#getAbortPossibilities%27"><span class="hs-identifier hs-var hs-var">getAbortPossibilities'</span></a></span></span><span> </span><span id="local-6989586621679278148"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278148"><span class="hs-identifier hs-var">prelude</span></a></span></span><span> </span><span id="local-6989586621679278149"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278149"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679278151"><span class="annot"><span class="annottext">parsed :: Either String Term3
</span><a href="#local-6989586621679278151"><span class="hs-identifier hs-var hs-var">parsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [(String, AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier hs-var">parsePrelude</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278148"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">Either String [(String, AnnotatedUPT)]
-&gt; ([(String, AnnotatedUPT)] -&gt; Either String Term3)
-&gt; Either String Term3
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, AnnotatedUPT)] -&gt; String -&gt; Either String Term3
</span><a href="Telomare.Eval.html#parseMain"><span class="hs-operator hs-var">`parseMain`</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278149"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span id="local-6989586621679278153"><span class="annot"><span class="annottext">unsizedExpr :: Either String UnsizedExpr
</span><a href="#local-6989586621679278153"><span class="hs-identifier hs-var hs-var">unsizedExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term3 -&gt; UnsizedExpr
</span><a href="Telomare.Possible.html#term3ToUnsizedExpr"><span class="hs-identifier hs-var">term3ToUnsizedExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">(Term3 -&gt; UnsizedExpr)
-&gt; Either String Term3 -&gt; Either String UnsizedExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String Term3
</span><a href="#local-6989586621679278151"><span class="hs-identifier hs-var">parsed</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String UnsizedExpr
</span><a href="#local-6989586621679278153"><span class="hs-identifier hs-var">unsizedExpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-357"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679278154"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278154"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Set String) -&gt; String -&gt; Set String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getAbortPossibilities: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278154"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-358"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679278155"><span class="annot"><span class="annottext">UnsizedExpr
</span><a href="#local-6989586621679278155"><span class="hs-identifier hs-var">ue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; String) -&gt; Set IExpr -&gt; Set String
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
</span><a href="Telomare.html#convertAbortMessage"><span class="hs-identifier hs-var">convertAbortMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(Set IExpr -&gt; Set String) -&gt; Set IExpr -&gt; Set String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnsizedExpr -&gt; Set IExpr
</span><a href="Telomare.Possible.html#abortPossibilities"><span class="hs-identifier hs-var">abortPossibilities</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">UnsizedExpr
</span><a href="#local-6989586621679278155"><span class="hs-identifier hs-var">ue</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Telomare.Eval.html#eval2IExpr"><span class="hs-identifier hs-type">eval2IExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-361"></span><span id="eval2IExpr"><span class="annot"><span class="annottext">eval2IExpr :: [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; String -&gt; Either String IExpr
</span><a href="Telomare.Eval.html#eval2IExpr"><span class="hs-identifier hs-var hs-var">eval2IExpr</span></a></span></span><span> </span><span id="local-6989586621679278158"><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679278158"><span class="hs-identifier hs-var">extraModuleBindings</span></a></span></span><span> </span><span id="local-6989586621679278159"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278159"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="annottext">(ParseErrorBundle String Void -&gt; String)
-&gt; Either (ParseErrorBundle String Void) AnnotatedUPT
-&gt; Either String AnnotatedUPT
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">ParseErrorBundle String Void -&gt; String
forall s e.
(VisualStream s, TraversableStream s, ShowErrorComponent e) =&gt;
ParseErrorBundle s e -&gt; String
</span><a href="file:///nix/store/cpbijcsgm9np1zixx9xcijmcljl31jqz-megaparsec-9.5.0-doc/share/doc/megaparsec-9.5.0/html/src/Text.Megaparsec.Error.html#errorBundlePretty"><span class="hs-identifier hs-var">errorBundlePretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parsec Void String AnnotatedUPT
-&gt; String
-&gt; String
-&gt; Either (ParseErrorBundle String Void) AnnotatedUPT
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><a href="file:///nix/store/cpbijcsgm9np1zixx9xcijmcljl31jqz-megaparsec-9.5.0-doc/share/doc/megaparsec-9.5.0/html/src/Text.Megaparsec.html#runParser"><span class="hs-identifier hs-var">runParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, AnnotatedUPT)] -&gt; Parsec Void String AnnotatedUPT
</span><a href="Telomare.Parser.html#parseOneExprOrTopLevelDefs"><span class="hs-identifier hs-var">parseOneExprOrTopLevelDefs</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, AnnotatedUPT)]
</span><a href="#local-6989586621679278160"><span class="hs-identifier hs-var">resolved</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278159"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="annottext">Either String AnnotatedUPT
-&gt; (AnnotatedUPT -&gt; Either String Term3) -&gt; Either String Term3
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedUPT -&gt; Either String Term3
</span><a href="Telomare.Resolver.html#process"><span class="hs-identifier hs-var">process</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="annottext">Either String Term3
-&gt; (Term3 -&gt; Either String IExpr) -&gt; Either String IExpr
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Either String CompiledExpr -&gt; Either String IExpr
</span><a href="#local-6989586621679278161"><span class="hs-identifier hs-var">tt</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String CompiledExpr -&gt; Either String IExpr)
-&gt; (Term3 -&gt; Either String CompiledExpr)
-&gt; Term3
-&gt; Either String IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; String)
-&gt; Either EvalError CompiledExpr -&gt; Either String CompiledExpr
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Either EvalError CompiledExpr -&gt; Either String CompiledExpr)
-&gt; (Term3 -&gt; Either EvalError CompiledExpr)
-&gt; Term3
-&gt; Either String CompiledExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-var">compileUnitTest</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>      </span><span id="local-6989586621679278161"><span class="annot"><span class="annottext">tt :: Either String CompiledExpr -&gt; Either String IExpr
</span><a href="#local-6989586621679278161"><span class="hs-identifier hs-var hs-var">tt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679278169"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278169"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278169"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-368"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679278170"><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679278170"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; Maybe IExpr
forall a. TelomareLike a =&gt; a -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var">toTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679278170"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-369"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679278171"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278171"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Either String IExpr
forall a. a -&gt; Either String a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278171"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String IExpr) -&gt; String -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eval2IExpr conversion error back to iexpr:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; String
forall p. PrettyPrintable p =&gt; p -&gt; String
</span><a href="PrettyPrint.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679278170"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-371"></span><span>      </span><span id="local-6989586621679278173"><span class="annot"><span class="annottext">aux :: [Either AnnotatedUPT b]
</span><a href="#local-6989586621679278173"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679278174"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278174"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AnnotatedUPT -&gt; Either AnnotatedUPT b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; UnprocessedParsedTermF AnnotatedUPT -&gt; AnnotatedUPT
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTermF AnnotatedUPT
forall r. String -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#ImportUPF"><span class="hs-identifier hs-var">ImportUPF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278174"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either AnnotatedUPT b)
-&gt; ((String, [Either AnnotatedUPT (String, AnnotatedUPT)])
    -&gt; String)
-&gt; (String, [Either AnnotatedUPT (String, AnnotatedUPT)])
-&gt; Either AnnotatedUPT b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String, [Either AnnotatedUPT (String, AnnotatedUPT)]) -&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((String, [Either AnnotatedUPT (String, AnnotatedUPT)])
 -&gt; Either AnnotatedUPT b)
-&gt; [(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [Either AnnotatedUPT b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679278158"><span class="hs-identifier hs-var">extraModuleBindings</span></a></span><span>
</span><span id="line-372"></span><span>      </span><span id="local-6989586621679278160"><span class="annot"><span class="annottext">resolved :: [(String, AnnotatedUPT)]
</span><a href="#local-6989586621679278160"><span class="hs-identifier hs-var hs-var">resolved</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
-&gt; [Either AnnotatedUPT (String, AnnotatedUPT)]
-&gt; [(String, AnnotatedUPT)]
</span><a href="Telomare.Resolver.html#resolveAllImports"><span class="hs-identifier hs-var">resolveAllImports</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Either AnnotatedUPT (String, AnnotatedUPT)])]
</span><a href="#local-6989586621679278158"><span class="hs-identifier hs-var">extraModuleBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Either AnnotatedUPT (String, AnnotatedUPT)]
forall {b}. [Either AnnotatedUPT b]
</span><a href="#local-6989586621679278173"><span class="hs-identifier hs-var">aux</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Telomare.Eval.html#tagIExprWithEval"><span class="hs-identifier hs-type">tagIExprWithEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExprF"><span class="hs-identifier hs-type">IExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span id="tagIExprWithEval"><span class="annot"><span class="annottext">tagIExprWithEval :: IExpr -&gt; Cofree IExprF (Int, IExpr)
</span><a href="Telomare.Eval.html#tagIExprWithEval"><span class="hs-identifier hs-var hs-var">tagIExprWithEval</span></a></span></span><span> </span><span id="local-6989586621679278177"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278177"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
-&gt; Int -&gt; Cofree IExprF (Int, IExpr)
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; IExpr -&gt; State Int (Cofree IExprF (Int, IExpr))
forall t a. Recursive t =&gt; (Base t (t, a) -&gt; a) -&gt; t -&gt; a
forall a. (Base IExpr (IExpr, a) -&gt; a) -&gt; IExpr -&gt; a
</span><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#para"><span class="hs-identifier hs-var">para</span></a></span><span> </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
-&gt; State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278178"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278177"><span class="hs-identifier hs-var">iexpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><a href="#local-6989586621679278179"><span class="hs-identifier hs-type">statePlus1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679278179"><span class="annot"><span class="annottext">statePlus1 :: State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var hs-var">statePlus1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>      </span><span id="local-6989586621679278180"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278180"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; State Int Int
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278180"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><a href="#local-6989586621679278178"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-382"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-383"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExprF"><span class="hs-identifier hs-type">IExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExprF"><span class="hs-identifier hs-type">IExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621679278178"><span class="annot"><span class="annottext">alg :: Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
-&gt; State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278178"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
IExprF (IExpr, State Int (Cofree IExprF (Int, IExpr)))
</span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>      </span><span id="local-6989586621679278184"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278184"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-389"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278184"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExprF (Cofree IExprF (Int, IExpr))
forall r. IExprF r
</span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
IExprF (IExpr, State Int (Cofree IExprF (Int, IExpr)))
</span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-391"></span><span>      </span><span id="local-6989586621679278186"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278186"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278186"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExprF (Cofree IExprF (Int, IExpr))
forall r. IExprF r
</span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
IExprF (IExpr, State Int (Cofree IExprF (Int, IExpr)))
</span><a href="Telomare.html#TraceF"><span class="hs-identifier hs-var">TraceF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>      </span><span id="local-6989586621679278189"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278189"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278189"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExprF (Cofree IExprF (Int, IExpr))
forall r. IExprF r
</span><a href="Telomare.html#TraceF"><span class="hs-identifier hs-var">TraceF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-type">SetEnvF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278192"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278192"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278193"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278193"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>      </span><span id="local-6989586621679278194"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278194"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span id="local-6989586621679278195"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278195"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278193"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278194"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278192"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278195"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="Telomare.html#DeferF"><span class="hs-identifier hs-type">DeferF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278198"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278198"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278199"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278199"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>      </span><span id="local-6989586621679278200"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278200"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-402"></span><span>      </span><span id="local-6989586621679278201"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278201"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278199"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278200"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278198"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#DeferF"><span class="hs-identifier hs-var">DeferF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278201"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><a href="Telomare.html#PLeftF"><span class="hs-identifier hs-type">PLeftF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278204"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278204"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278205"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278205"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>      </span><span id="local-6989586621679278206"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278206"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-406"></span><span>      </span><span id="local-6989586621679278207"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278207"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278205"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278206"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278204"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#PLeftF"><span class="hs-identifier hs-var">PLeftF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278207"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><a href="Telomare.html#PRightF"><span class="hs-identifier hs-type">PRightF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278210"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278210"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278211"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278211"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>      </span><span id="local-6989586621679278212"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278212"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span id="local-6989586621679278213"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278213"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278211"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278212"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PRight"><span class="hs-identifier hs-var">PRight</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278210"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#PRightF"><span class="hs-identifier hs-var">PRightF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278213"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="Telomare.html#PairF"><span class="hs-identifier hs-type">PairF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278216"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278216"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278217"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278217"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278218"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278218"><span class="hs-identifier hs-var">iexpr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278219"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278219"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span>      </span><span id="local-6989586621679278220"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278220"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-414"></span><span>      </span><span id="local-6989586621679278221"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278221"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278217"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span id="local-6989586621679278222"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278222"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278219"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278220"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278216"><span class="hs-identifier hs-var">iexpr0</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278218"><span class="hs-identifier hs-var">iexpr1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; Cofree IExprF (Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; r -&gt; IExprF r
</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278222"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><a href="Telomare.html#GateF"><span class="hs-identifier hs-type">GateF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278224"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278224"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278225"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278225"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278226"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278226"><span class="hs-identifier hs-var">iexpr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278227"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278227"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-418"></span><span>      </span><span id="local-6989586621679278228"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278228"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679278179"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span id="local-6989586621679278229"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278229"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278225"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-420"></span><span>      </span><span id="local-6989586621679278230"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278230"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679278227"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278228"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278224"><span class="hs-identifier hs-var">iexpr0</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278226"><span class="hs-identifier hs-var">iexpr1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; Cofree IExprF (Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; r -&gt; IExprF r
</span><a href="Telomare.html#GateF"><span class="hs-identifier hs-var">GateF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278229"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679278230"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Telomare.Eval.html#tagUPTwithIExpr"><span class="hs-identifier hs-type">tagUPTwithIExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-425"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span id="tagUPTwithIExpr"><span class="annot"><span class="annottext">tagUPTwithIExpr :: [(String, AnnotatedUPT)]
-&gt; UnprocessedParsedTerm
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="Telomare.Eval.html#tagUPTwithIExpr"><span class="hs-identifier hs-var hs-var">tagUPTwithIExpr</span></a></span></span><span> </span><span id="local-6989586621679278233"><span class="annot"><span class="annottext">[(String, AnnotatedUPT)]
</span><a href="#local-6989586621679278233"><span class="hs-identifier hs-var">prelude</span></a></span></span><span> </span><span id="local-6989586621679278234"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278234"><span class="hs-identifier hs-var">upt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Int -&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Base
   UnprocessedParsedTerm
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; UnprocessedParsedTerm
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall t a. Recursive t =&gt; (Base t (t, a) -&gt; a) -&gt; t -&gt; a
forall a.
(Base UnprocessedParsedTerm (UnprocessedParsedTerm, a) -&gt; a)
-&gt; UnprocessedParsedTerm -&gt; a
</span><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#para"><span class="hs-identifier hs-var">para</span></a></span><span> </span><span class="annot"><span class="annottext">Base
  UnprocessedParsedTerm
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278235"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278234"><span class="hs-identifier hs-var">upt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><a href="#local-6989586621679278236"><span class="hs-identifier hs-type">upt2iexpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621679278236"><span class="annot"><span class="annottext">upt2iexpr :: UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var hs-var">upt2iexpr</span></a></span></span><span> </span><span id="local-6989586621679278237"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278237"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnotatedUPT -&gt; Either String Term3
</span><a href="Telomare.Resolver.html#process"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
-&gt; UnprocessedParsedTerm
-&gt; Cofree (Base UnprocessedParsedTerm) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278237"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either String Term3
-&gt; (Term3 -&gt; Either String IExpr) -&gt; Either String IExpr
forall a b.
Either String a -&gt; (a -&gt; Either String b) -&gt; Either String b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Either String CompiledExpr -&gt; Either String IExpr
</span><a href="#local-6989586621679278238"><span class="hs-identifier hs-var">tt</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String CompiledExpr -&gt; Either String IExpr)
-&gt; (Term3 -&gt; Either String CompiledExpr)
-&gt; Term3
-&gt; Either String IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; String)
-&gt; Either EvalError CompiledExpr -&gt; Either String CompiledExpr
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Either EvalError CompiledExpr -&gt; Either String CompiledExpr)
-&gt; (Term3 -&gt; Either EvalError CompiledExpr)
-&gt; Term3
-&gt; Either String CompiledExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError CompiledExpr
</span><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-var">compileUnitTest</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621679278238"><span class="annot"><span class="annottext">tt :: Either String CompiledExpr -&gt; Either String IExpr
</span><a href="#local-6989586621679278238"><span class="hs-identifier hs-var hs-var">tt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679278244"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278244"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278244"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679278245"><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679278245"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; Maybe IExpr
forall a. TelomareLike a =&gt; a -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var">toTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679278245"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679278246"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278246"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Either String IExpr
forall a. a -&gt; Either String a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679278246"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String IExpr) -&gt; String -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tagUPTwithExpr conversion error back to iexpr:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CompiledExpr -&gt; String
forall p. PrettyPrintable p =&gt; p -&gt; String
</span><a href="PrettyPrint.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledExpr
</span><a href="#local-6989586621679278245"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><a href="#local-6989586621679278235"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/b6pykcsrbr832m3k5rq9ihilf70jps6s-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-435"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-436"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621679278235"><span class="annot"><span class="annottext">alg :: Base
  UnprocessedParsedTerm
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278235"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><a href="Telomare.html#ITEUPF"><span class="hs-identifier hs-type">ITEUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278248"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278248"><span class="hs-identifier hs-var">utp1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278249"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278249"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278250"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278250"><span class="hs-identifier hs-var">utp2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278251"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278251"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278252"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278252"><span class="hs-identifier hs-var">utp3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278253"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278253"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>      </span><span id="local-6989586621679278254"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278254"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-442"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>      </span><span id="local-6989586621679278255"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278255"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278249"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-444"></span><span>      </span><span id="local-6989586621679278256"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278256"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278251"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-445"></span><span>      </span><span id="local-6989586621679278257"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278257"><span class="hs-identifier hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278253"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-446"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278254"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278248"><span class="hs-identifier hs-var">utp1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278250"><span class="hs-identifier hs-var">utp2</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278252"><span class="hs-identifier hs-var">utp3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#ITEUPF"><span class="hs-identifier hs-var">ITEUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278255"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278256"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278257"><span class="hs-identifier hs-var">z'</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="Telomare.html#ListUPF"><span class="hs-identifier hs-type">ListUPF</span></a></span><span> </span><span id="local-6989586621679278260"><span class="annot"><span class="annottext">[(UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
</span><a href="#local-6989586621679278260"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>      </span><span id="local-6989586621679278261"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278261"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-449"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679278262"><span class="hs-identifier hs-type">scupt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-451"></span><span>          </span><span id="local-6989586621679278262"><span class="annot"><span class="annottext">scupt :: State
  Int [Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278262"><span class="hs-identifier hs-var hs-var">scupt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
-&gt; State
     Int [Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
</span><a href="#local-6989586621679278260"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-452"></span><span>      </span><span id="local-6989586621679278264"><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278264"><span class="hs-identifier hs-var">cupt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int [Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278262"><span class="hs-identifier hs-var">scupt</span></a></span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278261"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; ([UnprocessedParsedTerm] -&gt; UnprocessedParsedTerm)
-&gt; [UnprocessedParsedTerm]
-&gt; Either String IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[UnprocessedParsedTerm] -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#ListUP"><span class="hs-identifier hs-var">ListUP</span></a></span><span> </span><span class="annot"><span class="annottext">([UnprocessedParsedTerm] -&gt; Either String IExpr)
-&gt; [UnprocessedParsedTerm] -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; UnprocessedParsedTerm
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; UnprocessedParsedTerm)
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
-&gt; [UnprocessedParsedTerm]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
</span><a href="#local-6989586621679278260"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. [r] -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#ListUPF"><span class="hs-identifier hs-var">ListUPF</span></a></span><span> </span><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278264"><span class="hs-identifier hs-var">cupt</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="Telomare.html#LetUPF"><span class="hs-identifier hs-type">LetUPF</span></a></span><span> </span><span id="local-6989586621679278267"><span class="annot"><span class="annottext">[(String,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
</span><a href="#local-6989586621679278267"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278268"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278268"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278269"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278269"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621679278270"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278270"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-456"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679278271"><span class="hs-identifier hs-type">lupt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span>          </span><span id="local-6989586621679278271"><span class="annot"><span class="annottext">lupt :: [(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679278271"><span class="hs-identifier hs-var hs-var">lupt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
 -&gt; (String, UnprocessedParsedTerm))
-&gt; [(String,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [(String, UnprocessedParsedTerm)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((String,
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
  -&gt; (String, UnprocessedParsedTerm))
 -&gt; [(String,
      (UnprocessedParsedTerm,
       State
         Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
 -&gt; [(String, UnprocessedParsedTerm)])
-&gt; (((UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
     -&gt; UnprocessedParsedTerm)
    -&gt; (String,
        (UnprocessedParsedTerm,
         State
           Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
    -&gt; (String, UnprocessedParsedTerm))
-&gt; ((UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
    -&gt; UnprocessedParsedTerm)
-&gt; [(String,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [(String, UnprocessedParsedTerm)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; UnprocessedParsedTerm)
-&gt; (String,
    (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; (String, UnprocessedParsedTerm)
forall a b. (a -&gt; b) -&gt; (String, a) -&gt; (String, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; UnprocessedParsedTerm
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(String,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
</span><a href="#local-6989586621679278267"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-459"></span><span>          </span><span class="annot"><a href="#local-6989586621679278272"><span class="hs-identifier hs-type">slcupt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-460"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-461"></span><span>          </span><span id="local-6989586621679278272"><span class="annot"><span class="annottext">slcupt :: State
  Int [Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278272"><span class="hs-identifier hs-var hs-var">slcupt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
-&gt; State
     Int [Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String,
 (UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
 -&gt; (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; [(String,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
</span><a href="#local-6989586621679278267"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>          </span><span class="annot"><a href="#local-6989586621679278273"><span class="hs-identifier hs-type">vnames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span>          </span><span id="local-6989586621679278273"><span class="annot"><span class="annottext">vnames :: [String]
</span><a href="#local-6989586621679278273"><span class="hs-identifier hs-var hs-var">vnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String,
 (UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((String,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
 -&gt; String)
-&gt; [(String,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(String,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
</span><a href="#local-6989586621679278267"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-464"></span><span>      </span><span id="local-6989586621679278274"><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278274"><span class="hs-identifier hs-var">lcupt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int [Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278272"><span class="hs-identifier hs-var">slcupt</span></a></span><span>
</span><span id="line-465"></span><span>      </span><span id="local-6989586621679278275"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278275"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278269"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-466"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278270"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679278271"><span class="hs-identifier hs-var">lupt</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278268"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(String,
  Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. [(String, r)] -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LetUPF"><span class="hs-identifier hs-var">LetUPF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679278273"><span class="hs-identifier hs-var">vnames</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
-&gt; [Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
-&gt; [(String,
     Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either String IExpr)]
</span><a href="#local-6989586621679278274"><span class="hs-identifier hs-var">lcupt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278275"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="annot"><a href="Telomare.html#CaseUPF"><span class="hs-identifier hs-type">CaseUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278278"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278278"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278279"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278279"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679278280"><span class="annot"><span class="annottext">[(Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
</span><a href="#local-6989586621679278280"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>      </span><span id="local-6989586621679278281"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278281"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>      </span><span id="local-6989586621679278282"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278282"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278279"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679278283"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-472"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-473"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-475"></span><span>          </span><span id="local-6989586621679278283"><span class="annot"><span class="annottext">aux :: [(Pattern, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679278283"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
 -&gt; (Pattern, UnprocessedParsedTerm))
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [(Pattern, UnprocessedParsedTerm)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Pattern,
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
  -&gt; (Pattern, UnprocessedParsedTerm))
 -&gt; [(Pattern,
      (UnprocessedParsedTerm,
       State
         Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
 -&gt; [(Pattern, UnprocessedParsedTerm)])
-&gt; (((UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
     -&gt; UnprocessedParsedTerm)
    -&gt; (Pattern,
        (UnprocessedParsedTerm,
         State
           Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
    -&gt; (Pattern, UnprocessedParsedTerm))
-&gt; ((UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
    -&gt; UnprocessedParsedTerm)
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [(Pattern, UnprocessedParsedTerm)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; UnprocessedParsedTerm)
-&gt; (Pattern,
    (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; (Pattern, UnprocessedParsedTerm)
forall a b. (a -&gt; b) -&gt; (Pattern, a) -&gt; (Pattern, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; UnprocessedParsedTerm
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
</span><a href="#local-6989586621679278280"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-476"></span><span>          </span><span id="local-6989586621679278286"><span class="annot"><span class="annottext">aux0 :: [(Pattern,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
</span><a href="#local-6989586621679278286"><span class="hs-identifier hs-var hs-var">aux0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
 -&gt; (Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [(Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Pattern,
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
  -&gt; (Pattern,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
 -&gt; [(Pattern,
      (UnprocessedParsedTerm,
       State
         Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
 -&gt; [(Pattern,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))])
-&gt; (((UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
     -&gt; State
          Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
    -&gt; (Pattern,
        (UnprocessedParsedTerm,
         State
           Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
    -&gt; (Pattern,
        State
          Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; ((UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
    -&gt; State
         Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
-&gt; [(Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; (Pattern,
    (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))
-&gt; (Pattern,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
forall a b. (a -&gt; b) -&gt; (Pattern, a) -&gt; (Pattern, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))))]
</span><a href="#local-6989586621679278280"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-477"></span><span>          </span><span class="annot"><a href="#local-6989586621679278287"><span class="hs-identifier hs-type">aux1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-478"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-479"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-482"></span><span>          </span><span id="local-6989586621679278287"><span class="annot"><span class="annottext">aux1 :: State
  Int
  [(Pattern,
    Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
</span><a href="#local-6989586621679278287"><span class="hs-identifier hs-var hs-var">aux1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Pattern,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
 -&gt; StateT
      Int
      Identity
      (Pattern,
       Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; [(Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
-&gt; State
     Int
     [(Pattern,
       Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(Pattern,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; StateT
     Int
     Identity
     (Pattern, Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; (Pattern, m a) -&gt; m (Pattern, a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))]
</span><a href="#local-6989586621679278286"><span class="hs-identifier hs-var">aux0</span></a></span><span>
</span><span id="line-483"></span><span>      </span><span id="local-6989586621679278288"><span class="annot"><span class="annottext">[(Pattern,
  Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
</span><a href="#local-6989586621679278288"><span class="hs-identifier hs-var">aux1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int
  [(Pattern,
    Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
</span><a href="#local-6989586621679278287"><span class="hs-identifier hs-var">aux1</span></a></span><span>
</span><span id="line-484"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278281"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; [(Pattern, UnprocessedParsedTerm)] -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#CaseUP"><span class="hs-identifier hs-var">CaseUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278278"><span class="hs-identifier hs-var">upt0</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pattern, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679278283"><span class="hs-identifier hs-var">aux</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; [(Pattern,
     Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; [(Pattern, r)] -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#CaseUPF"><span class="hs-identifier hs-var">CaseUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278282"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  Cofree UnprocessedParsedTermF (Int, Either String IExpr))]
</span><a href="#local-6989586621679278288"><span class="hs-identifier hs-var">aux1'</span></a></span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><a href="Telomare.html#LamUPF"><span class="hs-identifier hs-type">LamUPF</span></a></span><span> </span><span id="local-6989586621679278291"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278291"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278292"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278292"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278293"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278293"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>      </span><span id="local-6989586621679278294"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278294"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-487"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>      </span><span id="local-6989586621679278295"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278295"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278293"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278294"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278291"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278292"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. String -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LamUPF"><span class="hs-identifier hs-var">LamUPF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278291"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278295"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><a href="Telomare.html#AppUPF"><span class="hs-identifier hs-type">AppUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278298"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278298"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278299"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278299"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278300"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278300"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278301"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278301"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-491"></span><span>      </span><span id="local-6989586621679278302"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278302"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-492"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>      </span><span id="local-6989586621679278303"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278303"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278299"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-494"></span><span>      </span><span id="local-6989586621679278304"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278304"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278301"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-495"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278302"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278298"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278300"><span class="hs-identifier hs-var">upt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#AppUPF"><span class="hs-identifier hs-var">AppUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278303"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278304"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><a href="Telomare.html#UnsizedRecursionUPF"><span class="hs-identifier hs-type">UnsizedRecursionUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278307"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278307"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278308"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278308"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278309"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278309"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278310"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278310"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278311"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278311"><span class="hs-identifier hs-var">upt3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278312"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278312"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-497"></span><span>      </span><span id="local-6989586621679278313"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278313"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>      </span><span id="local-6989586621679278314"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278314"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278308"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-500"></span><span>      </span><span id="local-6989586621679278315"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278315"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278310"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-501"></span><span>      </span><span id="local-6989586621679278316"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278316"><span class="hs-identifier hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278312"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-502"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278313"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-503"></span><span>                   </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278307"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278309"><span class="hs-identifier hs-var">upt2</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278311"><span class="hs-identifier hs-var">upt3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span>
</span><span id="line-504"></span><span>                     </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#UnsizedRecursionUPF"><span class="hs-identifier hs-var">UnsizedRecursionUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278314"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278315"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278316"><span class="hs-identifier hs-var">z'</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><a href="Telomare.html#CheckUPF"><span class="hs-identifier hs-type">CheckUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278319"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278319"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278320"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278320"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278321"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278321"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278322"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278322"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-506"></span><span>      </span><span id="local-6989586621679278323"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278323"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-507"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>      </span><span id="local-6989586621679278324"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278324"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278320"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-509"></span><span>      </span><span id="local-6989586621679278325"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278325"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278322"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278323"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#CheckUP"><span class="hs-identifier hs-var">CheckUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278319"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278321"><span class="hs-identifier hs-var">upt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#CheckUPF"><span class="hs-identifier hs-var">CheckUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278324"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278325"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><a href="Telomare.html#LeftUPF"><span class="hs-identifier hs-type">LeftUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278328"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278328"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278329"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278329"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>      </span><span id="local-6989586621679278330"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278330"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-513"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>      </span><span id="local-6989586621679278331"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278331"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278329"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-515"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278330"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278328"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LeftUPF"><span class="hs-identifier hs-var">LeftUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278331"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><a href="Telomare.html#RightUPF"><span class="hs-identifier hs-type">RightUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278334"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278334"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278335"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278335"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-517"></span><span>      </span><span id="local-6989586621679278336"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278336"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-518"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>      </span><span id="local-6989586621679278337"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278337"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278335"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-520"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278336"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278334"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#RightUPF"><span class="hs-identifier hs-var">RightUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278337"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><a href="Telomare.html#TraceUPF"><span class="hs-identifier hs-type">TraceUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278340"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278340"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278341"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278341"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-522"></span><span>      </span><span id="local-6989586621679278342"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278342"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>      </span><span id="local-6989586621679278343"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278341"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-525"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278342"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278340"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#TraceUPF"><span class="hs-identifier hs-var">TraceUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><a href="Telomare.html#HashUPF"><span class="hs-identifier hs-type">HashUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278346"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278346"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278347"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278347"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-527"></span><span>      </span><span id="local-6989586621679278348"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278348"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-528"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>      </span><span id="local-6989586621679278349"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278349"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278347"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-530"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278348"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278346"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LeftUPF"><span class="hs-identifier hs-var">LeftUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278349"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><a href="Telomare.html#IntUPF"><span class="hs-identifier hs-type">IntUPF</span></a></span><span> </span><span id="local-6989586621679278351"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278351"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>      </span><span id="local-6989586621679278352"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278352"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-533"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278352"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278351"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. Int -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#IntUPF"><span class="hs-identifier hs-var">IntUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278351"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="Telomare.html#VarUPF"><span class="hs-identifier hs-type">VarUPF</span></a></span><span> </span><span id="local-6989586621679278355"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278355"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>      </span><span id="local-6989586621679278356"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278356"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-537"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278356"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278355"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. String -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#VarUPF"><span class="hs-identifier hs-var">VarUPF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679278355"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><a href="Telomare.html#PairUPF"><span class="hs-identifier hs-type">PairUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278359"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278359"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278360"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278360"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679278361"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278361"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679278362"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278362"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-540"></span><span>      </span><span id="local-6989586621679278363"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278363"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>      </span><span id="local-6989586621679278364"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278364"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278360"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-543"></span><span>      </span><span id="local-6989586621679278365"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278365"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
</span><a href="#local-6989586621679278362"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-544"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either String IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679278363"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either String IExpr
</span><a href="#local-6989586621679278236"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either String IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either String IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278359"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679278361"><span class="hs-identifier hs-var">upt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/346acsy6wlqgb0ms4a7x3nrnqvdmiykb-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either String IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either String IExpr))
forall r. r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#PairUPF"><span class="hs-identifier hs-var">PairUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278364"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either String IExpr)
</span><a href="#local-6989586621679278365"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span></pre></body></html>