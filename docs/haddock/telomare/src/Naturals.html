<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_EQtSg62UMeSDHut7CYcwAO"><span id="%24con2tag_9zLbaBaN3OBEoMr7zisM1o"><span id="%24con2tag_4yjfPuJR9Q6C99TtgyB9MX"></span></span></span><span class="hs-pragma">{-#LANGUAGE DeriveGeneric#-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-#LANGUAGE DeriveAnyClass#-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-#LANGUAGE GeneralizedNewtypeDeriving#-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-#LANGUAGE PatternSynonyms#-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- {-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- {-# LANGUAGE EmptyDataDecls #-}</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Naturals</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fix</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Identity</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Lazy</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="annot"><a href="Naturals.html#debug"><span class="hs-identifier hs-type">debug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-30"></span><span id="debug"><span class="annot"><span class="annottext">debug :: Bool
</span><a href="Naturals.html#debug"><span class="hs-identifier hs-var hs-var">debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span id="local-6989586621679436433"><span class="annot"><a href="Naturals.html#debugTrace"><span class="hs-identifier hs-type">debugTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679436433"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679436433"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-33"></span><span id="debugTrace"><span class="annot"><span class="annottext">debugTrace :: String -&gt; a -&gt; a
</span><a href="Naturals.html#debugTrace"><span class="hs-identifier hs-var hs-var">debugTrace</span></a></span></span><span> </span><span id="local-6989586621679436431"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679436431"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679436430"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679436430"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Naturals.html#debug"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; a
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679436431"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679436430"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679436430"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="NaturalType"><span class="annot"><a href="Naturals.html#NaturalType"><span class="hs-identifier hs-var">NaturalType</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ZeroTypeN"><span class="annot"><a href="Naturals.html#ZeroTypeN"><span class="hs-identifier hs-var">ZeroTypeN</span></a></span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PairTypeN"><span class="annot"><a href="Naturals.html#PairTypeN"><span class="hs-identifier hs-var">PairTypeN</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NaturalType"><span class="hs-identifier hs-type">NaturalType</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NaturalType"><span class="hs-identifier hs-type">NaturalType</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ArrTypeN"><span class="annot"><a href="Naturals.html#ArrTypeN"><span class="hs-identifier hs-var">ArrTypeN</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ChurchType"><span class="annot"><a href="Naturals.html#ChurchType"><span class="hs-identifier hs-var">ChurchType</span></a></span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnknownN"><span class="annot"><a href="Naturals.html#UnknownN"><span class="hs-identifier hs-var">UnknownN</span></a></span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679436421"><span id="local-6989586621679436423"><span class="annot"><span class="annottext">NaturalType -&gt; NaturalType -&gt; Bool
(NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool) -&gt; Eq NaturalType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NaturalType -&gt; NaturalType -&gt; Bool
$c/= :: NaturalType -&gt; NaturalType -&gt; Bool
== :: NaturalType -&gt; NaturalType -&gt; Bool
$c== :: NaturalType -&gt; NaturalType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436405"><span id="local-6989586621679436407"><span id="local-6989586621679436409"><span id="local-6989586621679436411"><span id="local-6989586621679436413"><span id="local-6989586621679436415"><span id="local-6989586621679436417"><span class="annot"><span class="annottext">Eq NaturalType
Eq NaturalType =&gt;
(NaturalType -&gt; NaturalType -&gt; Ordering)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; NaturalType)
-&gt; (NaturalType -&gt; NaturalType -&gt; NaturalType)
-&gt; Ord NaturalType
NaturalType -&gt; NaturalType -&gt; Bool
NaturalType -&gt; NaturalType -&gt; Ordering
NaturalType -&gt; NaturalType -&gt; NaturalType
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: NaturalType -&gt; NaturalType -&gt; NaturalType
$cmin :: NaturalType -&gt; NaturalType -&gt; NaturalType
max :: NaturalType -&gt; NaturalType -&gt; NaturalType
$cmax :: NaturalType -&gt; NaturalType -&gt; NaturalType
&gt;= :: NaturalType -&gt; NaturalType -&gt; Bool
$c&gt;= :: NaturalType -&gt; NaturalType -&gt; Bool
&gt; :: NaturalType -&gt; NaturalType -&gt; Bool
$c&gt; :: NaturalType -&gt; NaturalType -&gt; Bool
&lt;= :: NaturalType -&gt; NaturalType -&gt; Bool
$c&lt;= :: NaturalType -&gt; NaturalType -&gt; Bool
&lt; :: NaturalType -&gt; NaturalType -&gt; Bool
$c&lt; :: NaturalType -&gt; NaturalType -&gt; Bool
compare :: NaturalType -&gt; NaturalType -&gt; Ordering
$ccompare :: NaturalType -&gt; NaturalType -&gt; Ordering
$cp1Ord :: Eq NaturalType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436398"><span id="local-6989586621679436400"><span id="local-6989586621679436402"><span class="annot"><span class="annottext">Int -&gt; NaturalType -&gt; ShowS
[NaturalType] -&gt; ShowS
NaturalType -&gt; String
(Int -&gt; NaturalType -&gt; ShowS)
-&gt; (NaturalType -&gt; String)
-&gt; ([NaturalType] -&gt; ShowS)
-&gt; Show NaturalType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NaturalType] -&gt; ShowS
$cshowList :: [NaturalType] -&gt; ShowS
show :: NaturalType -&gt; String
$cshow :: NaturalType -&gt; String
showsPrec :: Int -&gt; NaturalType -&gt; ShowS
$cshowsPrec :: Int -&gt; NaturalType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">--newtype FragIndex = FragIndex { unFragIndex :: Int } deriving (Eq, Show, Ord, Enum, NFData, Generic)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">newtype</span><span> </span><span id="TypeIndex"><span class="annot"><a href="Naturals.html#TypeIndex"><span class="hs-identifier hs-var">TypeIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TypeIndex"><span class="annot"><a href="Naturals.html#TypeIndex"><span class="hs-identifier hs-var">TypeIndex</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unTypeIndex"><span class="annot"><span class="annottext">TypeIndex -&gt; Int
</span><a href="Naturals.html#unTypeIndex"><span class="hs-identifier hs-var hs-var">unTypeIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679436391"><span id="local-6989586621679436393"><span class="annot"><span class="annottext">TypeIndex -&gt; TypeIndex -&gt; Bool
(TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool) -&gt; Eq TypeIndex
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c/= :: TypeIndex -&gt; TypeIndex -&gt; Bool
== :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c== :: TypeIndex -&gt; TypeIndex -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436385"><span id="local-6989586621679436387"><span id="local-6989586621679436389"><span class="annot"><span class="annottext">Int -&gt; TypeIndex -&gt; ShowS
[TypeIndex] -&gt; ShowS
TypeIndex -&gt; String
(Int -&gt; TypeIndex -&gt; ShowS)
-&gt; (TypeIndex -&gt; String)
-&gt; ([TypeIndex] -&gt; ShowS)
-&gt; Show TypeIndex
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypeIndex] -&gt; ShowS
$cshowList :: [TypeIndex] -&gt; ShowS
show :: TypeIndex -&gt; String
$cshow :: TypeIndex -&gt; String
showsPrec :: Int -&gt; TypeIndex -&gt; ShowS
$cshowsPrec :: Int -&gt; TypeIndex -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436370"><span id="local-6989586621679436372"><span id="local-6989586621679436374"><span id="local-6989586621679436376"><span id="local-6989586621679436378"><span id="local-6989586621679436380"><span id="local-6989586621679436382"><span class="annot"><span class="annottext">Eq TypeIndex
Eq TypeIndex =&gt;
(TypeIndex -&gt; TypeIndex -&gt; Ordering)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; TypeIndex)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; TypeIndex)
-&gt; Ord TypeIndex
TypeIndex -&gt; TypeIndex -&gt; Bool
TypeIndex -&gt; TypeIndex -&gt; Ordering
TypeIndex -&gt; TypeIndex -&gt; TypeIndex
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
$cmin :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
max :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
$cmax :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
&gt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c&gt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
&gt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c&gt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
&lt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c&lt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
&lt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c&lt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
compare :: TypeIndex -&gt; TypeIndex -&gt; Ordering
$ccompare :: TypeIndex -&gt; TypeIndex -&gt; Ordering
$cp1Ord :: Eq TypeIndex
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436354"><span id="local-6989586621679436356"><span id="local-6989586621679436358"><span id="local-6989586621679436360"><span id="local-6989586621679436362"><span id="local-6989586621679436364"><span id="local-6989586621679436366"><span id="local-6989586621679436368"><span class="annot"><span class="annottext">Int -&gt; TypeIndex
TypeIndex -&gt; Int
TypeIndex -&gt; [TypeIndex]
TypeIndex -&gt; TypeIndex
TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
(TypeIndex -&gt; TypeIndex)
-&gt; (TypeIndex -&gt; TypeIndex)
-&gt; (Int -&gt; TypeIndex)
-&gt; (TypeIndex -&gt; Int)
-&gt; (TypeIndex -&gt; [TypeIndex])
-&gt; (TypeIndex -&gt; TypeIndex -&gt; [TypeIndex])
-&gt; (TypeIndex -&gt; TypeIndex -&gt; [TypeIndex])
-&gt; (TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex])
-&gt; Enum TypeIndex
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
$cenumFromThenTo :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
enumFromTo :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
$cenumFromTo :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
enumFromThen :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
$cenumFromThen :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
enumFrom :: TypeIndex -&gt; [TypeIndex]
$cenumFrom :: TypeIndex -&gt; [TypeIndex]
fromEnum :: TypeIndex -&gt; Int
$cfromEnum :: TypeIndex -&gt; Int
toEnum :: Int -&gt; TypeIndex
$ctoEnum :: Int -&gt; TypeIndex
pred :: TypeIndex -&gt; TypeIndex
$cpred :: TypeIndex -&gt; TypeIndex
succ :: TypeIndex -&gt; TypeIndex
$csucc :: TypeIndex -&gt; TypeIndex
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679436347"><span id="local-6989586621679436349"><span id="local-6989586621679436351"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span></span></span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">data</span><span> </span><span id="ExprFrag"><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-var">ExprFrag</span></a></span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FZero"><span class="annot"><a href="Naturals.html#FZero"><span class="hs-identifier hs-var">FZero</span></a></span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FPair"><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-var">FPair</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FEnv"><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FSetEnv"><span class="annot"><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-var">FSetEnv</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FDefer"><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-var">FDefer</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FGate"><span class="annot"><a href="Naturals.html#FGate"><span class="hs-identifier hs-var">FGate</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FLeft"><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-var">FLeft</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FRight"><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-var">FRight</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FTrace"><span class="annot"><a href="Naturals.html#FTrace"><span class="hs-identifier hs-var">FTrace</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">-- complex instructions</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FApp"><span class="annot"><a href="Naturals.html#FApp"><span class="hs-identifier hs-var">FApp</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FNum"><span class="annot"><a href="Naturals.html#FNum"><span class="hs-identifier hs-var">FNum</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FToNum"><span class="annot"><a href="Naturals.html#FToNum"><span class="hs-identifier hs-var">FToNum</span></a></span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679436330"><span id="local-6989586621679436332"><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; Bool
(ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool) -&gt; Eq ExprFrag
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c/= :: ExprFrag -&gt; ExprFrag -&gt; Bool
== :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c== :: ExprFrag -&gt; ExprFrag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436324"><span id="local-6989586621679436326"><span id="local-6989586621679436328"><span class="annot"><span class="annottext">Int -&gt; ExprFrag -&gt; ShowS
[ExprFrag] -&gt; ShowS
ExprFrag -&gt; String
(Int -&gt; ExprFrag -&gt; ShowS)
-&gt; (ExprFrag -&gt; String) -&gt; ([ExprFrag] -&gt; ShowS) -&gt; Show ExprFrag
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExprFrag] -&gt; ShowS
$cshowList :: [ExprFrag] -&gt; ShowS
show :: ExprFrag -&gt; String
$cshow :: ExprFrag -&gt; String
showsPrec :: Int -&gt; ExprFrag -&gt; ShowS
$cshowsPrec :: Int -&gt; ExprFrag -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436309"><span id="local-6989586621679436311"><span id="local-6989586621679436313"><span id="local-6989586621679436315"><span id="local-6989586621679436317"><span id="local-6989586621679436319"><span id="local-6989586621679436321"><span class="annot"><span class="annottext">Eq ExprFrag
Eq ExprFrag =&gt;
(ExprFrag -&gt; ExprFrag -&gt; Ordering)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; Ord ExprFrag
ExprFrag -&gt; ExprFrag -&gt; Bool
ExprFrag -&gt; ExprFrag -&gt; Ordering
ExprFrag -&gt; ExprFrag -&gt; ExprFrag
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
$cmin :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
max :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
$cmax :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
&gt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c&gt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
&gt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c&gt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
&lt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c&lt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
&lt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c&lt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
compare :: ExprFrag -&gt; ExprFrag -&gt; Ordering
$ccompare :: ExprFrag -&gt; ExprFrag -&gt; Ordering
$cp1Ord :: Eq ExprFrag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span id="traceSet"><span class="annot"><span class="annottext">traceSet :: t FragIndex -&gt; (p -&gt; a) -&gt; p -&gt; p
</span><a href="Naturals.html#traceSet"><span class="hs-identifier hs-var hs-var">traceSet</span></a></span></span><span> </span><span id="local-6989586621679436307"><span class="annot"><span class="annottext">inds :: t FragIndex
</span><a href="#local-6989586621679436307"><span class="hs-identifier hs-var">inds</span></a></span></span><span> </span><span id="local-6989586621679436306"><span class="annot"><span class="annottext">ft :: p -&gt; a
</span><a href="#local-6989586621679436306"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span id="local-6989586621679436305"><span class="annot"><span class="annottext">x :: p
</span><a href="#local-6989586621679436305"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; t FragIndex -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t FragIndex
</span><a href="#local-6989586621679436307"><span class="hs-identifier hs-var">inds</span></a></span><span>
</span><span id="line-65"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; p -&gt; p
forall a. String -&gt; a -&gt; a
</span><a href="Naturals.html#debugTrace"><span class="hs-identifier hs-var">debugTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;env at apply index: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; a
</span><a href="#local-6989586621679436306"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679436305"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679436305"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-66"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679436305"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- traceSet _ x = x</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span id="local-6989586621679436300"><span id="local-6989586621679436301"></span></span><span class="hs-keyword">data</span><span> </span><span id="NExpr"><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-var">NExpr</span></a></span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NZero"><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NPair"><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NEnv"><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NSetEnv"><span class="annot"><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-var">NSetEnv</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NDefer"><span class="annot"><a href="Naturals.html#NDefer"><span class="hs-identifier hs-var">NDefer</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NGate"><span class="annot"><a href="Naturals.html#NGate"><span class="hs-identifier hs-var">NGate</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NLeft"><span class="annot"><a href="Naturals.html#NLeft"><span class="hs-identifier hs-var">NLeft</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NRight"><span class="annot"><a href="Naturals.html#NRight"><span class="hs-identifier hs-var">NRight</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NTrace"><span class="annot"><a href="Naturals.html#NTrace"><span class="hs-identifier hs-var">NTrace</span></a></span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NNum"><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-var">NNum</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NAdd"><span class="annot"><a href="Naturals.html#NAdd"><span class="hs-identifier hs-var">NAdd</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NMult"><span class="annot"><a href="Naturals.html#NMult"><span class="hs-identifier hs-var">NMult</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NPow"><span class="annot"><a href="Naturals.html#NPow"><span class="hs-identifier hs-var">NPow</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-comment">{-
  | NForLoop Int64 NExpr -- for runtime, function and number of times to apply it
-}</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NApp"><span class="annot"><a href="Naturals.html#NApp"><span class="hs-identifier hs-var">NApp</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NOldDefer"><span class="annot"><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-var">NOldDefer</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-comment">-- can probably delete</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NToChurch"><span class="annot"><a href="Naturals.html#NToChurch"><span class="hs-identifier hs-var">NToChurch</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NTwiddle"><span class="annot"><a href="Naturals.html#NTwiddle"><span class="hs-identifier hs-var">NTwiddle</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NToNum"><span class="annot"><a href="Naturals.html#NToNum"><span class="hs-identifier hs-var">NToNum</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679436278"><span id="local-6989586621679436280"><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; Bool
(NExpr -&gt; NExpr -&gt; Bool) -&gt; (NExpr -&gt; NExpr -&gt; Bool) -&gt; Eq NExpr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NExpr -&gt; NExpr -&gt; Bool
$c/= :: NExpr -&gt; NExpr -&gt; Bool
== :: NExpr -&gt; NExpr -&gt; Bool
$c== :: NExpr -&gt; NExpr -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436272"><span id="local-6989586621679436274"><span id="local-6989586621679436276"><span class="annot"><span class="annottext">Int -&gt; NExpr -&gt; ShowS
[NExpr] -&gt; ShowS
NExpr -&gt; String
(Int -&gt; NExpr -&gt; ShowS)
-&gt; (NExpr -&gt; String) -&gt; ([NExpr] -&gt; ShowS) -&gt; Show NExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NExpr] -&gt; ShowS
$cshowList :: [NExpr] -&gt; ShowS
show :: NExpr -&gt; String
$cshow :: NExpr -&gt; String
showsPrec :: Int -&gt; NExpr -&gt; ShowS
$cshowsPrec :: Int -&gt; NExpr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436257"><span id="local-6989586621679436259"><span id="local-6989586621679436261"><span id="local-6989586621679436263"><span id="local-6989586621679436265"><span id="local-6989586621679436267"><span id="local-6989586621679436269"><span class="annot"><span class="annottext">Eq NExpr
Eq NExpr =&gt;
(NExpr -&gt; NExpr -&gt; Ordering)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; NExpr)
-&gt; (NExpr -&gt; NExpr -&gt; NExpr)
-&gt; Ord NExpr
NExpr -&gt; NExpr -&gt; Bool
NExpr -&gt; NExpr -&gt; Ordering
NExpr -&gt; NExpr -&gt; NExpr
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: NExpr -&gt; NExpr -&gt; NExpr
$cmin :: NExpr -&gt; NExpr -&gt; NExpr
max :: NExpr -&gt; NExpr -&gt; NExpr
$cmax :: NExpr -&gt; NExpr -&gt; NExpr
&gt;= :: NExpr -&gt; NExpr -&gt; Bool
$c&gt;= :: NExpr -&gt; NExpr -&gt; Bool
&gt; :: NExpr -&gt; NExpr -&gt; Bool
$c&gt; :: NExpr -&gt; NExpr -&gt; Bool
&lt;= :: NExpr -&gt; NExpr -&gt; Bool
$c&lt;= :: NExpr -&gt; NExpr -&gt; Bool
&lt; :: NExpr -&gt; NExpr -&gt; Bool
$c&lt; :: NExpr -&gt; NExpr -&gt; Bool
compare :: NExpr -&gt; NExpr -&gt; Ordering
$ccompare :: NExpr -&gt; NExpr -&gt; Ordering
$cp1Ord :: Eq NExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. NExpr -&gt; Rep NExpr x)
-&gt; (forall x. Rep NExpr x -&gt; NExpr) -&gt; Generic NExpr
forall x. Rep NExpr x -&gt; NExpr
forall x. NExpr -&gt; Rep NExpr x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep NExpr x -&gt; NExpr
$cfrom :: forall x. NExpr -&gt; Rep NExpr x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436252"><span class="annot"><span class="annottext">NExpr -&gt; ()
(NExpr -&gt; ()) -&gt; NFData NExpr
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: NExpr -&gt; ()
$crnf :: NExpr -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679436245"><span id="local-6989586621679436247"><span id="local-6989586621679436249"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span></span></span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Naturals.html#NLamNum"><span class="hs-identifier hs-type">NLamNum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mNLamNum"><span id="NLamNum"><span class="annot"><span class="annottext">$mNLamNum :: forall r. NExpr -&gt; (Int64 -&gt; NExpr -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="Naturals.html#%24mNLamNum"><span class="hs-identifier hs-var hs-var">NLamNum</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679436242"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679436241"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-type">NNum</span></a></span><span> </span><span id="local-6989586621679436242"><span class="annot"><a href="#local-6989586621679436242"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-type">NEnv</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679436241"><span class="annot"><a href="#local-6989586621679436241"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Naturals.html#NPartialNum"><span class="hs-identifier hs-type">NPartialNum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-99"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mNPartialNum"><span id="NPartialNum"><span class="annot"><span class="annottext">$mNPartialNum :: forall r. NExpr -&gt; (Int64 -&gt; NExpr -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="Naturals.html#%24mNPartialNum"><span class="hs-identifier hs-var hs-var">NPartialNum</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679436238"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679436237"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-type">NNum</span></a></span><span> </span><span id="local-6989586621679436238"><span class="annot"><a href="#local-6989586621679436238"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679436237"><span class="annot"><a href="#local-6989586621679436237"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Naturals.html#nlam"><span class="hs-identifier hs-type">nlam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-102"></span><span id="nlam"><span class="annot"><span class="annottext">nlam :: NExpr -&gt; NExpr
</span><a href="Naturals.html#nlam"><span class="hs-identifier hs-var hs-var">nlam</span></a></span></span><span> </span><span id="local-6989586621679436235"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436235"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-var">NOldDefer</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436235"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-keyword">type</span><span> </span><span id="NResult"><span class="annot"><a href="Naturals.html#NResult"><span class="hs-identifier hs-var">NResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">newtype</span><span> </span><span id="NExprs"><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-var">NExprs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NExprs"><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-var">NExprs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NResult"><span class="hs-identifier hs-type">NResult</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679436229"><span id="local-6989586621679436231"><span class="annot"><span class="annottext">NExprs -&gt; NExprs -&gt; Bool
(NExprs -&gt; NExprs -&gt; Bool)
-&gt; (NExprs -&gt; NExprs -&gt; Bool) -&gt; Eq NExprs
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NExprs -&gt; NExprs -&gt; Bool
$c/= :: NExprs -&gt; NExprs -&gt; Bool
== :: NExprs -&gt; NExprs -&gt; Bool
$c== :: NExprs -&gt; NExprs -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679436224"><span id="local-6989586621679436227"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679436223"><span class="annot"><span class="annottext">show :: NExprs -&gt; String
</span><a href="#local-6989586621679436223"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span id="local-6989586621679436222"><span class="annot"><span class="annottext">m :: Map FragIndex NExpr
</span><a href="#local-6989586621679436222"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679436221"><span class="annot"><span class="annottext">showInner :: NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var hs-var">showInner</span></a></span></span><span> </span><span id="local-6989586621679436220"><span class="annot"><span class="annottext">frag :: NExpr
</span><a href="#local-6989586621679436220"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436220"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>          </span><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-type">NZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;NZero&quot;</span></span><span>
</span><span id="line-112"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679436219"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679436219"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679436218"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679436218"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;( &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436219"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436218"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>          </span><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-type">NEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;NEnv&quot;</span></span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-type">NSetEnv</span></a></span><span> </span><span id="local-6989586621679436216"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436216"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;NSetEnv (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436216"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NDefer"><span class="hs-identifier hs-type">NDefer</span></a></span><span> </span><span id="local-6989586621679436215"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679436215"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex NExpr -&gt; Maybe NExpr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436215"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679436222"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-116"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679436213"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436213"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;NDefer (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436213"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;ERROR undefined index in showing NExprs: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436215"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span>          </span><span class="annot"><a href="Naturals.html#NGate"><span class="hs-identifier hs-type">NGate</span></a></span><span> </span><span id="local-6989586621679436212"><span class="annot"><span class="annottext">l :: NExpr
</span><a href="#local-6989586621679436212"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679436211"><span class="annot"><span class="annottext">r :: NExpr
</span><a href="#local-6989586621679436211"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;NGate (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436212"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436211"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; )&quot;</span></span><span>
</span><span id="line-119"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NLeft"><span class="hs-identifier hs-type">NLeft</span></a></span><span> </span><span id="local-6989586621679436210"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436210"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;NLeft (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436210"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NRight"><span class="hs-identifier hs-type">NRight</span></a></span><span> </span><span id="local-6989586621679436209"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436209"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;NRight (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436209"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>          </span><span class="annot"><a href="Naturals.html#NTrace"><span class="hs-identifier hs-type">NTrace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;NTrace&quot;</span></span><span>
</span><span id="line-122"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NAdd"><span class="hs-identifier hs-type">NAdd</span></a></span><span> </span><span id="local-6989586621679436208"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679436208"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679436207"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679436207"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;NAdd (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436208"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436207"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NMult"><span class="hs-identifier hs-type">NMult</span></a></span><span> </span><span id="local-6989586621679436206"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679436206"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679436205"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679436205"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;NMult (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436206"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436205"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPow"><span class="hs-identifier hs-type">NPow</span></a></span><span> </span><span id="local-6989586621679436204"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679436204"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679436203"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679436203"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;NPow (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436204"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436203"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-type">NOldDefer</span></a></span><span> </span><span id="local-6989586621679436202"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436202"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;NOldDefer (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436202"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-126"></span><span>          </span><span id="local-6989586621679436201"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436201"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436201"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr -&gt; Maybe (NExpr, Map FragIndex NExpr)
forall k a. Map k a -&gt; Maybe (a, Map k a)
</span><span class="hs-identifier hs-var">Map.minView</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679436222"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679436199"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679436199"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
</span><a href="#local-6989586621679436221"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679436199"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;ERROR no root to NExprs tree&quot;</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-keyword">type</span><span> </span><span id="FragState"><span class="annot"><a href="Naturals.html#FragState"><span class="hs-identifier hs-var">FragState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-type">toFrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#FragState"><span class="hs-identifier hs-type">FragState</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- complex instructions</span><span>
</span><span id="line-135"></span><span id="toFrag"><span class="annot"><span class="annottext">toFrag :: IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var hs-var">toFrag</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#ToChurch"><span class="hs-identifier hs-type">ToChurch</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FToNum"><span class="hs-identifier hs-var">FToNum</span></a></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#ChurchNum"><span class="hs-identifier hs-type">ChurchNum</span></a></span><span> </span><span id="local-6989586621679436195"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679436195"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; FragState ExprFrag)
-&gt; (Int64 -&gt; ExprFrag) -&gt; Int64 -&gt; FragState ExprFrag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ExprFrag
</span><a href="Naturals.html#FNum"><span class="hs-identifier hs-var">FNum</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; FragState ExprFrag) -&gt; Int64 -&gt; FragState ExprFrag
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679436195"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679436192"><span class="annot"><span class="annottext">f :: IExpr
</span><a href="#local-6989586621679436192"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679436191"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679436191"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FApp"><span class="hs-identifier hs-var">FApp</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag
-&gt; StateT
     (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436192"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436191"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- simple instructions</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FZero"><span class="hs-identifier hs-var">FZero</span></a></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679436187"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679436187"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679436186"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679436186"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FPair"><span class="hs-identifier hs-var">FPair</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag
-&gt; StateT
     (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436187"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436186"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679436183"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679436183"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-var">FSetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag) -&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436183"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679436181"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679436181"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679436180"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436180"><span class="hs-identifier hs-var">nx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436181"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679436179"><span class="annot"><span class="annottext">ei :: FragIndex
</span><a href="#local-6989586621679436179"><span class="hs-identifier hs-var">ei</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span id="local-6989586621679436178"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679436178"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436177"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436177"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag)
  Identity
  (FragIndex, Map FragIndex ExprFrag)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679436175"><span class="annot"><span class="annottext">td :: a -&gt; a
</span><a href="#local-6989586621679436175"><span class="hs-identifier hs-var hs-var">td</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-comment">-- trace (&quot;adding defer &quot; ++ show i ++ &quot; - &quot; ++ show nx)</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="annottext">(FragIndex, Map FragIndex ExprFrag)
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">State.put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679436178"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(FragIndex
 -&gt; ExprFrag -&gt; Map FragIndex ExprFrag -&gt; Map FragIndex ExprFrag)
-&gt; FragIndex
-&gt; ExprFrag
-&gt; Map FragIndex ExprFrag
-&gt; Map FragIndex ExprFrag
forall a. a -&gt; a
</span><a href="#local-6989586621679436175"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; ExprFrag -&gt; Map FragIndex ExprFrag -&gt; Map FragIndex ExprFrag
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436179"><span class="hs-identifier hs-var">ei</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436180"><span class="hs-identifier hs-var">nx</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436177"><span class="hs-identifier hs-var">fragMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; FragState ExprFrag) -&gt; ExprFrag -&gt; FragState ExprFrag
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; ExprFrag
</span><a href="Naturals.html#FDefer"><span class="hs-identifier hs-var">FDefer</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436179"><span class="hs-identifier hs-var">ei</span></a></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679436169"><span class="annot"><span class="annottext">l :: IExpr
</span><a href="#local-6989586621679436169"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679436168"><span class="annot"><span class="annottext">r :: IExpr
</span><a href="#local-6989586621679436168"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FGate"><span class="hs-identifier hs-var">FGate</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag
-&gt; StateT
     (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436169"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436168"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679436166"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679436166"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FLeft"><span class="hs-identifier hs-var">FLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag) -&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436166"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679436164"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679436164"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FRight"><span class="hs-identifier hs-var">FRight</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag) -&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436164"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FTrace"><span class="hs-identifier hs-var">FTrace</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Naturals.html#fromFrag"><span class="hs-identifier hs-type">fromFrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-155"></span><span id="fromFrag"><span class="annot"><span class="annottext">fromFrag :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; IExpr
</span><a href="Naturals.html#fromFrag"><span class="hs-identifier hs-var hs-var">fromFrag</span></a></span></span><span> </span><span id="local-6989586621679436161"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436161"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679436160"><span class="annot"><span class="annottext">frag :: ExprFrag
</span><a href="#local-6989586621679436160"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679436159"><span class="annot"><span class="annottext">recur :: ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag -&gt; ExprFrag -&gt; IExpr
</span><a href="Naturals.html#fromFrag"><span class="hs-identifier hs-var">fromFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436161"><span class="hs-identifier hs-var">fragMap</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436160"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><a href="Naturals.html#FZero"><span class="hs-identifier hs-type">FZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span id="local-6989586621679436158"><span class="annot"><span class="annottext">a :: ExprFrag
</span><a href="#local-6989586621679436158"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679436157"><span class="annot"><span class="annottext">b :: ExprFrag
</span><a href="#local-6989586621679436157"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436158"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436157"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-type">FSetEnv</span></a></span><span> </span><span id="local-6989586621679436156"><span class="annot"><span class="annottext">x :: ExprFrag
</span><a href="#local-6989586621679436156"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436156"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679436155"><span class="annot"><span class="annottext">fi :: FragIndex
</span><a href="#local-6989586621679436155"><span class="hs-identifier hs-var">fi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436155"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436161"><span class="hs-identifier hs-var">fragMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;fromFrag bad index &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436155"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679436153"><span class="annot"><span class="annottext">subFrag :: ExprFrag
</span><a href="#local-6989586621679436153"><span class="hs-identifier hs-var">subFrag</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436153"><span class="hs-identifier hs-var">subFrag</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Naturals.html#FGate"><span class="hs-identifier hs-type">FGate</span></a></span><span> </span><span id="local-6989586621679436152"><span class="annot"><span class="annottext">l :: ExprFrag
</span><a href="#local-6989586621679436152"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679436151"><span class="annot"><span class="annottext">r :: ExprFrag
</span><a href="#local-6989586621679436151"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436152"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436151"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span id="local-6989586621679436150"><span class="annot"><span class="annottext">x :: ExprFrag
</span><a href="#local-6989586621679436150"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436150"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-type">FRight</span></a></span><span> </span><span id="local-6989586621679436149"><span class="annot"><span class="annottext">x :: ExprFrag
</span><a href="#local-6989586621679436149"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PRight"><span class="hs-identifier hs-var">PRight</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679436159"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436149"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="Naturals.html#FTrace"><span class="hs-identifier hs-type">FTrace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679436148"><span class="annot"><span class="annottext">z :: ExprFrag
</span><a href="#local-6989586621679436148"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;fromFrag TODO convert &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436148"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Naturals.html#matchChurchPlus"><span class="hs-identifier hs-type">matchChurchPlus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span id="matchChurchPlus"><span class="annot"><span class="annottext">matchChurchPlus :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchChurchPlus"><span class="hs-identifier hs-var hs-var">matchChurchPlus</span></a></span></span><span> </span><span id="local-6989586621679436146"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436146"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679436145"><span class="annot"><span class="annottext">frag :: ExprFrag
</span><a href="#local-6989586621679436145"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679436144"><span class="annot"><span class="annottext">lam :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679436144"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679436143"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679436143"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436143"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436146"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><a href="#local-6989586621679436144"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-173"></span><span>      </span><span id="local-6989586621679436142"><span class="annot"><span class="annottext">def :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679436142"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679436141"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679436141"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436141"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436146"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><a href="#local-6989586621679436142"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-175"></span><span>      </span><span id="local-6989586621679436140"><span class="annot"><span class="annottext">firstArg :: ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679436140"><span class="hs-identifier hs-var hs-var">firstArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><a href="#local-6989586621679436140"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-177"></span><span>      </span><span id="local-6989586621679436139"><span class="annot"><span class="annottext">secondArg :: ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679436139"><span class="hs-identifier hs-var hs-var">secondArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-type">FRight</span></a></span><span> </span><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><a href="#local-6989586621679436139"><span class="hs-identifier hs-var">secondArg</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-179"></span><span>      </span><span id="local-6989586621679436138"><span class="annot"><span class="annottext">app :: ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679436138"><span class="hs-identifier hs-var hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679436144"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436145"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag -&gt; (ExprFrag -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679436144"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
-&gt; (ExprFrag -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679436138"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679436136"><span class="annot"><span class="annottext">a :: ExprFrag
</span><a href="#local-6989586621679436136"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436135"><span class="annot"><span class="annottext">b :: ExprFrag
</span><a href="#local-6989586621679436135"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; (ExprFrag, ExprFrag))
-&gt; Maybe ExprFrag -&gt; Maybe (ExprFrag -&gt; (ExprFrag, ExprFrag))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679436138"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436136"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679436134"><span class="annot"><span class="annottext">m :: ExprFrag
</span><a href="#local-6989586621679436134"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436133"><span class="annot"><span class="annottext">sa :: ExprFrag
</span><a href="#local-6989586621679436133"><span class="hs-identifier hs-var">sa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679436139"><span class="hs-identifier hs-var">secondArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436133"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe ExprFrag -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436134"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe (ExprFrag -&gt; (ExprFrag, ExprFrag))
-&gt; Maybe ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679436138"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436135"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679436132"><span class="annot"><span class="annottext">c :: ExprFrag
</span><a href="#local-6989586621679436132"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436131"><span class="annot"><span class="annottext">fa :: ExprFrag
</span><a href="#local-6989586621679436131"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679436140"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436131"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ()
-&gt; Maybe (ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679436138"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436132"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-182"></span><span>                                                               </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679436130"><span class="annot"><span class="annottext">n :: ExprFrag
</span><a href="#local-6989586621679436130"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436129"><span class="annot"><span class="annottext">sa :: ExprFrag
</span><a href="#local-6989586621679436129"><span class="hs-identifier hs-var">sa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679436139"><span class="hs-identifier hs-var">secondArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436129"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe ExprFrag -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436130"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                                  </span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Naturals.html#matchChurchMult"><span class="hs-identifier hs-type">matchChurchMult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span id="matchChurchMult"><span class="annot"><span class="annottext">matchChurchMult :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchChurchMult"><span class="hs-identifier hs-var hs-var">matchChurchMult</span></a></span></span><span> </span><span id="local-6989586621679436127"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436127"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679436126"><span class="annot"><span class="annottext">frag :: ExprFrag
</span><a href="#local-6989586621679436126"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679436125"><span class="annot"><span class="annottext">lam :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679436125"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679436124"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679436124"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436124"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436127"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><a href="#local-6989586621679436125"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-189"></span><span>      </span><span id="local-6989586621679436123"><span class="annot"><span class="annottext">def :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679436123"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679436122"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679436122"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436122"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436127"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><a href="#local-6989586621679436123"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-191"></span><span>      </span><span id="local-6989586621679436121"><span class="annot"><span class="annottext">firstArg :: ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679436121"><span class="hs-identifier hs-var hs-var">firstArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><a href="#local-6989586621679436121"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679436125"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436126"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
-&gt; (ExprFrag -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679436120"><span class="annot"><span class="annottext">m :: ExprFrag
</span><a href="#local-6989586621679436120"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436119"><span class="annot"><span class="annottext">a :: ExprFrag
</span><a href="#local-6989586621679436119"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; (ExprFrag, ExprFrag))
-&gt; Maybe ExprFrag -&gt; Maybe (ExprFrag -&gt; (ExprFrag, ExprFrag))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436120"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag -&gt; (ExprFrag, ExprFrag))
-&gt; Maybe ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436119"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679436118"><span class="annot"><span class="annottext">n :: ExprFrag
</span><a href="#local-6989586621679436118"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436117"><span class="annot"><span class="annottext">fa :: ExprFrag
</span><a href="#local-6989586621679436117"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679436121"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436117"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe ExprFrag -&gt; Maybe ExprFrag
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436118"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Naturals.html#matchApp"><span class="hs-identifier hs-type">matchApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span id="matchApp"><span class="annot"><span class="annottext">matchApp :: ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var hs-var">matchApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FApp"><span class="hs-identifier hs-type">FApp</span></a></span><span> </span><span id="local-6989586621679436116"><span class="annot"><span class="annottext">c :: ExprFrag
</span><a href="#local-6989586621679436116"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679436115"><span class="annot"><span class="annottext">i :: ExprFrag
</span><a href="#local-6989586621679436115"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436116"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436115"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span class="annot"><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Naturals.html#fragmentExpr"><span class="hs-identifier hs-type">fragmentExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-200"></span><span id="fragmentExpr"><span class="annot"><span class="annottext">fragmentExpr :: IExpr -&gt; Map FragIndex ExprFrag
</span><a href="Naturals.html#fragmentExpr"><span class="hs-identifier hs-var hs-var">fragmentExpr</span></a></span></span><span> </span><span id="local-6989586621679436113"><span class="annot"><span class="annottext">iexpr :: IExpr
</span><a href="#local-6989586621679436113"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679436112"><span class="annot"><span class="annottext">expr :: ExprFrag
</span><a href="#local-6989586621679436112"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679436111"><span class="annot"><span class="annottext">li :: FragIndex
</span><a href="#local-6989586621679436111"><span class="hs-identifier hs-var">li</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679436110"><span class="annot"><span class="annottext">m :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436110"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragState ExprFrag
-&gt; (FragIndex, Map FragIndex ExprFrag)
-&gt; (ExprFrag, (FragIndex, Map FragIndex ExprFrag))
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">State.runState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679436113"><span class="hs-identifier hs-var">iexpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                         </span><span id="local-6989586621679436107"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436107"><span class="hs-identifier hs-var hs-var">fragMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; ExprFrag -&gt; Map FragIndex ExprFrag -&gt; Map FragIndex ExprFrag
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436112"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436110"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-202"></span><span>                         </span><span class="hs-comment">-- tt x = trace (show x) x</span><span>
</span><span id="line-203"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436107"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-type">fragToNExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-206"></span><span id="fragToNExpr"><span class="annot"><span class="annottext">fragToNExpr :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; NExpr
</span><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-var hs-var">fragToNExpr</span></a></span></span><span> </span><span id="local-6989586621679436105"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436105"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679436104"><span class="annot"><span class="annottext">frag :: ExprFrag
</span><a href="#local-6989586621679436104"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679436103"><span class="annot"><span class="annottext">recur :: ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag -&gt; ExprFrag -&gt; NExpr
</span><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-var">fragToNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436105"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436104"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><a href="Naturals.html#FZero"><span class="hs-identifier hs-type">FZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span><span>
</span><span id="line-210"></span><span>            </span><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span>
</span><span id="line-211"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span id="local-6989586621679436102"><span class="annot"><span class="annottext">a :: ExprFrag
</span><a href="#local-6989586621679436102"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679436101"><span class="annot"><span class="annottext">b :: ExprFrag
</span><a href="#local-6989586621679436101"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436102"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436101"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-type">FSetEnv</span></a></span><span> </span><span id="local-6989586621679436100"><span class="annot"><span class="annottext">x :: ExprFrag
</span><a href="#local-6989586621679436100"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-var">NSetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExpr) -&gt; NExpr -&gt; NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436100"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-213"></span><span>            </span><span class="annot"><a href="Naturals.html#FGate"><span class="hs-identifier hs-type">FGate</span></a></span><span> </span><span id="local-6989586621679436099"><span class="annot"><span class="annottext">l :: ExprFrag
</span><a href="#local-6989586621679436099"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679436098"><span class="annot"><span class="annottext">r :: ExprFrag
</span><a href="#local-6989586621679436098"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NGate"><span class="hs-identifier hs-var">NGate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436099"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436098"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span id="local-6989586621679436097"><span class="annot"><span class="annottext">x :: ExprFrag
</span><a href="#local-6989586621679436097"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NLeft"><span class="hs-identifier hs-var">NLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExpr) -&gt; NExpr -&gt; NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436097"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-215"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-type">FRight</span></a></span><span> </span><span id="local-6989586621679436096"><span class="annot"><span class="annottext">x :: ExprFrag
</span><a href="#local-6989586621679436096"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NRight"><span class="hs-identifier hs-var">NRight</span></a></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExpr) -&gt; NExpr -&gt; NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436096"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-216"></span><span>            </span><span class="annot"><a href="Naturals.html#FTrace"><span class="hs-identifier hs-type">FTrace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NTrace"><span class="hs-identifier hs-var">NTrace</span></a></span><span>
</span><span id="line-217"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679436095"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679436095"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; NExpr
</span><a href="Naturals.html#NDefer"><span class="hs-identifier hs-var">NDefer</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679436095"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FNum"><span class="hs-identifier hs-type">FNum</span></a></span><span> </span><span id="local-6989586621679436094"><span class="annot"><span class="annottext">x :: Int64
</span><a href="#local-6989586621679436094"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-var">NOldDefer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; NExpr
</span><a href="Naturals.html#NNum"><span class="hs-identifier hs-var">NNum</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679436094"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span>
</span><span id="line-219"></span><span>            </span><span class="annot"><a href="Naturals.html#FToNum"><span class="hs-identifier hs-type">FToNum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NToNum"><span class="hs-identifier hs-var">NToNum</span></a></span><span>
</span><span id="line-220"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FApp"><span class="hs-identifier hs-type">FApp</span></a></span><span> </span><span id="local-6989586621679436093"><span class="annot"><span class="annottext">c :: ExprFrag
</span><a href="#local-6989586621679436093"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679436092"><span class="annot"><span class="annottext">i :: ExprFrag
</span><a href="#local-6989586621679436092"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NApp"><span class="hs-identifier hs-var">NApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436093"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679436103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679436092"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Naturals.html#fragsToNExpr"><span class="hs-identifier hs-type">fragsToNExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NResult"><span class="hs-identifier hs-type">NResult</span></a></span><span>
</span><span id="line-223"></span><span id="fragsToNExpr"><span class="annot"><span class="annottext">fragsToNExpr :: Map FragIndex ExprFrag -&gt; Map FragIndex NExpr
</span><a href="Naturals.html#fragsToNExpr"><span class="hs-identifier hs-var hs-var">fragsToNExpr</span></a></span></span><span> </span><span id="local-6989586621679436090"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679436090"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; NExpr)
-&gt; Map FragIndex ExprFrag -&gt; Map FragIndex NExpr
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map FragIndex ExprFrag -&gt; ExprFrag -&gt; NExpr
</span><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-var">fragToNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436090"><span class="hs-identifier hs-var">fragMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679436090"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="debugShow"><span class="annot"><span class="annottext">debugShow :: p -&gt; p
</span><a href="Naturals.html#debugShow"><span class="hs-identifier hs-var hs-var">debugShow</span></a></span></span><span> </span><span id="local-6989586621679436087"><span class="annot"><span class="annottext">x :: p
</span><a href="#local-6989586621679436087"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679436087"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- trace (&quot;toNExpr\n&quot; ++ show x) x</span><span>
</span><span id="line-226"></span></pre></body></html>