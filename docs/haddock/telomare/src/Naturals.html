<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass             #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric              #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms            #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TupleSections              #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Naturals</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fix</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Identity</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Lazy</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExpr"><span class="hs-identifier">FragExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier">IExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Telomare.html#App"><span class="hs-identifier">App</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>                 </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Telomare.html#ChurchNum"><span class="hs-identifier">ChurchNum</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Telomare.html#ToChurch"><span class="hs-identifier">ToChurch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="annot"><a href="Naturals.html#debug"><span class="hs-identifier hs-type">debug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-31"></span><span id="debug"><span class="annot"><span class="annottext">debug :: Bool
</span><a href="Naturals.html#debug"><span class="hs-identifier hs-var hs-var">debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span id="local-6989586621679254082"><span class="annot"><a href="Naturals.html#debugTrace"><span class="hs-identifier hs-type">debugTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679254082"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679254082"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-34"></span><span id="debugTrace"><span class="annot"><span class="annottext">debugTrace :: forall a. [Char] -&gt; a -&gt; a
</span><a href="Naturals.html#debugTrace"><span class="hs-identifier hs-var hs-var">debugTrace</span></a></span></span><span> </span><span id="local-6989586621679254292"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679254292"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679254293"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679254293"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Naturals.html#debug"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a -&gt; a
forall a. [Char] -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679254292"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679254293"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679254293"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">data</span><span> </span><span id="NaturalType"><span class="annot"><a href="Naturals.html#NaturalType"><span class="hs-identifier hs-var">NaturalType</span></a></span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ZeroTypeN"><span class="annot"><a href="Naturals.html#ZeroTypeN"><span class="hs-identifier hs-var">ZeroTypeN</span></a></span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PairTypeN"><span class="annot"><a href="Naturals.html#PairTypeN"><span class="hs-identifier hs-var">PairTypeN</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NaturalType"><span class="hs-identifier hs-type">NaturalType</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NaturalType"><span class="hs-identifier hs-type">NaturalType</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ArrTypeN"><span class="annot"><a href="Naturals.html#ArrTypeN"><span class="hs-identifier hs-var">ArrTypeN</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ChurchType"><span class="annot"><a href="Naturals.html#ChurchType"><span class="hs-identifier hs-var">ChurchType</span></a></span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnknownN"><span class="annot"><a href="Naturals.html#UnknownN"><span class="hs-identifier hs-var">UnknownN</span></a></span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679254300"><span id="local-6989586621679254307"><span class="annot"><span class="annottext">NaturalType -&gt; NaturalType -&gt; Bool
(NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool) -&gt; Eq NaturalType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NaturalType -&gt; NaturalType -&gt; Bool
== :: NaturalType -&gt; NaturalType -&gt; Bool
$c/= :: NaturalType -&gt; NaturalType -&gt; Bool
/= :: NaturalType -&gt; NaturalType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254313"><span id="local-6989586621679254319"><span id="local-6989586621679254322"><span id="local-6989586621679254325"><span id="local-6989586621679254328"><span id="local-6989586621679254331"><span id="local-6989586621679254334"><span class="annot"><span class="annottext">Eq NaturalType
Eq NaturalType =&gt;
(NaturalType -&gt; NaturalType -&gt; Ordering)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; Bool)
-&gt; (NaturalType -&gt; NaturalType -&gt; NaturalType)
-&gt; (NaturalType -&gt; NaturalType -&gt; NaturalType)
-&gt; Ord NaturalType
NaturalType -&gt; NaturalType -&gt; Bool
NaturalType -&gt; NaturalType -&gt; Ordering
NaturalType -&gt; NaturalType -&gt; NaturalType
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: NaturalType -&gt; NaturalType -&gt; Ordering
compare :: NaturalType -&gt; NaturalType -&gt; Ordering
$c&lt; :: NaturalType -&gt; NaturalType -&gt; Bool
&lt; :: NaturalType -&gt; NaturalType -&gt; Bool
$c&lt;= :: NaturalType -&gt; NaturalType -&gt; Bool
&lt;= :: NaturalType -&gt; NaturalType -&gt; Bool
$c&gt; :: NaturalType -&gt; NaturalType -&gt; Bool
&gt; :: NaturalType -&gt; NaturalType -&gt; Bool
$c&gt;= :: NaturalType -&gt; NaturalType -&gt; Bool
&gt;= :: NaturalType -&gt; NaturalType -&gt; Bool
$cmax :: NaturalType -&gt; NaturalType -&gt; NaturalType
max :: NaturalType -&gt; NaturalType -&gt; NaturalType
$cmin :: NaturalType -&gt; NaturalType -&gt; NaturalType
min :: NaturalType -&gt; NaturalType -&gt; NaturalType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254338"><span id="local-6989586621679254347"><span id="local-6989586621679254350"><span class="annot"><span class="annottext">Int -&gt; NaturalType -&gt; ShowS
[NaturalType] -&gt; ShowS
NaturalType -&gt; [Char]
(Int -&gt; NaturalType -&gt; ShowS)
-&gt; (NaturalType -&gt; [Char])
-&gt; ([NaturalType] -&gt; ShowS)
-&gt; Show NaturalType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; NaturalType -&gt; ShowS
showsPrec :: Int -&gt; NaturalType -&gt; ShowS
$cshow :: NaturalType -&gt; [Char]
show :: NaturalType -&gt; [Char]
$cshowList :: [NaturalType] -&gt; ShowS
showList :: [NaturalType] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">--newtype FragIndex = FragIndex { unFragIndex :: Int } deriving (Eq, Show, Ord, Enum, NFData, Generic)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">newtype</span><span> </span><span id="TypeIndex"><span class="annot"><a href="Naturals.html#TypeIndex"><span class="hs-identifier hs-var">TypeIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TypeIndex"><span class="annot"><a href="Naturals.html#TypeIndex"><span class="hs-identifier hs-var">TypeIndex</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unTypeIndex"><span class="annot"><span class="annottext">TypeIndex -&gt; Int
</span><a href="Naturals.html#unTypeIndex"><span class="hs-identifier hs-var hs-var">unTypeIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679254356"><span id="local-6989586621679254361"><span class="annot"><span class="annottext">TypeIndex -&gt; TypeIndex -&gt; Bool
(TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool) -&gt; Eq TypeIndex
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: TypeIndex -&gt; TypeIndex -&gt; Bool
== :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c/= :: TypeIndex -&gt; TypeIndex -&gt; Bool
/= :: TypeIndex -&gt; TypeIndex -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254366"><span id="local-6989586621679254371"><span id="local-6989586621679254375"><span class="annot"><span class="annottext">Int -&gt; TypeIndex -&gt; ShowS
[TypeIndex] -&gt; ShowS
TypeIndex -&gt; [Char]
(Int -&gt; TypeIndex -&gt; ShowS)
-&gt; (TypeIndex -&gt; [Char])
-&gt; ([TypeIndex] -&gt; ShowS)
-&gt; Show TypeIndex
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; TypeIndex -&gt; ShowS
showsPrec :: Int -&gt; TypeIndex -&gt; ShowS
$cshow :: TypeIndex -&gt; [Char]
show :: TypeIndex -&gt; [Char]
$cshowList :: [TypeIndex] -&gt; ShowS
showList :: [TypeIndex] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254380"><span id="local-6989586621679254384"><span id="local-6989586621679254388"><span id="local-6989586621679254392"><span id="local-6989586621679254396"><span id="local-6989586621679254400"><span id="local-6989586621679254404"><span class="annot"><span class="annottext">Eq TypeIndex
Eq TypeIndex =&gt;
(TypeIndex -&gt; TypeIndex -&gt; Ordering)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; Bool)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; TypeIndex)
-&gt; (TypeIndex -&gt; TypeIndex -&gt; TypeIndex)
-&gt; Ord TypeIndex
TypeIndex -&gt; TypeIndex -&gt; Bool
TypeIndex -&gt; TypeIndex -&gt; Ordering
TypeIndex -&gt; TypeIndex -&gt; TypeIndex
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: TypeIndex -&gt; TypeIndex -&gt; Ordering
compare :: TypeIndex -&gt; TypeIndex -&gt; Ordering
$c&lt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
&lt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c&lt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
&lt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c&gt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
&gt; :: TypeIndex -&gt; TypeIndex -&gt; Bool
$c&gt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
&gt;= :: TypeIndex -&gt; TypeIndex -&gt; Bool
$cmax :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
max :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
$cmin :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
min :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254409"><span id="local-6989586621679254414"><span id="local-6989586621679254418"><span id="local-6989586621679254422"><span id="local-6989586621679254426"><span id="local-6989586621679254430"><span id="local-6989586621679254434"><span id="local-6989586621679254438"><span class="annot"><span class="annottext">Int -&gt; TypeIndex
TypeIndex -&gt; Int
TypeIndex -&gt; [TypeIndex]
TypeIndex -&gt; TypeIndex
TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
(TypeIndex -&gt; TypeIndex)
-&gt; (TypeIndex -&gt; TypeIndex)
-&gt; (Int -&gt; TypeIndex)
-&gt; (TypeIndex -&gt; Int)
-&gt; (TypeIndex -&gt; [TypeIndex])
-&gt; (TypeIndex -&gt; TypeIndex -&gt; [TypeIndex])
-&gt; (TypeIndex -&gt; TypeIndex -&gt; [TypeIndex])
-&gt; (TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex])
-&gt; Enum TypeIndex
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: TypeIndex -&gt; TypeIndex
succ :: TypeIndex -&gt; TypeIndex
$cpred :: TypeIndex -&gt; TypeIndex
pred :: TypeIndex -&gt; TypeIndex
$ctoEnum :: Int -&gt; TypeIndex
toEnum :: Int -&gt; TypeIndex
$cfromEnum :: TypeIndex -&gt; Int
fromEnum :: TypeIndex -&gt; Int
$cenumFrom :: TypeIndex -&gt; [TypeIndex]
enumFrom :: TypeIndex -&gt; [TypeIndex]
$cenumFromThen :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
enumFromThen :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
$cenumFromTo :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
enumFromTo :: TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
$cenumFromThenTo :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
enumFromThenTo :: TypeIndex -&gt; TypeIndex -&gt; TypeIndex -&gt; [TypeIndex]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679254444"><span id="local-6989586621679254452"><span id="local-6989586621679254458"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span></span></span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">data</span><span> </span><span id="ExprFrag"><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-var">ExprFrag</span></a></span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FZero"><span class="annot"><a href="Naturals.html#FZero"><span class="hs-identifier hs-var">FZero</span></a></span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FPair"><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-var">FPair</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FEnv"><span class="annot"><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FSetEnv"><span class="annot"><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-var">FSetEnv</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FDefer"><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-var">FDefer</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FGate"><span class="annot"><a href="Naturals.html#FGate"><span class="hs-identifier hs-var">FGate</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FLeft"><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-var">FLeft</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FRight"><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-var">FRight</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FTrace"><span class="annot"><a href="Naturals.html#FTrace"><span class="hs-identifier hs-var">FTrace</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-comment">-- complex instructions</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FApp"><span class="annot"><a href="Naturals.html#FApp"><span class="hs-identifier hs-var">FApp</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FNum"><span class="annot"><a href="Naturals.html#FNum"><span class="hs-identifier hs-var">FNum</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FToNum"><span class="annot"><a href="Naturals.html#FToNum"><span class="hs-identifier hs-var">FToNum</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679254487"><span id="local-6989586621679254502"><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; Bool
(ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool) -&gt; Eq ExprFrag
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ExprFrag -&gt; ExprFrag -&gt; Bool
== :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c/= :: ExprFrag -&gt; ExprFrag -&gt; Bool
/= :: ExprFrag -&gt; ExprFrag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254505"><span id="local-6989586621679254527"><span id="local-6989586621679254530"><span class="annot"><span class="annottext">Int -&gt; ExprFrag -&gt; ShowS
[ExprFrag] -&gt; ShowS
ExprFrag -&gt; [Char]
(Int -&gt; ExprFrag -&gt; ShowS)
-&gt; (ExprFrag -&gt; [Char]) -&gt; ([ExprFrag] -&gt; ShowS) -&gt; Show ExprFrag
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ExprFrag -&gt; ShowS
showsPrec :: Int -&gt; ExprFrag -&gt; ShowS
$cshow :: ExprFrag -&gt; [Char]
show :: ExprFrag -&gt; [Char]
$cshowList :: [ExprFrag] -&gt; ShowS
showList :: [ExprFrag] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254535"><span id="local-6989586621679254550"><span id="local-6989586621679254553"><span id="local-6989586621679254556"><span id="local-6989586621679254559"><span id="local-6989586621679254562"><span id="local-6989586621679254565"><span class="annot"><span class="annottext">Eq ExprFrag
Eq ExprFrag =&gt;
(ExprFrag -&gt; ExprFrag -&gt; Ordering)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; Bool)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; (ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; Ord ExprFrag
ExprFrag -&gt; ExprFrag -&gt; Bool
ExprFrag -&gt; ExprFrag -&gt; Ordering
ExprFrag -&gt; ExprFrag -&gt; ExprFrag
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: ExprFrag -&gt; ExprFrag -&gt; Ordering
compare :: ExprFrag -&gt; ExprFrag -&gt; Ordering
$c&lt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
&lt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c&lt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
&lt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c&gt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
&gt; :: ExprFrag -&gt; ExprFrag -&gt; Bool
$c&gt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
&gt;= :: ExprFrag -&gt; ExprFrag -&gt; Bool
$cmax :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
max :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
$cmin :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
min :: ExprFrag -&gt; ExprFrag -&gt; ExprFrag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="traceSet"><span class="annot"><span class="annottext">traceSet :: t FragIndex -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Naturals.html#traceSet"><span class="hs-identifier hs-var hs-var">traceSet</span></a></span></span><span> </span><span id="local-6989586621679254574"><span class="annot"><span class="annottext">t FragIndex
</span><a href="#local-6989586621679254574"><span class="hs-identifier hs-var">inds</span></a></span></span><span> </span><span id="local-6989586621679254575"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679254575"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span id="local-6989586621679254576"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679254576"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; t FragIndex -&gt; Bool
forall a. Eq a =&gt; a -&gt; t a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">t FragIndex
</span><a href="#local-6989586621679254574"><span class="hs-identifier hs-var">inds</span></a></span><span>
</span><span id="line-66"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a -&gt; a
forall a. [Char] -&gt; a -&gt; a
</span><a href="Naturals.html#debugTrace"><span class="hs-identifier hs-var">debugTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;env at apply index: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679254575"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679254576"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679254576"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-67"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679254576"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- traceSet _ x = x</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">data</span><span> </span><span id="NExpr"><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-var">NExpr</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NZero"><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NPair"><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NEnv"><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NSetEnv"><span class="annot"><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-var">NSetEnv</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NDefer"><span class="annot"><a href="Naturals.html#NDefer"><span class="hs-identifier hs-var">NDefer</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NGate"><span class="annot"><a href="Naturals.html#NGate"><span class="hs-identifier hs-var">NGate</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NLeft"><span class="annot"><a href="Naturals.html#NLeft"><span class="hs-identifier hs-var">NLeft</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NRight"><span class="annot"><a href="Naturals.html#NRight"><span class="hs-identifier hs-var">NRight</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NTrace"><span class="annot"><a href="Naturals.html#NTrace"><span class="hs-identifier hs-var">NTrace</span></a></span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NNum"><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-var">NNum</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NAdd"><span class="annot"><a href="Naturals.html#NAdd"><span class="hs-identifier hs-var">NAdd</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NMult"><span class="annot"><a href="Naturals.html#NMult"><span class="hs-identifier hs-var">NMult</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NPow"><span class="annot"><a href="Naturals.html#NPow"><span class="hs-identifier hs-var">NPow</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">{-
  | NForLoop Int64 NExpr -- for runtime, function and number of times to apply it
-}</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NApp"><span class="annot"><a href="Naturals.html#NApp"><span class="hs-identifier hs-var">NApp</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NOldDefer"><span class="annot"><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-var">NOldDefer</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-comment">-- can probably delete</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NToChurch"><span class="annot"><a href="Naturals.html#NToChurch"><span class="hs-identifier hs-var">NToChurch</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NTwiddle"><span class="annot"><a href="Naturals.html#NTwiddle"><span class="hs-identifier hs-var">NTwiddle</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NToNum"><span class="annot"><a href="Naturals.html#NToNum"><span class="hs-identifier hs-var">NToNum</span></a></span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679254599"><span id="local-6989586621679254623"><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; Bool
(NExpr -&gt; NExpr -&gt; Bool) -&gt; (NExpr -&gt; NExpr -&gt; Bool) -&gt; Eq NExpr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NExpr -&gt; NExpr -&gt; Bool
== :: NExpr -&gt; NExpr -&gt; Bool
$c/= :: NExpr -&gt; NExpr -&gt; Bool
/= :: NExpr -&gt; NExpr -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254626"><span id="local-6989586621679254664"><span id="local-6989586621679254667"><span class="annot"><span class="annottext">Int -&gt; NExpr -&gt; ShowS
[NExpr] -&gt; ShowS
NExpr -&gt; [Char]
(Int -&gt; NExpr -&gt; ShowS)
-&gt; (NExpr -&gt; [Char]) -&gt; ([NExpr] -&gt; ShowS) -&gt; Show NExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; NExpr -&gt; ShowS
showsPrec :: Int -&gt; NExpr -&gt; ShowS
$cshow :: NExpr -&gt; [Char]
show :: NExpr -&gt; [Char]
$cshowList :: [NExpr] -&gt; ShowS
showList :: [NExpr] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254672"><span id="local-6989586621679254696"><span id="local-6989586621679254699"><span id="local-6989586621679254702"><span id="local-6989586621679254705"><span id="local-6989586621679254708"><span id="local-6989586621679254711"><span class="annot"><span class="annottext">Eq NExpr
Eq NExpr =&gt;
(NExpr -&gt; NExpr -&gt; Ordering)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; Bool)
-&gt; (NExpr -&gt; NExpr -&gt; NExpr)
-&gt; (NExpr -&gt; NExpr -&gt; NExpr)
-&gt; Ord NExpr
NExpr -&gt; NExpr -&gt; Bool
NExpr -&gt; NExpr -&gt; Ordering
NExpr -&gt; NExpr -&gt; NExpr
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: NExpr -&gt; NExpr -&gt; Ordering
compare :: NExpr -&gt; NExpr -&gt; Ordering
$c&lt; :: NExpr -&gt; NExpr -&gt; Bool
&lt; :: NExpr -&gt; NExpr -&gt; Bool
$c&lt;= :: NExpr -&gt; NExpr -&gt; Bool
&lt;= :: NExpr -&gt; NExpr -&gt; Bool
$c&gt; :: NExpr -&gt; NExpr -&gt; Bool
&gt; :: NExpr -&gt; NExpr -&gt; Bool
$c&gt;= :: NExpr -&gt; NExpr -&gt; Bool
&gt;= :: NExpr -&gt; NExpr -&gt; Bool
$cmax :: NExpr -&gt; NExpr -&gt; NExpr
max :: NExpr -&gt; NExpr -&gt; NExpr
$cmin :: NExpr -&gt; NExpr -&gt; NExpr
min :: NExpr -&gt; NExpr -&gt; NExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254714"><span id="local-6989586621679254716"><span class="annot"><span class="annottext">(forall x. NExpr -&gt; Rep NExpr x)
-&gt; (forall x. Rep NExpr x -&gt; NExpr) -&gt; Generic NExpr
forall x. Rep NExpr x -&gt; NExpr
forall x. NExpr -&gt; Rep NExpr x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NExpr -&gt; Rep NExpr x
from :: forall x. NExpr -&gt; Rep NExpr x
$cto :: forall x. Rep NExpr x -&gt; NExpr
to :: forall x. Rep NExpr x -&gt; NExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679254720"><span class="annot"><span class="annottext">NExpr -&gt; ()
(NExpr -&gt; ()) -&gt; NFData NExpr
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: NExpr -&gt; ()
rnf :: NExpr -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679254781"><span id="local-6989586621679254788"><span id="local-6989586621679254794"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span></span></span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Naturals.html#NLamNum"><span class="hs-identifier hs-type">NLamNum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">pattern</span><span> </span><span id="NLamNum"><span id="%24mNLamNum"><span class="annot"><span class="annottext">$mNLamNum :: forall {r}. NExpr -&gt; (Int64 -&gt; NExpr -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Naturals.html#NLamNum"><span class="hs-identifier hs-var hs-var">NLamNum</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679254971"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679254972"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-type">NNum</span></a></span><span> </span><span id="local-6989586621679254971"><span class="annot"><a href="#local-6989586621679254971"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-type">NEnv</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679254972"><span class="annot"><a href="#local-6989586621679254972"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Naturals.html#NPartialNum"><span class="hs-identifier hs-type">NPartialNum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">pattern</span><span> </span><span id="NPartialNum"><span id="%24mNPartialNum"><span class="annot"><span class="annottext">$mNPartialNum :: forall {r}. NExpr -&gt; (Int64 -&gt; NExpr -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Naturals.html#NPartialNum"><span class="hs-identifier hs-var hs-var">NPartialNum</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679254975"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679254976"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-type">NNum</span></a></span><span> </span><span id="local-6989586621679254975"><span class="annot"><a href="#local-6989586621679254975"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679254976"><span class="annot"><a href="#local-6989586621679254976"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Naturals.html#nlam"><span class="hs-identifier hs-type">nlam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-103"></span><span id="nlam"><span class="annot"><span class="annottext">nlam :: NExpr -&gt; NExpr
</span><a href="Naturals.html#nlam"><span class="hs-identifier hs-var hs-var">nlam</span></a></span></span><span> </span><span id="local-6989586621679254978"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679254978"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-var">NOldDefer</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679254978"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-keyword">type</span><span> </span><span id="NResult"><span class="annot"><a href="Naturals.html#NResult"><span class="hs-identifier hs-var">NResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">newtype</span><span> </span><span id="NExprs"><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-var">NExprs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NExprs"><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-var">NExprs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NResult"><span class="hs-identifier hs-type">NResult</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679254982"><span id="local-6989586621679254989"><span class="annot"><span class="annottext">NExprs -&gt; NExprs -&gt; Bool
(NExprs -&gt; NExprs -&gt; Bool)
-&gt; (NExprs -&gt; NExprs -&gt; Bool) -&gt; Eq NExprs
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NExprs -&gt; NExprs -&gt; Bool
== :: NExprs -&gt; NExprs -&gt; Bool
$c/= :: NExprs -&gt; NExprs -&gt; Bool
/= :: NExprs -&gt; NExprs -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679254996"><span id="local-6989586621679255001"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679255003"><span class="annot"><span class="annottext">show :: NExprs -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span id="local-6989586621679255004"><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679255004"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679255024"><span class="annot"><span class="annottext">showInner :: NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var hs-var">showInner</span></a></span></span><span> </span><span id="local-6989586621679255025"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255025"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255025"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>          </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NZero&quot;</span></span><span>
</span><span id="line-113"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679255026"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255026"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679255027"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255027"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;( &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255026"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255027"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>          </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NEnv&quot;</span></span><span>
</span><span id="line-115"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-type">NSetEnv</span></a></span><span> </span><span id="local-6989586621679255029"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255029"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NSetEnv (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255029"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NDefer"><span class="hs-identifier hs-type">NDefer</span></a></span><span> </span><span id="local-6989586621679255030"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255030"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex NExpr -&gt; Maybe NExpr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255030"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679255004"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-117"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679255032"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255032"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NDefer (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255032"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">Maybe NExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ERROR undefined index in showing NExprs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255030"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-119"></span><span>          </span><span class="annot"><a href="Naturals.html#NGate"><span class="hs-identifier hs-type">NGate</span></a></span><span> </span><span id="local-6989586621679255033"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255033"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679255034"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255034"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NGate (&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255033"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255034"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; )&quot;</span></span><span>
</span><span id="line-120"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NLeft"><span class="hs-identifier hs-type">NLeft</span></a></span><span> </span><span id="local-6989586621679255035"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255035"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NLeft (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255035"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NRight"><span class="hs-identifier hs-type">NRight</span></a></span><span> </span><span id="local-6989586621679255036"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255036"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NRight (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255036"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NTrace"><span class="hs-identifier hs-var">NTrace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NTrace&quot;</span></span><span>
</span><span id="line-123"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NAdd"><span class="hs-identifier hs-type">NAdd</span></a></span><span> </span><span id="local-6989586621679255037"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255037"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679255038"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255038"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NAdd (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255037"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255038"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NMult"><span class="hs-identifier hs-type">NMult</span></a></span><span> </span><span id="local-6989586621679255039"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255039"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679255040"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255040"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NMult (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255039"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255040"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPow"><span class="hs-identifier hs-type">NPow</span></a></span><span> </span><span id="local-6989586621679255041"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255041"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679255042"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255042"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NPow (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255041"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255042"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; )&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-type">NOldDefer</span></a></span><span> </span><span id="local-6989586621679255043"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255043"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NOldDefer (&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255043"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-127"></span><span>          </span><span id="local-6989586621679255044"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255044"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255044"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr -&gt; Maybe (NExpr, Map FragIndex NExpr)
forall k a. Map k a -&gt; Maybe (a, Map k a)
</span><span class="hs-identifier hs-var">Map.minView</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679255004"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679255046"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255046"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; [Char]
</span><a href="#local-6989586621679255024"><span class="hs-identifier hs-var">showInner</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679255046"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">Maybe (NExpr, Map FragIndex NExpr)
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ERROR no root to NExprs tree&quot;</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">type</span><span> </span><span id="FragState"><span class="annot"><a href="Naturals.html#FragState"><span class="hs-identifier hs-var">FragState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-type">toFrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#FragState"><span class="hs-identifier hs-type">FragState</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- complex instructions</span><span>
</span><span id="line-136"></span><span id="toFrag"><span class="annot"><span class="annottext">toFrag :: IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var hs-var">toFrag</span></a></span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#ToChurch"><span class="hs-identifier hs-var">ToChurch</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall a.
a -&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FToNum"><span class="hs-identifier hs-var">FToNum</span></a></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#ChurchNum"><span class="hs-identifier hs-type">ChurchNum</span></a></span><span> </span><span id="local-6989586621679255048"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679255048"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall a.
a -&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; FragState ExprFrag)
-&gt; (Int64 -&gt; ExprFrag) -&gt; Int64 -&gt; FragState ExprFrag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ExprFrag
</span><a href="Naturals.html#FNum"><span class="hs-identifier hs-var">FNum</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; FragState ExprFrag) -&gt; Int64 -&gt; FragState ExprFrag
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679255048"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679255050"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255050"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679255051"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255051"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FApp"><span class="hs-identifier hs-var">FApp</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag
-&gt; StateT
     (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255050"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall a b.
StateT (FragIndex, Map FragIndex ExprFrag) Identity (a -&gt; b)
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255051"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- simple instructions</span><span>
</span><span id="line-140"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall a.
a -&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FZero"><span class="hs-identifier hs-var">FZero</span></a></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679255055"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255055"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679255056"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255056"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FPair"><span class="hs-identifier hs-var">FPair</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag
-&gt; StateT
     (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255055"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall a b.
StateT (FragIndex, Map FragIndex ExprFrag) Identity (a -&gt; b)
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255056"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall a.
a -&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679255059"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255059"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-var">FSetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag) -&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255059"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679255061"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255061"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679255062"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255062"><span class="hs-identifier hs-var">nx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255061"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679255063"><span class="annot"><span class="annottext">ei :: FragIndex
</span><a href="#local-6989586621679255063"><span class="hs-identifier hs-var">ei</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span id="local-6989586621679255064"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679255064"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255065"><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255065"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag)
  Identity
  (FragIndex, Map FragIndex ExprFrag)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679255067"><span class="annot"><span class="annottext">td :: a -&gt; a
</span><a href="#local-6989586621679255067"><span class="hs-identifier hs-var hs-var">td</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-comment">-- trace (&quot;adding defer &quot; ++ show i ++ &quot; - &quot; ++ show nx)</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">(FragIndex, Map FragIndex ExprFrag)
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">State.put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679255064"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(FragIndex
 -&gt; ExprFrag -&gt; Map FragIndex ExprFrag -&gt; Map FragIndex ExprFrag)
-&gt; FragIndex
-&gt; ExprFrag
-&gt; Map FragIndex ExprFrag
-&gt; Map FragIndex ExprFrag
forall a. a -&gt; a
</span><a href="#local-6989586621679255067"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; ExprFrag -&gt; Map FragIndex ExprFrag -&gt; Map FragIndex ExprFrag
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255063"><span class="hs-identifier hs-var">ei</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255062"><span class="hs-identifier hs-var">nx</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255065"><span class="hs-identifier hs-var">fragMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall a.
a -&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; FragState ExprFrag) -&gt; ExprFrag -&gt; FragState ExprFrag
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; ExprFrag
</span><a href="Naturals.html#FDefer"><span class="hs-identifier hs-var">FDefer</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255063"><span class="hs-identifier hs-var">ei</span></a></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679255073"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255073"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679255074"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255074"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FGate"><span class="hs-identifier hs-var">FGate</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag
-&gt; StateT
     (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255073"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex ExprFrag) Identity (ExprFrag -&gt; ExprFrag)
-&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall a b.
StateT (FragIndex, Map FragIndex ExprFrag) Identity (a -&gt; b)
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
-&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255074"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679255076"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255076"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FLeft"><span class="hs-identifier hs-var">FLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag) -&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255076"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679255078"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255078"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; ExprFrag
</span><a href="Naturals.html#FRight"><span class="hs-identifier hs-var">FRight</span></a></span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag) -&gt; FragState ExprFrag -&gt; FragState ExprFrag
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255078"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; FragState ExprFrag
forall a.
a -&gt; StateT (FragIndex, Map FragIndex ExprFrag) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FTrace"><span class="hs-identifier hs-var">FTrace</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Naturals.html#fromFrag"><span class="hs-identifier hs-type">fromFrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-156"></span><span id="fromFrag"><span class="annot"><span class="annottext">fromFrag :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; IExpr
</span><a href="Naturals.html#fromFrag"><span class="hs-identifier hs-var hs-var">fromFrag</span></a></span></span><span> </span><span id="local-6989586621679255081"><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255081"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679255082"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255082"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679255083"><span class="annot"><span class="annottext">recur :: ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag -&gt; ExprFrag -&gt; IExpr
</span><a href="Naturals.html#fromFrag"><span class="hs-identifier hs-var">fromFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255081"><span class="hs-identifier hs-var">fragMap</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255082"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FZero"><span class="hs-identifier hs-var">FZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span id="local-6989586621679255084"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255084"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679255085"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255085"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255084"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255085"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-type">FSetEnv</span></a></span><span> </span><span id="local-6989586621679255086"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255086"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255086"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679255087"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255087"><span class="hs-identifier hs-var">fi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255087"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255081"><span class="hs-identifier hs-var">fragMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">Maybe ExprFrag
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IExpr
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;fromFrag bad index &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255087"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679255089"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255089"><span class="hs-identifier hs-var">subFrag</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255089"><span class="hs-identifier hs-var">subFrag</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Naturals.html#FGate"><span class="hs-identifier hs-type">FGate</span></a></span><span> </span><span id="local-6989586621679255090"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255090"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679255091"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255091"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255090"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255091"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span id="local-6989586621679255092"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255092"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255092"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-type">FRight</span></a></span><span> </span><span id="local-6989586621679255093"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255093"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PRight"><span class="hs-identifier hs-var">PRight</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; IExpr
</span><a href="#local-6989586621679255083"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255093"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FTrace"><span class="hs-identifier hs-var">FTrace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679255094"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255094"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IExpr
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;fromFrag TODO convert &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255094"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Naturals.html#matchChurchPlus"><span class="hs-identifier hs-type">matchChurchPlus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span id="matchChurchPlus"><span class="annot"><span class="annottext">matchChurchPlus :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchChurchPlus"><span class="hs-identifier hs-var hs-var">matchChurchPlus</span></a></span></span><span> </span><span id="local-6989586621679255096"><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255096"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679255097"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255097"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679255099"><span class="annot"><span class="annottext">lam :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679255099"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679255100"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255100"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255100"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255096"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><a href="#local-6989586621679255099"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679255102"><span class="annot"><span class="annottext">def :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679255102"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679255103"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255103"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255103"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255096"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><a href="#local-6989586621679255102"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-176"></span><span>      </span><span id="local-6989586621679255104"><span class="annot"><span class="annottext">firstArg :: ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679255104"><span class="hs-identifier hs-var hs-var">firstArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><a href="#local-6989586621679255104"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-178"></span><span>      </span><span id="local-6989586621679255105"><span class="annot"><span class="annottext">secondArg :: ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679255105"><span class="hs-identifier hs-var hs-var">secondArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-type">FRight</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><a href="#local-6989586621679255105"><span class="hs-identifier hs-var">secondArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-180"></span><span>      </span><span id="local-6989586621679255106"><span class="annot"><span class="annottext">app :: ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679255106"><span class="hs-identifier hs-var hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679255099"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255097"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag -&gt; (ExprFrag -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679255099"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
-&gt; (ExprFrag -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679255106"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679255108"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255108"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255109"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255109"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; ExprFrag -&gt; (ExprFrag, ExprFrag))
-&gt; Maybe ExprFrag -&gt; Maybe (ExprFrag -&gt; (ExprFrag, ExprFrag))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679255106"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255108"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679255110"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255110"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255111"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255111"><span class="hs-identifier hs-var">sa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679255105"><span class="hs-identifier hs-var">secondArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255111"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe ExprFrag -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255110"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe (ExprFrag -&gt; (ExprFrag, ExprFrag))
-&gt; Maybe ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
forall a b. Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679255106"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255109"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679255112"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255112"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255113"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255113"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679255104"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255113"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ()
-&gt; Maybe (ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag)
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="#local-6989586621679255106"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255112"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-183"></span><span>                                                               </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679255114"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255114"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255115"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255115"><span class="hs-identifier hs-var">sa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679255105"><span class="hs-identifier hs-var">secondArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255115"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe ExprFrag -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255114"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                                  </span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Naturals.html#matchChurchMult"><span class="hs-identifier hs-type">matchChurchMult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span id="matchChurchMult"><span class="annot"><span class="annottext">matchChurchMult :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchChurchMult"><span class="hs-identifier hs-var hs-var">matchChurchMult</span></a></span></span><span> </span><span id="local-6989586621679255117"><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255117"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679255118"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255118"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679255120"><span class="annot"><span class="annottext">lam :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679255120"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679255121"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255121"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255121"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255117"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><a href="#local-6989586621679255120"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621679255123"><span class="annot"><span class="annottext">def :: ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679255123"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679255124"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255124"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex ExprFrag -&gt; Maybe ExprFrag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255124"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255117"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><a href="#local-6989586621679255123"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-192"></span><span>      </span><span id="local-6989586621679255125"><span class="annot"><span class="annottext">firstArg :: ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679255125"><span class="hs-identifier hs-var hs-var">firstArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><a href="#local-6989586621679255125"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
</span><a href="#local-6989586621679255120"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255118"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ExprFrag
-&gt; (ExprFrag -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag))
-&gt; Maybe (ExprFrag, ExprFrag)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679255126"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255126"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255127"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255127"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255126"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; (ExprFrag, ExprFrag))
-&gt; Maybe ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255127"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
-&gt; ((ExprFrag, ExprFrag) -&gt; Maybe ExprFrag) -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679255128"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255128"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255129"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255129"><span class="hs-identifier hs-var">fa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ()
</span><a href="#local-6989586621679255125"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255129"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe ExprFrag -&gt; Maybe ExprFrag
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; Maybe ExprFrag
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255128"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Naturals.html#matchApp"><span class="hs-identifier hs-type">matchApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span id="matchApp"><span class="annot"><span class="annottext">matchApp :: ExprFrag -&gt; Maybe (ExprFrag, ExprFrag)
</span><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var hs-var">matchApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FApp"><span class="hs-identifier hs-type">FApp</span></a></span><span> </span><span id="local-6989586621679255130"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255130"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679255131"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255131"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExprFrag, ExprFrag) -&gt; Maybe (ExprFrag, ExprFrag)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255130"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255131"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span class="annot"><a href="Naturals.html#matchApp"><span class="hs-identifier hs-var">matchApp</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ExprFrag, ExprFrag)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Naturals.html#fragmentExpr"><span class="hs-identifier hs-type">fragmentExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span>
</span><span id="line-201"></span><span id="fragmentExpr"><span class="annot"><span class="annottext">fragmentExpr :: IExpr -&gt; Map FragIndex ExprFrag
</span><a href="Naturals.html#fragmentExpr"><span class="hs-identifier hs-var hs-var">fragmentExpr</span></a></span></span><span> </span><span id="local-6989586621679255133"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255133"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679255134"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255134"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679255135"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255135"><span class="hs-identifier hs-var">li</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679255136"><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255136"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragState ExprFrag
-&gt; (FragIndex, Map FragIndex ExprFrag)
-&gt; (ExprFrag, (FragIndex, Map FragIndex ExprFrag))
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">State.runState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; FragState ExprFrag
</span><a href="Naturals.html#toFrag"><span class="hs-identifier hs-var">toFrag</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679255133"><span class="hs-identifier hs-var">iexpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>                         </span><span id="local-6989586621679255140"><span class="annot"><span class="annottext">fragMap :: Map FragIndex ExprFrag
</span><a href="#local-6989586621679255140"><span class="hs-identifier hs-var hs-var">fragMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; ExprFrag -&gt; Map FragIndex ExprFrag -&gt; Map FragIndex ExprFrag
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255134"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255136"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-203"></span><span>                         </span><span class="hs-comment">-- tt x = trace (show x) x</span><span>
</span><span id="line-204"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255140"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-type">fragToNExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-207"></span><span id="fragToNExpr"><span class="annot"><span class="annottext">fragToNExpr :: Map FragIndex ExprFrag -&gt; ExprFrag -&gt; NExpr
</span><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-var hs-var">fragToNExpr</span></a></span></span><span> </span><span id="local-6989586621679255142"><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255142"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span id="local-6989586621679255143"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255143"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679255144"><span class="annot"><span class="annottext">recur :: ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag -&gt; ExprFrag -&gt; NExpr
</span><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-var">fragToNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255142"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255143"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>            </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FZero"><span class="hs-identifier hs-var">FZero</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FPair"><span class="hs-identifier hs-type">FPair</span></a></span><span> </span><span id="local-6989586621679255145"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255145"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679255146"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255146"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255145"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255146"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FSetEnv"><span class="hs-identifier hs-type">FSetEnv</span></a></span><span> </span><span id="local-6989586621679255147"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255147"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-var">NSetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExpr) -&gt; NExpr -&gt; NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255147"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-214"></span><span>            </span><span class="annot"><a href="Naturals.html#FGate"><span class="hs-identifier hs-type">FGate</span></a></span><span> </span><span id="local-6989586621679255148"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255148"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679255149"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255149"><span class="hs-identifier hs-var">r</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NGate"><span class="hs-identifier hs-var">NGate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255148"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255149"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FLeft"><span class="hs-identifier hs-type">FLeft</span></a></span><span> </span><span id="local-6989586621679255150"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255150"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NLeft"><span class="hs-identifier hs-var">NLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExpr) -&gt; NExpr -&gt; NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255150"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-216"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FRight"><span class="hs-identifier hs-type">FRight</span></a></span><span> </span><span id="local-6989586621679255151"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255151"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NRight"><span class="hs-identifier hs-var">NRight</span></a></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExpr) -&gt; NExpr -&gt; NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255151"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-217"></span><span>            </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FTrace"><span class="hs-identifier hs-var">FTrace</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NTrace"><span class="hs-identifier hs-var">NTrace</span></a></span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FDefer"><span class="hs-identifier hs-type">FDefer</span></a></span><span> </span><span id="local-6989586621679255152"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255152"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; NExpr
</span><a href="Naturals.html#NDefer"><span class="hs-identifier hs-var">NDefer</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679255152"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-219"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FNum"><span class="hs-identifier hs-type">FNum</span></a></span><span> </span><span id="local-6989586621679255153"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679255153"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-var">NOldDefer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; NExpr
</span><a href="Naturals.html#NNum"><span class="hs-identifier hs-var">NNum</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679255153"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span>
</span><span id="line-220"></span><span>            </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="Naturals.html#FToNum"><span class="hs-identifier hs-var">FToNum</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NToNum"><span class="hs-identifier hs-var">NToNum</span></a></span><span>
</span><span id="line-221"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#FApp"><span class="hs-identifier hs-type">FApp</span></a></span><span> </span><span id="local-6989586621679255154"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255154"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679255155"><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255155"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NApp"><span class="hs-identifier hs-var">NApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255154"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprFrag -&gt; NExpr
</span><a href="#local-6989586621679255144"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">ExprFrag
</span><a href="#local-6989586621679255155"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Naturals.html#fragsToNExpr"><span class="hs-identifier hs-type">fragsToNExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#ExprFrag"><span class="hs-identifier hs-type">ExprFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NResult"><span class="hs-identifier hs-type">NResult</span></a></span><span>
</span><span id="line-224"></span><span id="fragsToNExpr"><span class="annot"><span class="annottext">fragsToNExpr :: Map FragIndex ExprFrag -&gt; Map FragIndex NExpr
</span><a href="Naturals.html#fragsToNExpr"><span class="hs-identifier hs-var hs-var">fragsToNExpr</span></a></span></span><span> </span><span id="local-6989586621679255157"><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255157"><span class="hs-identifier hs-var">fragMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExprFrag -&gt; NExpr)
-&gt; Map FragIndex ExprFrag -&gt; Map FragIndex NExpr
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map FragIndex ExprFrag -&gt; ExprFrag -&gt; NExpr
</span><a href="Naturals.html#fragToNExpr"><span class="hs-identifier hs-var">fragToNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255157"><span class="hs-identifier hs-var">fragMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag
</span><a href="#local-6989586621679255157"><span class="hs-identifier hs-var">fragMap</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span id="debugShow"><span class="annot"><span class="annottext">debugShow :: p -&gt; p
</span><a href="Naturals.html#debugShow"><span class="hs-identifier hs-var hs-var">debugShow</span></a></span></span><span> </span><span id="local-6989586621679255160"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679255160"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679255160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- trace (&quot;toNExpr\n&quot; ++ show x) x</span><span>
</span><span id="line-227"></span></pre></body></html>