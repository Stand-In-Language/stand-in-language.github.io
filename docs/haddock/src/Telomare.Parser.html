<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFoldable      #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DeriveFunctor       #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DeriveTraversable   #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE KindSignatures      #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell     #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.Parser</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Lens.Combinators</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Lens.Operators</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.State</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-type">State</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control.Monad.State</span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">State</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Bifunctor</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Foldable</span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Functor.Foldable</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Functor.Foldable.TH</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.List</span><span>                  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">delete</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elem</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elemIndex</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Map</span><span>                   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Map</span><span>                   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toList</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Maybe</span><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Set</span><span>                   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">\\</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Void</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Debug.Trace</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">System.IO.Strict</span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Strict</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span>           </span><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span>           </span><a href="Telomare.TypeChecker.html"><span class="hs-identifier">Telomare.TypeChecker</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Text.Megaparsec</span><span>            </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">State</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Text.Megaparsec.Char</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Text.Megaparsec.Char.Lexer</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Text.Megaparsec.Debug</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Text.Megaparsec.Pos</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Text.Read</span><span>                  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">data</span><span> </span><a name="UnprocessedParsedTerm"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier">UnprocessedParsedTerm</span></a></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="VarUP"><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier">VarUP</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ITEUP"><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier">ITEUP</span></a></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-44"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LetUP"><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier">LetUP</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-45"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ListUP"><a href="Telomare.Parser.html#ListUP"><span class="hs-identifier">ListUP</span></a></a><span> </span><span class="hs-special">[</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">]</span><span>
</span><a name="line-46"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IntUP"><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier">IntUP</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-47"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StringUP"><a href="Telomare.Parser.html#StringUP"><span class="hs-identifier">StringUP</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PairUP"><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier">PairUP</span></a></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AppUP"><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier">AppUP</span></a></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LamUP"><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier">LamUP</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ChurchUP"><a href="Telomare.Parser.html#ChurchUP"><span class="hs-identifier">ChurchUP</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnsizedRecursionUP"><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier">UnsizedRecursionUP</span></a></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LeftUP"><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier">LeftUP</span></a></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RightUP"><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier">RightUP</span></a></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TraceUP"><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier">TraceUP</span></a></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-comment">-- TODO check</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">makeBaseFunctor</span></a><span> </span><span class="hs-special">''</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">UnprocessedParsedTerm</span></a><span> </span><span class="hs-comment">-- Functorial version UnprocessedParsedTerm</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">instance</span><span> </span><a href="Telomare.html#EndoMapper"><span class="hs-identifier hs-type">EndoMapper</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-61"></a><span>  </span><a name="local-8214565720323824929"><a href="Telomare.html#endoMap"><span class="hs-identifier">endoMap</span></a></a><span> </span><a name="local-6989586621679306243"><a href="#local-6989586621679306243"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-62"></a><span>    </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><a name="local-6989586621679306245"><a href="#local-6989586621679306245"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><a href="#local-6989586621679306245"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-63"></a><span>    </span><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a><span> </span><a name="local-6989586621679306246"><a href="#local-6989586621679306246"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679306247"><a href="#local-6989586621679306247"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679306248"><a href="#local-6989586621679306248"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306246"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306247"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306248"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>    </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span> </span><a name="local-6989586621679306249"><a href="#local-6989586621679306249"><span class="hs-identifier">listmap</span></a></a><span> </span><a name="local-6989586621679306250"><a href="#local-6989586621679306250"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span> </span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306249"><span class="hs-identifier hs-var">listmap</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306250"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-65"></a><span>    </span><a href="Telomare.Parser.html#ListUP"><span class="hs-identifier hs-var">ListUP</span></a><span> </span><a name="local-6989586621679306251"><a href="#local-6989586621679306251"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#ListUP"><span class="hs-identifier hs-var">ListUP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306251"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>    </span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a><span> </span><a name="local-6989586621679306252"><a href="#local-6989586621679306252"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a><span> </span><a href="#local-6989586621679306252"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-67"></a><span>    </span><a href="Telomare.Parser.html#StringUP"><span class="hs-identifier hs-var">StringUP</span></a><span> </span><a name="local-6989586621679306253"><a href="#local-6989586621679306253"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#StringUP"><span class="hs-identifier hs-var">StringUP</span></a><span> </span><a href="#local-6989586621679306253"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-68"></a><span>    </span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a><span> </span><a name="local-6989586621679306254"><a href="#local-6989586621679306254"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679306255"><a href="#local-6989586621679306255"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306254"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306255"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>    </span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><a name="local-6989586621679306256"><a href="#local-6989586621679306256"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679306257"><a href="#local-6989586621679306257"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306256"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306257"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>    </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><a name="local-6989586621679306258"><a href="#local-6989586621679306258"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621679306259"><a href="#local-6989586621679306259"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><a href="#local-6989586621679306258"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306259"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>    </span><a href="Telomare.Parser.html#ChurchUP"><span class="hs-identifier hs-var">ChurchUP</span></a><span> </span><a name="local-6989586621679306260"><a href="#local-6989586621679306260"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#ChurchUP"><span class="hs-identifier hs-var">ChurchUP</span></a><span> </span><a href="#local-6989586621679306260"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-72"></a><span>    </span><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a><span>
</span><a name="line-73"></a><span>    </span><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a><span> </span><a name="local-6989586621679306261"><a href="#local-6989586621679306261"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306261"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>    </span><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a><span> </span><a name="local-6989586621679306262"><a href="#local-6989586621679306262"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306262"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>    </span><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a><span> </span><a name="local-6989586621679306263"><a href="#local-6989586621679306263"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306244"><span class="hs-identifier hs-var">recur</span></a><span> </span><a href="#local-6989586621679306263"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679306244"><a href="#local-6989586621679306244"><span class="hs-identifier">recur</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679306243"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-keyword">type</span><span> </span><a name="VarList"><a href="Telomare.Parser.html#VarList"><span class="hs-identifier">VarList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- |TelomareParser :: * -&gt; *</span><span>
</span><a name="line-81"></a><span class="hs-comment">--type TelomareParser = State.StateT ParserState (Parsec Void String)</span><span>
</span><a name="line-82"></a><span class="hs-keyword">type</span><span> </span><a name="TelomareParser"><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier">TelomareParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Parsec</span><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-keyword">newtype</span><span> </span><a name="ErrorString"><a href="Telomare.Parser.html#ErrorString"><span class="hs-identifier">ErrorString</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MkES"><a href="Telomare.Parser.html#MkES"><span class="hs-identifier">MkES</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="getErrorString"><a href="Telomare.Parser.html#getErrorString"><span class="hs-identifier">getErrorString</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- |Int to ParserTerm</span><span>
</span><a name="line-87"></a><span class="hs-identifier">i2t</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#ParserTerm"><span class="hs-identifier hs-type">ParserTerm</span></a><span> </span><a href="#local-6989586621679306281"><span class="hs-identifier hs-type">l</span></a><span> </span><a href="#local-6989586621679306282"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-88"></a><a name="i2t"><a href="Telomare.Parser.html#i2t"><span class="hs-identifier">i2t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ana</span><span> </span><a href="#local-6989586621679306283"><span class="hs-identifier hs-var">coalg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-identifier">coalg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Base</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#ParserTerm"><span class="hs-identifier hs-type">ParserTerm</span></a><span> </span><a href="#local-6989586621679306284"><span class="hs-identifier hs-type">l</span></a><span> </span><a href="#local-6989586621679306285"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-90"></a><span>  </span><a name="local-6989586621679306283"><a href="#local-6989586621679306283"><span class="hs-identifier">coalg</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TZeroF"><span class="hs-identifier hs-var">TZeroF</span></a><span>
</span><a name="line-91"></a><span>  </span><span class="hs-identifier">coalg</span><span> </span><a name="local-6989586621679306286"><a href="#local-6989586621679306286"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TPairF"><span class="hs-identifier hs-var">TPairF</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306286"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- |List of Int's to ParserTerm</span><span>
</span><a name="line-94"></a><span class="hs-identifier">ints2t</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#ParserTerm"><span class="hs-identifier hs-type">ParserTerm</span></a><span> </span><a href="#local-6989586621679306279"><span class="hs-identifier hs-type">l</span></a><span> </span><a href="#local-6989586621679306280"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-95"></a><a name="ints2t"><a href="Telomare.Parser.html#ints2t"><span class="hs-identifier">ints2t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679306287"><a href="#local-6989586621679306287"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679306288"><a href="#local-6989586621679306288"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#i2t"><span class="hs-identifier hs-var">i2t</span></a><span> </span><a href="#local-6989586621679306287"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679306288"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">-- |String to ParserTerm</span><span>
</span><a name="line-98"></a><span class="hs-identifier">s2t</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#ParserTerm"><span class="hs-identifier hs-type">ParserTerm</span></a><span> </span><a href="#local-6989586621679306277"><span class="hs-identifier hs-type">l</span></a><span> </span><a href="#local-6989586621679306278"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-99"></a><a name="s2t"><a href="Telomare.Parser.html#s2t"><span class="hs-identifier">s2t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.Parser.html#ints2t"><span class="hs-identifier hs-var">ints2t</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">ord</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- |Int to Church encoding</span><span>
</span><a name="line-102"></a><span class="hs-identifier">i2c</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span>
</span><a name="line-103"></a><a name="i2c"><a href="Telomare.Parser.html#i2c"><span class="hs-identifier">i2c</span></a></a><span> </span><a name="local-6989586621679306289"><a href="#local-6989586621679306289"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a><span> </span><span class="hs-string">&quot;f&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306290"><span class="hs-identifier hs-var">inner</span></a><span> </span><a href="#local-6989586621679306289"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">inner</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span>
</span><a name="line-105"></a><span>        </span><a name="local-6989586621679306290"><a href="#local-6989586621679306290"><span class="hs-identifier">inner</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">apo</span><span> </span><a href="#local-6989586621679306291"><span class="hs-identifier hs-var">coalg</span></a><span>
</span><a name="line-106"></a><span>        </span><span class="hs-identifier">coalg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Base</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>        </span><a name="local-6989586621679306291"><a href="#local-6989586621679306291"><span class="hs-identifier">coalg</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-108"></a><span>        </span><span class="hs-identifier">coalg</span><span> </span><a name="local-6989586621679306292"><a href="#local-6989586621679306292"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TAppF"><span class="hs-identifier hs-var">TAppF</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;f&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679306292"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-identifier">debruijinize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679306276"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Telomare.Parser.html#VarList"><span class="hs-identifier hs-type">VarList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306276"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a><span>
</span><a name="line-111"></a><a name="debruijinize"><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier">debruijinize</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a><span>
</span><a name="line-112"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306293"><a href="#local-6989586621679306293"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a><span> </span><a name="local-6989586621679306294"><a href="#local-6989586621679306294"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679306295"><a href="#local-6989586621679306295"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306293"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306294"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306293"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306295"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-113"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306296"><a href="#local-6989586621679306296"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a><span> </span><a name="local-6989586621679306297"><a href="#local-6989586621679306297"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">elemIndex</span><span> </span><a href="#local-6989586621679306297"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679306296"><span class="hs-identifier hs-var">vl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-114"></a><span>                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679306458"><a href="#local-6989586621679306458"><span class="hs-identifier">i</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a><span> </span><a href="#local-6989586621679306458"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-115"></a><span>                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;undefined identifier &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679306297"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-116"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306459"><a href="#local-6989586621679306459"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a><span> </span><a name="local-6989586621679306460"><a href="#local-6989586621679306460"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679306461"><a href="#local-6989586621679306461"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306459"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306460"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306459"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306461"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-117"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306462"><a href="#local-6989586621679306462"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TCheck"><span class="hs-identifier hs-var">TCheck</span></a><span> </span><a name="local-6989586621679306463"><a href="#local-6989586621679306463"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679306464"><a href="#local-6989586621679306464"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TCheck"><span class="hs-identifier hs-var">TCheck</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306462"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306463"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306462"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306464"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-118"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306465"><a href="#local-6989586621679306465"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a><span> </span><a name="local-6989586621679306466"><a href="#local-6989586621679306466"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679306467"><a href="#local-6989586621679306467"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679306468"><a href="#local-6989586621679306468"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306465"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306466"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-119"></a><span>                                    </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306465"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306467"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-120"></a><span>                                    </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306465"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306468"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-121"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306469"><a href="#local-6989586621679306469"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a><span> </span><a name="local-6989586621679306470"><a href="#local-6989586621679306470"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306469"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306470"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-122"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306471"><a href="#local-6989586621679306471"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a><span> </span><a name="local-6989586621679306472"><a href="#local-6989586621679306472"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306471"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306472"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-123"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306473"><a href="#local-6989586621679306473"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a><span> </span><a name="local-6989586621679306474"><a href="#local-6989586621679306474"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><a href="#local-6989586621679306473"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679306474"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-124"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306475"><a href="#local-6989586621679306475"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a><span> </span><a name="local-6989586621679306476"><a href="#local-6989586621679306476"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679306477"><a href="#local-6989586621679306477"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306476"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679306475"><span class="hs-identifier hs-var">vl</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679306477"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-125"></a><span class="hs-identifier">debruijinize</span><span> </span><a name="local-6989586621679306478"><a href="#local-6989586621679306478"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a><span> </span><a name="local-6989586621679306479"><a href="#local-6989586621679306479"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679306480"><a href="#local-6989586621679306480"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306479"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679306478"><span class="hs-identifier hs-var">vl</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679306480"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-126"></a><span class="hs-identifier">debruijinize</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-var">TLimitedRecursion</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-var">TLimitedRecursion</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-identifier">splitExpr'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#BreakState%27"><span class="hs-identifier hs-type">BreakState'</span></a><span> </span><a href="Telomare.html#BreakExtras"><span class="hs-identifier hs-type">BreakExtras</span></a><span>
</span><a name="line-129"></a><a name="splitExpr%27"><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier">splitExpr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-130"></a><span>  </span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a><span>
</span><a name="line-131"></a><span>  </span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a><span> </span><a name="local-6989586621679306481"><a href="#local-6989586621679306481"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679306482"><a href="#local-6989586621679306482"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306481"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306482"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-132"></a><span>  </span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a><span> </span><a name="local-6989586621679306483"><a href="#local-6989586621679306483"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.html#varNF"><span class="hs-identifier hs-var">varNF</span></a><span> </span><a href="#local-6989586621679306483"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-133"></a><span>  </span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a><span> </span><a name="local-6989586621679306484"><a href="#local-6989586621679306484"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679306485"><a href="#local-6989586621679306485"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#appF"><span class="hs-identifier hs-var">appF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306484"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306485"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>  </span><a href="Telomare.html#TCheck"><span class="hs-identifier hs-var">TCheck</span></a><span> </span><a name="local-6989586621679306486"><a href="#local-6989586621679306486"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679306487"><a href="#local-6989586621679306487"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679306488"><a href="#local-6989586621679306488"><span class="hs-identifier">performTC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679306489"><a href="#local-6989586621679306489"><span class="hs-identifier">ia</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><a href="Telomare.html#AbortF"><span class="hs-identifier hs-var">AbortF</span></a><span> </span><a href="#local-6989586621679306489"><span class="hs-identifier hs-var">ia</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#RightF"><span class="hs-identifier hs-var">RightF</span></a><span> </span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.html#appF"><span class="hs-identifier hs-var">appF</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.html#LeftF"><span class="hs-identifier hs-var">LeftF</span></a><span> </span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.html#RightF"><span class="hs-identifier hs-var">RightF</span></a><span> </span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679306490"><a href="#local-6989586621679306490"><span class="hs-identifier">ptc</span></a></a><span> </span><a name="local-6989586621679306491"><a href="#local-6989586621679306491"><span class="hs-identifier">nc</span></a></a><span> </span><a name="local-6989586621679306492"><a href="#local-6989586621679306492"><span class="hs-identifier">ntc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><a href="#local-6989586621679306490"><span class="hs-identifier hs-var">ptc</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><a href="#local-6989586621679306492"><span class="hs-identifier hs-var">ntc</span></a><span> </span><a href="#local-6989586621679306491"><span class="hs-identifier hs-var">nc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306488"><span class="hs-identifier hs-var">performTC</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306486"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306487"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-137"></a><span>  </span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a><span> </span><a name="local-6989586621679306493"><a href="#local-6989586621679306493"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679306494"><a href="#local-6989586621679306494"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679306495"><a href="#local-6989586621679306495"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679306496"><a href="#local-6989586621679306496"><span class="hs-identifier">ni</span></a></a><span> </span><a name="local-6989586621679306497"><a href="#local-6989586621679306497"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621679306498"><a href="#local-6989586621679306498"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#GateF"><span class="hs-identifier hs-var">GateF</span></a><span> </span><a href="#local-6989586621679306498"><span class="hs-identifier hs-var">ne</span></a><span> </span><a href="#local-6989586621679306497"><span class="hs-identifier hs-var">nt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679306496"><span class="hs-identifier hs-var">ni</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306493"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306494"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306495"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-138"></a><span>  </span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a><span> </span><a name="local-6989586621679306499"><a href="#local-6989586621679306499"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#LeftF"><span class="hs-identifier hs-var">LeftF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306499"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-139"></a><span>  </span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a><span> </span><a name="local-6989586621679306500"><a href="#local-6989586621679306500"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#RightF"><span class="hs-identifier hs-var">RightF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306500"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-140"></a><span>  </span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a><span> </span><a name="local-6989586621679306501"><a href="#local-6989586621679306501"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679306502"><a href="#local-6989586621679306502"><span class="hs-identifier">tf</span></a></a><span> </span><a name="local-6989586621679306503"><a href="#local-6989586621679306503"><span class="hs-identifier">nx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><a href="#local-6989586621679306502"><span class="hs-identifier hs-var">tf</span></a><span> </span><a href="#local-6989586621679306503"><span class="hs-identifier hs-var">nx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#TraceF"><span class="hs-identifier hs-var">TraceF</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306501"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-141"></a><span>  </span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679306504"><a href="#local-6989586621679306504"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679306505"><a href="#local-6989586621679306505"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><a href="#local-6989586621679306505"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306504"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>  </span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679306506"><a href="#local-6989586621679306506"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679306507"><a href="#local-6989586621679306507"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><a href="#local-6989586621679306507"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306506"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>  </span><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-var">TLimitedRecursion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.html#AuxF"><span class="hs-identifier hs-var">AuxF</span></a><span> </span><a href="Telomare.html#UnsizedRecursion"><span class="hs-identifier hs-var">UnsizedRecursion</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-identifier">splitExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a><span>
</span><a name="line-146"></a><a name="splitExpr"><a href="Telomare.Parser.html#splitExpr"><span class="hs-identifier">splitExpr</span></a></a><span> </span><a name="local-6989586621679306508"><a href="#local-6989586621679306508"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679306509"><a href="#local-6989586621679306509"><span class="hs-identifier">bf</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679306510"><a href="#local-6989586621679306510"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State.runState</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#splitExpr%27"><span class="hs-identifier hs-var">splitExpr'</span></a><span> </span><a href="#local-6989586621679306508"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>              </span><span class="hs-keyword">in</span><span> </span><a href="Telomare.html#Term3"><span class="hs-identifier hs-var">Term3</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679306509"><span class="hs-identifier hs-var">bf</span></a><span> </span><a href="#local-6989586621679306510"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-identifier">convertPT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a><span>
</span><a name="line-150"></a><a name="convertPT"><a href="Telomare.Parser.html#convertPT"><span class="hs-identifier">convertPT</span></a></a><span> </span><a name="local-6989586621679306511"><a href="#local-6989586621679306511"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Term3"><span class="hs-identifier hs-var">Term3</span></a><span> </span><a name="local-6989586621679306512"><a href="#local-6989586621679306512"><span class="hs-identifier">termMap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-151"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679306513"><a href="#local-6989586621679306513"><span class="hs-identifier">changeTerm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-152"></a><span>        </span><a href="Telomare.html#AuxF"><span class="hs-identifier hs-var">AuxF</span></a><span> </span><a href="Telomare.html#UnsizedRecursion"><span class="hs-identifier hs-var">UnsizedRecursion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#partialFixF"><span class="hs-identifier hs-var">partialFixF</span></a><span> </span><a href="#local-6989586621679306511"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-153"></a><span>        </span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a><span>
</span><a name="line-154"></a><span>        </span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><a name="local-6989586621679306518"><a href="#local-6989586621679306518"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679306519"><a href="#local-6989586621679306519"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306518"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306519"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-155"></a><span>        </span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a><span>
</span><a name="line-156"></a><span>        </span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a><span> </span><a name="local-6989586621679306520"><a href="#local-6989586621679306520"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306520"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-157"></a><span>        </span><a href="Telomare.html#DeferF"><span class="hs-identifier hs-var">DeferF</span></a><span> </span><a name="local-6989586621679306521"><a href="#local-6989586621679306521"><span class="hs-identifier">fi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.html#DeferF"><span class="hs-identifier hs-var">DeferF</span></a><span> </span><a href="#local-6989586621679306521"><span class="hs-identifier hs-var">fi</span></a><span>
</span><a name="line-158"></a><span>        </span><a href="Telomare.html#AbortF"><span class="hs-identifier hs-var">AbortF</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#AbortF"><span class="hs-identifier hs-var">AbortF</span></a><span>
</span><a name="line-159"></a><span>        </span><a href="Telomare.html#GateF"><span class="hs-identifier hs-var">GateF</span></a><span> </span><a name="local-6989586621679306522"><a href="#local-6989586621679306522"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679306523"><a href="#local-6989586621679306523"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#GateF"><span class="hs-identifier hs-var">GateF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306522"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306523"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-160"></a><span>        </span><a href="Telomare.html#LeftF"><span class="hs-identifier hs-var">LeftF</span></a><span> </span><a name="local-6989586621679306524"><a href="#local-6989586621679306524"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#LeftF"><span class="hs-identifier hs-var">LeftF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306524"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-161"></a><span>        </span><a href="Telomare.html#RightF"><span class="hs-identifier hs-var">RightF</span></a><span> </span><a name="local-6989586621679306525"><a href="#local-6989586621679306525"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#RightF"><span class="hs-identifier hs-var">RightF</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306525"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-162"></a><span>        </span><a href="Telomare.html#TraceF"><span class="hs-identifier hs-var">TraceF</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#TraceF"><span class="hs-identifier hs-var">TraceF</span></a><span>
</span><a name="line-163"></a><span>      </span><a name="local-6989586621679306514"><a href="#local-6989586621679306514"><span class="hs-identifier">mmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="#local-6989586621679306513"><span class="hs-identifier hs-var">changeTerm</span></a><span> </span><a href="#local-6989586621679306512"><span class="hs-identifier hs-var">termMap</span></a><span>
</span><a name="line-164"></a><span>      </span><a name="local-6989586621679306515"><a href="#local-6989586621679306515"><span class="hs-identifier">startKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">succ</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.findMax</span><span> </span><a href="#local-6989586621679306512"><span class="hs-identifier hs-var">termMap</span></a><span>
</span><a name="line-165"></a><span>      </span><a name="local-6989586621679306516"><a href="#local-6989586621679306516"><span class="hs-identifier">newMapBuilder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-166"></a><span>        </span><a name="local-6989586621679306541"><a href="#local-6989586621679306541"><span class="hs-identifier">changedTermMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679306514"><span class="hs-identifier hs-var">mmap</span></a><span>
</span><a name="line-167"></a><span>        </span><span class="hs-identifier hs-var">State.modify</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679306542"><a href="#local-6989586621679306542"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679306543"><a href="#local-6989586621679306543"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306542"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.union</span><span> </span><a href="#local-6989586621679306541"><span class="hs-identifier hs-var">changedTermMap</span></a><span> </span><a href="#local-6989586621679306543"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679306517"><a href="#local-6989586621679306517"><span class="hs-identifier">newMap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State.execState</span><span> </span><a href="#local-6989586621679306516"><span class="hs-identifier hs-var">newMapBuilder</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306515"><span class="hs-identifier hs-var">startKey</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a><span> </span><a href="#local-6989586621679306517"><span class="hs-identifier hs-var">newMap</span></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- |Parse a variable.</span><span>
</span><a name="line-172"></a><span class="hs-identifier">parseVariable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-173"></a><a name="parseVariable"><a href="Telomare.Parser.html#parseVariable"><span class="hs-identifier">parseVariable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-174"></a><span>  </span><a name="local-6989586621679306544"><a href="#local-6989586621679306544"><span class="hs-identifier">varName</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#identifier"><span class="hs-identifier hs-var">identifier</span></a><span>
</span><a name="line-175"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><a href="#local-6989586621679306544"><span class="hs-identifier hs-var">varName</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- |Line comments start with &quot;--&quot;.</span><span>
</span><a name="line-178"></a><span class="hs-identifier">lineComment</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-179"></a><a name="lineComment"><a href="Telomare.Parser.html#lineComment"><span class="hs-identifier">lineComment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.skipLineComment</span><span> </span><span class="hs-string">&quot;--&quot;</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- |A block comment starts with &quot;{-&quot; and ends at &quot;-}&quot;.</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- Nested block comments are also supported.</span><span>
</span><a name="line-183"></a><a name="blockComment"><a href="Telomare.Parser.html#blockComment"><span class="hs-identifier">blockComment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.skipBlockCommentNested</span><span> </span><span class="hs-string">&quot;{-&quot;</span><span> </span><span class="hs-string">&quot;-}&quot;</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- |Space Consumer: Whitespace and comment parser that does not consume new-lines.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">sc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><a name="sc"><a href="Telomare.Parser.html#sc"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.space</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">some</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'\t'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>  </span><a href="Telomare.Parser.html#lineComment"><span class="hs-identifier hs-var">lineComment</span></a><span>
</span><a name="line-190"></a><span>  </span><a href="Telomare.Parser.html#blockComment"><span class="hs-identifier hs-var">blockComment</span></a><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">-- |Space Consumer: Whitespace and comment parser that does consume new-lines.</span><span>
</span><a name="line-193"></a><span class="hs-identifier">scn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><a name="scn"><a href="Telomare.Parser.html#scn"><span class="hs-identifier">scn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.space</span><span> </span><span class="hs-identifier hs-var">space1</span><span> </span><a href="Telomare.Parser.html#lineComment"><span class="hs-identifier hs-var">lineComment</span></a><span> </span><a href="Telomare.Parser.html#blockComment"><span class="hs-identifier hs-var">blockComment</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- |This is a wrapper for lexemes that picks up all trailing white space</span><span>
</span><a name="line-197"></a><span class="hs-comment">-- using sc</span><span>
</span><a name="line-198"></a><span class="hs-identifier">lexeme</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306275"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306275"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-199"></a><a name="lexeme"><a href="Telomare.Parser.html#lexeme"><span class="hs-identifier">lexeme</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.lexeme</span><span> </span><a href="Telomare.Parser.html#sc"><span class="hs-identifier hs-var">sc</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- |A parser that matches given text using string internally and then similarly</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- picks up all trailing white space.</span><span>
</span><a name="line-203"></a><span class="hs-identifier">symbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-204"></a><a name="symbol"><a href="Telomare.Parser.html#symbol"><span class="hs-identifier">symbol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.symbol</span><span> </span><a href="Telomare.Parser.html#sc"><span class="hs-identifier hs-var">sc</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- |This is to parse reserved words.</span><span>
</span><a name="line-207"></a><span class="hs-identifier">reserved</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-208"></a><a name="reserved"><a href="Telomare.Parser.html#reserved"><span class="hs-identifier">reserved</span></a></a><span> </span><a name="local-6989586621679306590"><a href="#local-6989586621679306590"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">try</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><a href="#local-6989586621679306590"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">notFollowedBy</span><span> </span><span class="hs-identifier hs-var">alphaNumChar</span><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-comment">-- |List of reserved words</span><span>
</span><a name="line-211"></a><span class="hs-identifier">rws</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-212"></a><a name="rws"><a href="Telomare.Parser.html#rws"><span class="hs-identifier">rws</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;let&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;in&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;if&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;then&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;else&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- |Variable identifiers can consist of alphanumeric characters, underscore,</span><span>
</span><a name="line-215"></a><span class="hs-comment">-- and must start with an English alphabet letter</span><span>
</span><a name="line-216"></a><span class="hs-identifier">identifier</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-217"></a><a name="identifier"><a href="Telomare.Parser.html#identifier"><span class="hs-identifier">identifier</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">try</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679306954"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="#local-6989586621679306955"><span class="hs-identifier hs-var">check</span></a><span>
</span><a name="line-218"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-219"></a><span>      </span><a name="local-6989586621679306954"><a href="#local-6989586621679306954"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">letterChar</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">many</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">alphaNumChar</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'_'</span><span> </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;variable&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>      </span><a name="local-6989586621679306955"><a href="#local-6989586621679306955"><span class="hs-identifier">check</span></a></a><span> </span><a name="local-6989586621679306956"><a href="#local-6989586621679306956"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679306956"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Telomare.Parser.html#rws"><span class="hs-identifier hs-var">rws</span></a><span>
</span><a name="line-221"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;keyword &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679306956"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; cannot be an identifier&quot;</span><span>
</span><a name="line-222"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679306956"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-comment">-- |Parser for parenthesis.</span><span>
</span><a name="line-225"></a><span class="hs-identifier">parens</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306274"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306274"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-226"></a><a name="parens"><a href="Telomare.Parser.html#parens"><span class="hs-identifier">parens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">between</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-comment">-- |Parser for brackets.</span><span>
</span><a name="line-229"></a><span class="hs-identifier">brackets</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306273"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306273"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-230"></a><a name="brackets"><a href="Telomare.Parser.html#brackets"><span class="hs-identifier">brackets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">between</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;[&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-comment">-- |Comma sepparated TelomareParser that will be useful for lists</span><span>
</span><a name="line-233"></a><span class="hs-identifier">commaSep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306272"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679306272"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-234"></a><a name="commaSep"><a href="Telomare.Parser.html#commaSep"><span class="hs-identifier">commaSep</span></a></a><span> </span><a name="local-6989586621679307005"><a href="#local-6989586621679307005"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679307005"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">sepBy</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-comment">-- |Integer TelomareParser used by `parseNumber` and `parseChurch`</span><span>
</span><a name="line-237"></a><span class="hs-identifier">integer</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-238"></a><a name="integer"><a href="Telomare.Parser.html#integer"><span class="hs-identifier">integer</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a><span> </span><span class="hs-identifier hs-var">L.decimal</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- |Parse string literal.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">parseString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-242"></a><a name="parseString"><a href="Telomare.Parser.html#parseString"><span class="hs-identifier">parseString</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.Parser.html#StringUP"><span class="hs-identifier hs-var">StringUP</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'\&quot;'</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">manyTill</span><span> </span><span class="hs-identifier hs-var">L.charLiteral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'\&quot;'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">-- |Parse number (Integer).</span><span>
</span><a name="line-245"></a><span class="hs-identifier">parseNumber</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-246"></a><a name="parseNumber"><a href="Telomare.Parser.html#parseNumber"><span class="hs-identifier">parseNumber</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#integer"><span class="hs-identifier hs-var">integer</span></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-comment">-- |Parse a pair.</span><span>
</span><a name="line-249"></a><span class="hs-identifier">parsePair</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-250"></a><a name="parsePair"><a href="Telomare.Parser.html#parsePair"><span class="hs-identifier">parsePair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.Parser.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-251"></a><span>  </span><a name="local-6989586621679307006"><a href="#local-6989586621679307006"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-252"></a><span>  </span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-253"></a><span>  </span><a name="local-6989586621679307007"><a href="#local-6989586621679307007"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-254"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a><span> </span><a href="#local-6989586621679307006"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679307007"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-comment">-- |Parse a list.</span><span>
</span><a name="line-257"></a><span class="hs-identifier">parseList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-258"></a><a name="parseList"><a href="Telomare.Parser.html#parseList"><span class="hs-identifier">parseList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-259"></a><span>  </span><a name="local-6989586621679307008"><a href="#local-6989586621679307008"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#commaSep"><span class="hs-identifier hs-var">commaSep</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#ListUP"><span class="hs-identifier hs-var">ListUP</span></a><span> </span><a href="#local-6989586621679307008"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">-- TODO: make error more descriptive</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- |Parse ITE (which stands for &quot;if then else&quot;).</span><span>
</span><a name="line-264"></a><span class="hs-identifier">parseITE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-265"></a><a name="parseITE"><a href="Telomare.Parser.html#parseITE"><span class="hs-identifier">parseITE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-266"></a><span>  </span><a href="Telomare.Parser.html#reserved"><span class="hs-identifier hs-var">reserved</span></a><span> </span><span class="hs-string">&quot;if&quot;</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-267"></a><span>  </span><a name="local-6989586621679307009"><a href="#local-6989586621679307009"><span class="hs-identifier">cond</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><a href="Telomare.Parser.html#parseSingleExpr"><span class="hs-identifier hs-var">parseSingleExpr</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-268"></a><span>  </span><a href="Telomare.Parser.html#reserved"><span class="hs-identifier hs-var">reserved</span></a><span> </span><span class="hs-string">&quot;then&quot;</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-269"></a><span>  </span><a name="local-6989586621679307010"><a href="#local-6989586621679307010"><span class="hs-identifier">thenExpr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><a href="Telomare.Parser.html#parseSingleExpr"><span class="hs-identifier hs-var">parseSingleExpr</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-270"></a><span>  </span><a href="Telomare.Parser.html#reserved"><span class="hs-identifier hs-var">reserved</span></a><span> </span><span class="hs-string">&quot;else&quot;</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-271"></a><span>  </span><a name="local-6989586621679307011"><a href="#local-6989586621679307011"><span class="hs-identifier">elseExpr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-272"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a><span> </span><a href="#local-6989586621679307009"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679307010"><span class="hs-identifier hs-var">thenExpr</span></a><span> </span><a href="#local-6989586621679307011"><span class="hs-identifier hs-var">elseExpr</span></a><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- |Parse a single expression.</span><span>
</span><a name="line-275"></a><span class="hs-identifier">parseSingleExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-276"></a><a name="parseSingleExpr"><a href="Telomare.Parser.html#parseSingleExpr"><span class="hs-identifier">parseSingleExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">choice</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="Telomare.Parser.html#parseString"><span class="hs-identifier hs-var">parseString</span></a><span>
</span><a name="line-277"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseNumber"><span class="hs-identifier hs-var">parseNumber</span></a><span>
</span><a name="line-278"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parsePair"><span class="hs-identifier hs-var">parsePair</span></a><span>
</span><a name="line-279"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseList"><span class="hs-identifier hs-var">parseList</span></a><span>
</span><a name="line-280"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseChurch"><span class="hs-identifier hs-var">parseChurch</span></a><span>
</span><a name="line-281"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseVariable"><span class="hs-identifier hs-var">parseVariable</span></a><span>
</span><a name="line-282"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parsePartialFix"><span class="hs-identifier hs-var">parsePartialFix</span></a><span>
</span><a name="line-283"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>                                   </span><span class="hs-special">]</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-comment">-- |Parse application of functions.</span><span>
</span><a name="line-287"></a><span class="hs-identifier">parseApplied</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-288"></a><a name="parseApplied"><a href="Telomare.Parser.html#parseApplied"><span class="hs-identifier">parseApplied</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-289"></a><span>  </span><a name="local-6989586621679307013"><a href="#local-6989586621679307013"><span class="hs-identifier">fargs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">L.lineFold</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679307012"><a href="#local-6989586621679307012"><span class="hs-identifier">sc'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-290"></a><span>    </span><a href="Telomare.Parser.html#parseSingleExpr"><span class="hs-identifier hs-var">parseSingleExpr</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">sepBy</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="#local-6989586621679307012"><span class="hs-identifier hs-var">sc'</span></a><span>
</span><a name="line-291"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679307013"><span class="hs-identifier hs-var">fargs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-292"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679307014"><a href="#local-6989586621679307014"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679307015"><a href="#local-6989586621679307015"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-293"></a><span>      </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><a href="#local-6989586621679307014"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679307015"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-294"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-string">&quot;expected expression&quot;</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- |Parse lambda expression.</span><span>
</span><a name="line-297"></a><span class="hs-identifier">parseLambda</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-298"></a><a name="parseLambda"><a href="Telomare.Parser.html#parseLambda"><span class="hs-identifier">parseLambda</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-299"></a><span>  </span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;\\&quot;</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-300"></a><span>  </span><a name="local-6989586621679307016"><a href="#local-6989586621679307016"><span class="hs-identifier">variables</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">some</span><span> </span><a href="Telomare.Parser.html#identifier"><span class="hs-identifier hs-var">identifier</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-301"></a><span>  </span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;-&gt;&quot;</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-comment">-- TODO make sure lambda names don't collide with bound names</span><span>
</span><a name="line-303"></a><span>  </span><a name="local-6989586621679307017"><a href="#local-6989586621679307017"><span class="hs-identifier">term1expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-304"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><a href="#local-6989586621679307017"><span class="hs-identifier hs-var">term1expr</span></a><span> </span><a href="#local-6989586621679307016"><span class="hs-identifier hs-var">variables</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">-- |Parser that fails if indent level is not `pos`.</span><span>
</span><a name="line-307"></a><span class="hs-identifier">parseSameLvl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Pos</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306271"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306271"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-308"></a><a name="parseSameLvl"><a href="Telomare.Parser.html#parseSameLvl"><span class="hs-identifier">parseSameLvl</span></a></a><span> </span><a name="local-6989586621679307018"><a href="#local-6989586621679307018"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679307019"><a href="#local-6989586621679307019"><span class="hs-identifier">parser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-309"></a><span>  </span><a name="local-6989586621679307020"><a href="#local-6989586621679307020"><span class="hs-identifier">lvl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">L.indentLevel</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679307018"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679307020"><span class="hs-identifier hs-var">lvl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-311"></a><span>    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679307019"><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-312"></a><span>    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-string">&quot;Expected same indentation.&quot;</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-comment">-- |`applyUntilNoChange f x` returns the fix point of `f` with `x` the starting point.</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- This function will loop if there is no fix point exists.</span><span>
</span><a name="line-316"></a><span class="hs-identifier">applyUntilNoChange</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679306270"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679306270"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306270"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306270"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306270"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-317"></a><a name="applyUntilNoChange"><a href="Telomare.Parser.html#applyUntilNoChange"><span class="hs-identifier">applyUntilNoChange</span></a></a><span> </span><a name="local-6989586621679307021"><a href="#local-6989586621679307021"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679307022"><a href="#local-6989586621679307022"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679307022"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679307021"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679307022"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-318"></a><span>                           </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679307022"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-319"></a><span>                           </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#applyUntilNoChange"><span class="hs-identifier hs-var">applyUntilNoChange</span></a><span> </span><a href="#local-6989586621679307021"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679307021"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679307022"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">-- |Parse let expression.</span><span>
</span><a name="line-322"></a><span class="hs-identifier">parseLet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-323"></a><a name="parseLet"><a href="Telomare.Parser.html#parseLet"><span class="hs-identifier">parseLet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-324"></a><span>  </span><a href="Telomare.Parser.html#reserved"><span class="hs-identifier hs-var">reserved</span></a><span> </span><span class="hs-string">&quot;let&quot;</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-325"></a><span>  </span><a name="local-6989586621679307023"><a href="#local-6989586621679307023"><span class="hs-identifier">lvl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">L.indentLevel</span><span>
</span><a name="line-326"></a><span>  </span><a name="local-6989586621679307024"><a href="#local-6989586621679307024"><span class="hs-identifier">bindingsList</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">manyTill</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#parseSameLvl"><span class="hs-identifier hs-var">parseSameLvl</span></a><span> </span><a href="#local-6989586621679307023"><span class="hs-identifier hs-var">lvl</span></a><span> </span><a href="Telomare.Parser.html#parseAssignment"><span class="hs-identifier hs-var">parseAssignment</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#reserved"><span class="hs-identifier hs-var">reserved</span></a><span> </span><span class="hs-string">&quot;in&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-327"></a><span>  </span><a name="local-6989586621679307025"><a href="#local-6989586621679307025"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-328"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span> </span><a href="#local-6989586621679307024"><span class="hs-identifier hs-var">bindingsList</span></a><span> </span><a href="#local-6989586621679307025"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-comment">-- |Extracting list (bindings) from the wrapping `LetUP` used to keep track of bindings.</span><span>
</span><a name="line-331"></a><span class="hs-identifier">extractBindingsList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-333"></a><a name="extractBindingsList"><a href="Telomare.Parser.html#extractBindingsList"><span class="hs-identifier">extractBindingsList</span></a></a><span> </span><a name="local-6989586621679307026"><a href="#local-6989586621679307026"><span class="hs-identifier">bindings</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679307026"><span class="hs-identifier hs-var">bindings</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-334"></a><span>              </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span> </span><a name="local-6989586621679307027"><a href="#local-6989586621679307027"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679307028"><a href="#local-6989586621679307028"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679307027"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-335"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;`bindings` should be an unapplied LetUP UnprocessedParsedTerm.&quot;</span><span>
</span><a name="line-336"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;Called from `extractBindingsList'`&quot;</span><span>
</span><a name="line-337"></a><span>                                   </span><span class="hs-special">]</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-comment">-- |Parse long expression.</span><span>
</span><a name="line-340"></a><span class="hs-identifier">parseLongExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-341"></a><a name="parseLongExpr"><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier">parseLongExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">choice</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="Telomare.Parser.html#parseLet"><span class="hs-identifier hs-var">parseLet</span></a><span>
</span><a name="line-342"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseITE"><span class="hs-identifier hs-var">parseITE</span></a><span>
</span><a name="line-343"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseLambda"><span class="hs-identifier hs-var">parseLambda</span></a><span>
</span><a name="line-344"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseApplied"><span class="hs-identifier hs-var">parseApplied</span></a><span>
</span><a name="line-345"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#parseSingleExpr"><span class="hs-identifier hs-var">parseSingleExpr</span></a><span>
</span><a name="line-346"></a><span>                                 </span><span class="hs-special">]</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- |Parse church numerals (church numerals are a &quot;$&quot; appended to an integer, without any whitespace separation).</span><span>
</span><a name="line-349"></a><span class="hs-identifier">parseChurch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-350"></a><a name="parseChurch"><a href="Telomare.Parser.html#parseChurch"><span class="hs-identifier">parseChurch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#ChurchUP"><span class="hs-identifier hs-var">ChurchUP</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;$&quot;</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Telomare.Parser.html#integer"><span class="hs-identifier hs-var">integer</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-identifier">parsePartialFix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-353"></a><a name="parsePartialFix"><a href="Telomare.Parser.html#parsePartialFix"><span class="hs-identifier">parsePartialFix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;?&quot;</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- |Parse refinement check.</span><span>
</span><a name="line-356"></a><span class="hs-identifier">parseRefinementCheck</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span>
</span><a name="line-357"></a><a name="parseRefinementCheck"><a href="Telomare.Parser.html#parseRefinementCheck"><span class="hs-identifier">parseRefinementCheck</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-comment">-- |Parse assignment add adding binding to ParserState.</span><span>
</span><a name="line-360"></a><span class="hs-identifier">parseAssignment</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><a name="parseAssignment"><a href="Telomare.Parser.html#parseAssignment"><span class="hs-identifier">parseAssignment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-362"></a><span>  </span><a name="local-6989586621679307029"><a href="#local-6989586621679307029"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#identifier"><span class="hs-identifier hs-var">identifier</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-363"></a><span>  </span><a name="local-6989586621679307030"><a href="#local-6989586621679307030"><span class="hs-identifier">annotation</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">optional</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#parseRefinementCheck"><span class="hs-identifier hs-var">parseRefinementCheck</span></a><span>
</span><a name="line-364"></a><span>  </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Telomare.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a><span> </span><span class="hs-string">&quot;=&quot;</span><span> </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;assignment =&quot;</span><span>
</span><a name="line-365"></a><span>  </span><a name="local-6989586621679307031"><a href="#local-6989586621679307031"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Telomare.Parser.html#parseLongExpr"><span class="hs-identifier hs-var">parseLongExpr</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span>
</span><a name="line-366"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679307029"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679307031"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-comment">-- |Parse top level expressions.</span><span>
</span><a name="line-369"></a><span class="hs-identifier">parseTopLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-370"></a><a name="parseTopLevel"><a href="Telomare.Parser.html#parseTopLevel"><span class="hs-identifier">parseTopLevel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-371"></a><span>  </span><a name="local-6989586621679307032"><a href="#local-6989586621679307032"><span class="hs-identifier">bindingList</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">many</span><span> </span><a href="Telomare.Parser.html#parseAssignment"><span class="hs-identifier hs-var">parseAssignment</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><span class="hs-identifier hs-var">eof</span><span>
</span><a name="line-372"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span> </span><a href="#local-6989586621679307032"><span class="hs-identifier hs-var">bindingList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-string">&quot;main&quot;</span><span> </span><a href="#local-6989586621679307032"><span class="hs-identifier hs-var">bindingList</span></a><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span>
</span><a name="line-374"></a><span class="hs-identifier">parseDefinitions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><a name="parseDefinitions"><a href="Telomare.Parser.html#parseDefinitions"><span class="hs-identifier">parseDefinitions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-376"></a><span>  </span><a name="local-6989586621679307033"><a href="#local-6989586621679307033"><span class="hs-identifier">bindingList</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Telomare.Parser.html#scn"><span class="hs-identifier hs-var">scn</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">many</span><span> </span><a href="Telomare.Parser.html#parseAssignment"><span class="hs-identifier hs-var">parseAssignment</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><span class="hs-identifier hs-var">eof</span><span>
</span><a name="line-377"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span> </span><a href="#local-6989586621679307033"><span class="hs-identifier hs-var">bindingList</span></a><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-comment">-- |Helper function to test parsers without a result.</span><span>
</span><a name="line-380"></a><span class="hs-identifier">runTelomareParser_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679306269"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306269"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-381"></a><a name="runTelomareParser_"><a href="Telomare.Parser.html#runTelomareParser_"><span class="hs-identifier">runTelomareParser_</span></a></a><span> </span><a name="local-6989586621679307034"><a href="#local-6989586621679307034"><span class="hs-identifier">parser</span></a></a><span> </span><a name="local-6989586621679307035"><a href="#local-6989586621679307035"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#runTelomareParser"><span class="hs-identifier hs-var">runTelomareParser</span></a><span> </span><a href="#local-6989586621679307034"><span class="hs-identifier hs-var">parser</span></a><span> </span><a href="#local-6989586621679307035"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">putStrLn</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-comment">-- |Helper function to debug parsers without a result.</span><span>
</span><a name="line-384"></a><span class="hs-identifier">runTelomareParserWDebug</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679306268"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306268"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-385"></a><a name="runTelomareParserWDebug"><a href="Telomare.Parser.html#runTelomareParserWDebug"><span class="hs-identifier">runTelomareParserWDebug</span></a></a><span> </span><a name="local-6989586621679307036"><a href="#local-6989586621679307036"><span class="hs-identifier">parser</span></a></a><span> </span><a name="local-6989586621679307037"><a href="#local-6989586621679307037"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#runTelomareParser"><span class="hs-identifier hs-var">runTelomareParser</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dbg</span><span> </span><span class="hs-string">&quot;debug&quot;</span><span> </span><a href="#local-6989586621679307036"><span class="hs-identifier hs-var">parser</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679307037"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">putStrLn</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">-- |Helper function to test Telomare parsers with any result.</span><span>
</span><a name="line-389"></a><span class="hs-identifier">runTelomareParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679306266"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306267"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306266"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679306267"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-390"></a><a name="runTelomareParser"><a href="Telomare.Parser.html#runTelomareParser"><span class="hs-identifier">runTelomareParser</span></a></a><span> </span><a name="local-6989586621679307038"><a href="#local-6989586621679307038"><span class="hs-identifier">parser</span></a></a><span> </span><a name="local-6989586621679307039"><a href="#local-6989586621679307039"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-391"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">runParser</span><span> </span><a href="#local-6989586621679307038"><span class="hs-identifier hs-var">parser</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679307039"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-392"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679307040"><a href="#local-6989586621679307040"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679307040"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-393"></a><span>    </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679307041"><a href="#local-6989586621679307041"><span class="hs-identifier">e</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">errorBundlePretty</span><span> </span><a href="#local-6989586621679307041"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- |Helper function to test if parser was successful.</span><span>
</span><a name="line-396"></a><span class="hs-identifier">parseSuccessful</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679306264"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Telomare.Parser.html#TelomareParser"><span class="hs-identifier hs-type">TelomareParser</span></a><span> </span><a href="#local-6989586621679306265"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679306264"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-397"></a><a name="parseSuccessful"><a href="Telomare.Parser.html#parseSuccessful"><span class="hs-identifier">parseSuccessful</span></a></a><span> </span><a name="local-6989586621679307042"><a href="#local-6989586621679307042"><span class="hs-identifier">parser</span></a></a><span> </span><a name="local-6989586621679307043"><a href="#local-6989586621679307043"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-398"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">runParser</span><span> </span><a href="#local-6989586621679307042"><span class="hs-identifier hs-var">parser</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679307043"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-399"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-400"></a><span>    </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span class="hs-comment">-- |Parse with specified prelude and g-&gt; UnprocessedParsedTerm)</span><span>
</span><a name="line-403"></a><span class="hs-identifier">parseWithPrelude</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-405"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-406"></a><a name="parseWithPrelude"><a href="Telomare.Parser.html#parseWithPrelude"><span class="hs-identifier">parseWithPrelude</span></a></a><span> </span><a name="local-6989586621679307044"><a href="#local-6989586621679307044"><span class="hs-identifier">prelude</span></a></a><span> </span><a name="local-6989586621679307045"><a href="#local-6989586621679307045"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679307046"><a href="#local-6989586621679307046"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679307044"><span class="hs-identifier hs-var">prelude</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">runParser</span><span> </span><a href="Telomare.Parser.html#parseTopLevel"><span class="hs-identifier hs-var">parseTopLevel</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679307045"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-407"></a><span>                               </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">first</span><span> </span><span class="hs-identifier hs-var">errorBundlePretty</span><span> </span><a href="#local-6989586621679307046"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-identifier">addBuiltins</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-410"></a><a name="addBuiltins"><a href="Telomare.Parser.html#addBuiltins"><span class="hs-identifier">addBuiltins</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span>
</span><a name="line-411"></a><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;zero&quot;</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;left&quot;</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;right&quot;</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;trace&quot;</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;pair&quot;</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;y&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;y&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;app&quot;</span><span class="hs-special">,</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;y&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;y&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">-- |Parse prelude.</span><span>
</span><a name="line-420"></a><span class="hs-identifier">parsePrelude</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Telomare.Parser.html#ErrorString"><span class="hs-identifier hs-type">ErrorString</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><a name="parsePrelude"><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier">parsePrelude</span></a></a><span> </span><a name="local-6989586621679307047"><a href="#local-6989586621679307047"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">runParser</span><span> </span><a href="Telomare.Parser.html#parseDefinitions"><span class="hs-identifier hs-var">parseDefinitions</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679307047"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-422"></a><span>  </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679307048"><a href="#local-6989586621679307048"><span class="hs-identifier">pd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#addBuiltins"><span class="hs-identifier hs-var">addBuiltins</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679307048"><span class="hs-identifier hs-var">pd</span></a><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>  </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679307049"><a href="#local-6989586621679307049"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#MkES"><span class="hs-identifier hs-var">MkES</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">errorBundlePretty</span><span> </span><a href="#local-6989586621679307049"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-comment">-- |Collect all variable names in a `Term1` expresion excluding terms binded</span><span>
</span><a name="line-426"></a><span class="hs-comment">--  to lambda args</span><span>
</span><a name="line-427"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-428"></a><a name="vars"><a href="Telomare.Parser.html#vars"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cata</span><span> </span><a href="#local-6989586621679307050"><span class="hs-identifier hs-var">alg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-429"></a><span>  </span><span class="hs-identifier">alg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Base</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-430"></a><span>  </span><a name="local-6989586621679307050"><a href="#local-6989586621679307050"><span class="hs-identifier">alg</span></a></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TVarF"><span class="hs-identifier hs-var">TVarF</span></a><span> </span><a name="local-6989586621679307052"><a href="#local-6989586621679307052"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><a href="#local-6989586621679307052"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-431"></a><span>  </span><span class="hs-identifier">alg</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a><span> </span><a name="local-6989586621679307053"><a href="#local-6989586621679307053"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679307054"><a href="#local-6989586621679307054"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679307051"><span class="hs-identifier hs-var">del</span></a><span> </span><a href="#local-6989586621679307053"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679307054"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-432"></a><span>  </span><span class="hs-identifier">alg</span><span> </span><span class="hs-special">(</span><a href="Telomare.html#TLamF"><span class="hs-identifier hs-var">TLamF</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a><span> </span><a name="local-6989586621679307055"><a href="#local-6989586621679307055"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679307056"><a href="#local-6989586621679307056"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679307051"><span class="hs-identifier hs-var">del</span></a><span> </span><a href="#local-6989586621679307055"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679307056"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-433"></a><span>  </span><span class="hs-identifier">alg</span><span> </span><a name="local-6989586621679307057"><a href="#local-6989586621679307057"><span class="hs-identifier">e</span></a></a><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">F.fold</span><span> </span><a href="#local-6989586621679307057"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-434"></a><span>  </span><span class="hs-identifier">del</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-435"></a><span>  </span><a name="local-6989586621679307051"><a href="#local-6989586621679307051"><span class="hs-identifier">del</span></a></a><span> </span><a name="local-6989586621679307058"><a href="#local-6989586621679307058"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679307059"><a href="#local-6989586621679307059"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Set.member</span><span> </span><a href="#local-6989586621679307058"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679307059"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-436"></a><span>              </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679307059"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-437"></a><span>              </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679307058"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679307059"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-comment">-- |`makeLambda ps vl t1` makes a `TLam` around `t1` with `vl` as arguments.</span><span>
</span><a name="line-440"></a><span class="hs-comment">-- Automatic recognition of Close or Open type of `TLam`.</span><span>
</span><a name="line-441"></a><span class="hs-identifier">makeLambda</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^Bindings</span><span>
</span><a name="line-442"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                                           </span><span class="hs-comment">-- ^Variable name</span><span>
</span><a name="line-443"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span>                                            </span><span class="hs-comment">-- ^Lambda body</span><span>
</span><a name="line-444"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span>
</span><a name="line-445"></a><a name="makeLambda"><a href="Telomare.Parser.html#makeLambda"><span class="hs-identifier">makeLambda</span></a></a><span> </span><a name="local-6989586621679307060"><a href="#local-6989586621679307060"><span class="hs-identifier">bindings</span></a></a><span> </span><a name="local-6989586621679307061"><a href="#local-6989586621679307061"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621679307062"><a href="#local-6989586621679307062"><span class="hs-identifier">term1</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-446"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679307065"><span class="hs-identifier hs-var">unbound</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-447"></a><span>    </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a><span> </span><a href="#local-6989586621679307061"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679307062"><span class="hs-identifier hs-var">term1</span></a><span>
</span><a name="line-448"></a><span>    </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a><span> </span><a href="#local-6989586621679307061"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679307062"><span class="hs-identifier hs-var">term1</span></a><span>
</span><a name="line-449"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679307063"><a href="#local-6989586621679307063"><span class="hs-identifier">bindings'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Telomare.Parser.html#extractBindingsList"><span class="hs-identifier hs-var">extractBindingsList</span></a><span> </span><a href="#local-6989586621679307060"><span class="hs-identifier hs-var">bindings</span></a><span>
</span><a name="line-450"></a><span>        </span><a name="local-6989586621679307064"><a href="#local-6989586621679307064"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.Parser.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679307062"><span class="hs-identifier hs-var">term1</span></a><span>
</span><a name="line-451"></a><span>        </span><a name="local-6989586621679307065"><a href="#local-6989586621679307065"><span class="hs-identifier">unbound</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679307064"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">\\</span><span> </span><a href="#local-6989586621679307063"><span class="hs-identifier hs-var">bindings'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">\\</span><span> </span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><a href="#local-6989586621679307061"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-identifier">validateVariables</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span>
</span><a name="line-454"></a><a name="validateVariables"><a href="Telomare.Parser.html#validateVariables"><span class="hs-identifier">validateVariables</span></a></a><span> </span><a name="local-6989586621679307066"><a href="#local-6989586621679307066"><span class="hs-identifier">bindings</span></a></a><span> </span><a name="local-6989586621679307067"><a href="#local-6989586621679307067"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-455"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">validateWithEnvironment</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-456"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">State.StateT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span> </span><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a><span>
</span><a name="line-457"></a><span>      </span><a name="local-6989586621679307068"><a href="#local-6989586621679307068"><span class="hs-identifier">validateWithEnvironment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-458"></a><span>        </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><a name="local-6989586621679307069"><a href="#local-6989586621679307069"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679307070"><a href="#local-6989586621679307070"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-459"></a><span>          </span><a name="local-6989586621679307071"><a href="#local-6989586621679307071"><span class="hs-identifier">oldState</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">State.get</span><span>
</span><a name="line-460"></a><span>          </span><span class="hs-identifier hs-var">State.modify</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679307069"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a><span> </span><a href="#local-6989586621679307069"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>          </span><a name="local-6989586621679307072"><a href="#local-6989586621679307072"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307070"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-462"></a><span>          </span><span class="hs-identifier hs-var">State.put</span><span> </span><a href="#local-6989586621679307071"><span class="hs-identifier hs-var">oldState</span></a><span>
</span><a name="line-463"></a><span>          </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#makeLambda"><span class="hs-identifier hs-var">makeLambda</span></a><span> </span><a href="#local-6989586621679307066"><span class="hs-identifier hs-var">bindings</span></a><span> </span><a href="#local-6989586621679307069"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679307072"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-464"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><a name="local-6989586621679307073"><a href="#local-6989586621679307073"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-465"></a><span>          </span><a name="local-6989586621679307074"><a href="#local-6989586621679307074"><span class="hs-identifier">definitionsMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">State.get</span><span>
</span><a name="line-466"></a><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679307073"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679307074"><span class="hs-identifier hs-var">definitionsMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-467"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679307075"><a href="#local-6989586621679307075"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679307075"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-468"></a><span>            </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">State.lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Left</span><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;No definition found for &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679307073"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-469"></a><span>        </span><span class="hs-comment">--TODO add in Daniel's code</span><span>
</span><a name="line-470"></a><span>        </span><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a><span> </span><a name="local-6989586621679307076"><a href="#local-6989586621679307076"><span class="hs-identifier">bindingsMap</span></a></a><span> </span><a name="local-6989586621679307077"><a href="#local-6989586621679307077"><span class="hs-identifier">inner</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-471"></a><span>          </span><a name="local-6989586621679307078"><a href="#local-6989586621679307078"><span class="hs-identifier">oldBindings</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">State.get</span><span>
</span><a name="line-472"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679307079"><a href="#local-6989586621679307079"><span class="hs-identifier">addBinding</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679307080"><a href="#local-6989586621679307080"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><a name="local-6989586621679307081"><a href="#local-6989586621679307081"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-473"></a><span>                </span><a name="local-6989586621679307082"><a href="#local-6989586621679307082"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307081"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-474"></a><span>                </span><span class="hs-identifier hs-var">State.modify</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679307080"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679307082"><span class="hs-identifier hs-var">term</span></a><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>          </span><span class="hs-identifier hs-var">mapM_</span><span> </span><a href="#local-6989586621679307079"><span class="hs-identifier hs-var">addBinding</span></a><span> </span><a href="#local-6989586621679307076"><span class="hs-identifier hs-var">bindingsMap</span></a><span>
</span><a name="line-476"></a><span>          </span><a name="local-6989586621679307083"><a href="#local-6989586621679307083"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307077"><span class="hs-identifier hs-var">inner</span></a><span>
</span><a name="line-477"></a><span>          </span><span class="hs-identifier hs-var">State.put</span><span> </span><a href="#local-6989586621679307078"><span class="hs-identifier hs-var">oldBindings</span></a><span>
</span><a name="line-478"></a><span>          </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679307083"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-479"></a><span>        </span><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a><span> </span><a name="local-6989586621679307084"><a href="#local-6989586621679307084"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679307085"><a href="#local-6989586621679307085"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679307086"><a href="#local-6989586621679307086"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307084"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-480"></a><span>                            </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307085"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-481"></a><span>                            </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307086"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-482"></a><span>        </span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a><span> </span><a name="local-6989586621679307087"><a href="#local-6989586621679307087"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#i2t"><span class="hs-identifier hs-var">i2t</span></a><span> </span><a href="#local-6989586621679307087"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-483"></a><span>        </span><a href="Telomare.Parser.html#StringUP"><span class="hs-identifier hs-var">StringUP</span></a><span> </span><a name="local-6989586621679307088"><a href="#local-6989586621679307088"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#s2t"><span class="hs-identifier hs-var">s2t</span></a><span> </span><a href="#local-6989586621679307088"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-484"></a><span>        </span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a><span> </span><a name="local-6989586621679307089"><a href="#local-6989586621679307089"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679307090"><a href="#local-6989586621679307090"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307089"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-485"></a><span>                            </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307090"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-486"></a><span>        </span><a href="Telomare.Parser.html#ListUP"><span class="hs-identifier hs-var">ListUP</span></a><span> </span><a name="local-6989586621679307091"><a href="#local-6989586621679307091"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a><span> </span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307091"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-487"></a><span>        </span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><a name="local-6989586621679307092"><a href="#local-6989586621679307092"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679307093"><a href="#local-6989586621679307093"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307092"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-488"></a><span>                          </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307093"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-489"></a><span>        </span><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-var">TLimitedRecursion</span></a><span>
</span><a name="line-490"></a><span>        </span><a href="Telomare.Parser.html#ChurchUP"><span class="hs-identifier hs-var">ChurchUP</span></a><span> </span><a name="local-6989586621679307094"><a href="#local-6989586621679307094"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Telomare.Parser.html#i2c"><span class="hs-identifier hs-var">i2c</span></a><span> </span><a href="#local-6989586621679307094"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-491"></a><span>        </span><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a><span> </span><a name="local-6989586621679307095"><a href="#local-6989586621679307095"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307095"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-492"></a><span>        </span><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a><span> </span><a name="local-6989586621679307096"><a href="#local-6989586621679307096"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307096"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-493"></a><span>        </span><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a><span> </span><a name="local-6989586621679307097"><a href="#local-6989586621679307097"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307097"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-494"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">State.evalStateT</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679307068"><span class="hs-identifier hs-var">validateWithEnvironment</span></a><span> </span><a href="#local-6989586621679307067"><span class="hs-identifier hs-var">term</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-identifier">optimizeBuiltinFunctions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span>
</span><a name="line-497"></a><a name="optimizeBuiltinFunctions"><a href="Telomare.Parser.html#optimizeBuiltinFunctions"><span class="hs-identifier">optimizeBuiltinFunctions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679307098"><span class="hs-identifier hs-var">optimize</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-498"></a><span>  </span><a name="local-6989586621679307098"><a href="#local-6989586621679307098"><span class="hs-identifier">optimize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-499"></a><span>    </span><a name="local-6989586621679307099"><a href="#local-6989586621679307099"><span class="hs-identifier">twoApp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><a name="local-6989586621679307100"><a href="#local-6989586621679307100"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679307101"><a href="#local-6989586621679307101"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679307102"><a href="#local-6989586621679307102"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-500"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679307100"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-501"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;pair&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a><span> </span><a href="#local-6989586621679307101"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679307102"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-502"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;app&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><a href="#local-6989586621679307101"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679307102"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-503"></a><span>        </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679307099"><span class="hs-identifier hs-var">twoApp</span></a><span>
</span><a name="line-504"></a><span>    </span><a name="local-6989586621679307103"><a href="#local-6989586621679307103"><span class="hs-identifier">oneApp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><a name="local-6989586621679307104"><a href="#local-6989586621679307104"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679307105"><a href="#local-6989586621679307105"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-505"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679307104"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-506"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;left&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a><span> </span><a href="#local-6989586621679307105"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-507"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;right&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a><span> </span><a href="#local-6989586621679307105"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-508"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;trace&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a><span> </span><a href="#local-6989586621679307105"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-509"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;pair&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;y&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a><span> </span><a href="#local-6989586621679307105"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;y&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>        </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-string">&quot;app&quot;</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a><span> </span><span class="hs-string">&quot;y&quot;</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a><span> </span><a href="#local-6989586621679307105"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;y&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>        </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679307103"><span class="hs-identifier hs-var">oneApp</span></a><span>
</span><a name="line-512"></a><span>        </span><span class="hs-comment">-- VarUP &quot;check&quot; TODO</span><span>
</span><a name="line-513"></a><span>    </span><a name="local-6989586621679307106"><a href="#local-6989586621679307106"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679307106"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-514"></a><span>
</span><a name="line-515"></a><span class="hs-comment">-- |Process an `UnprocessedParesedTerm` to a `Term3` with failing capability.</span><span>
</span><a name="line-516"></a><span class="hs-identifier">process</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a><span>
</span><a name="line-517"></a><a name="process"><a href="Telomare.Parser.html#process"><span class="hs-identifier">process</span></a></a><span> </span><a name="local-6989586621679307107"><a href="#local-6989586621679307107"><span class="hs-identifier">bindings</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Telomare.Parser.html#splitExpr"><span class="hs-identifier hs-var">splitExpr</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Telomare.Parser.html#debruijinize"><span class="hs-identifier hs-var">debruijinize</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Telomare.Parser.html#validateVariables"><span class="hs-identifier hs-var">validateVariables</span></a><span> </span><a href="#local-6989586621679307107"><span class="hs-identifier hs-var">bindings</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Telomare.Parser.html#optimizeBuiltinFunctions"><span class="hs-identifier hs-var">optimizeBuiltinFunctions</span></a><span>
</span><a name="line-518"></a><span>
</span><a name="line-519"></a><span class="hs-comment">-- |Parse main.</span><span>
</span><a name="line-520"></a><span class="hs-identifier">parseMain</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a><span>
</span><a name="line-521"></a><a name="parseMain"><a href="Telomare.Parser.html#parseMain"><span class="hs-identifier">parseMain</span></a></a><span> </span><a name="local-6989586621679307108"><a href="#local-6989586621679307108"><span class="hs-identifier">prelude</span></a></a><span> </span><a name="local-6989586621679307109"><a href="#local-6989586621679307109"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Telomare.Parser.html#parseWithPrelude"><span class="hs-identifier hs-var">parseWithPrelude</span></a><span> </span><a href="#local-6989586621679307108"><span class="hs-identifier hs-var">prelude</span></a><span> </span><a href="#local-6989586621679307109"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Telomare.Parser.html#process"><span class="hs-identifier hs-var">process</span></a><span> </span><a href="#local-6989586621679307108"><span class="hs-identifier hs-var">prelude</span></a><span>
</span><a name="line-522"></a></pre></body></html>