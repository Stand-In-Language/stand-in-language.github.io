<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.RunTime</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Fix</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Foldable</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fold</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Naturals.html"><span class="hs-identifier">Naturals</span></a></span><span>              </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#debug"><span class="hs-identifier">debug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Naturals.html#debugTrace"><span class="hs-identifier">debugTrace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="PrettyPrint.html"><span class="hs-identifier">PrettyPrint</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hPrint</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stderr</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- import qualified Telomare.Llvm as LLVM</span><span>
</span><span id="line-23"></span><span class="hs-comment">--import GHC.Exts (IsList(..))</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="annot"><a href="Telomare.RunTime.html#debug"><span class="hs-identifier hs-type">debug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-26"></span><span id="debug"><span class="annot"><span class="annottext">debug :: Bool
</span><a href="Telomare.RunTime.html#debug"><span class="hs-identifier hs-var hs-var">debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span id="local-6989586621679438055"><span class="annot"><a href="Telomare.RunTime.html#debugTrace"><span class="hs-identifier hs-type">debugTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438055"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-29"></span><span id="debugTrace"><span class="annot"><span class="annottext">debugTrace :: String -&gt; a -&gt; a
</span><a href="Telomare.RunTime.html#debugTrace"><span class="hs-identifier hs-var hs-var">debugTrace</span></a></span></span><span> </span><span id="local-6989586621679438053"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679438053"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679438052"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679438052"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Telomare.RunTime.html#debug"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; a
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679438053"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679438052"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679438052"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- cPlus :: (t3 -&gt; t2 -&gt; t1) -&gt; (t3 -&gt; t -&gt; t2) -&gt; t3 -&gt; t -&gt; t1</span><span>
</span><span id="line-32"></span><span id="local-6989586621679438051"><span class="annot"><a href="Telomare.RunTime.html#cPlus"><span class="hs-identifier hs-type">cPlus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438051"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- cPlus m n f x = m f (n f x)</span><span>
</span><span id="line-34"></span><span id="cPlus"><span class="annot"><span class="annottext">cPlus :: ((a -&gt; a) -&gt; a -&gt; a) -&gt; ((a -&gt; a) -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Telomare.RunTime.html#cPlus"><span class="hs-identifier hs-var hs-var">cPlus</span></a></span></span><span> </span><span id="local-6989586621679438049"><span class="annot"><span class="annottext">m :: (a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679438049"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679438048"><span class="annot"><span class="annottext">n :: (a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679438048"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679438047"><span class="annot"><span class="annottext">f :: a -&gt; a
</span><a href="#local-6989586621679438047"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679438049"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679438047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679438048"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679438047"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Telomare.RunTime.html#nEval"><span class="hs-identifier hs-type">nEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#RunResult"><span class="hs-identifier hs-type">RunResult</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-37"></span><span id="nEval"><span class="annot"><span class="annottext">nEval :: NExprs -&gt; RunResult NExpr
</span><a href="Telomare.RunTime.html#nEval"><span class="hs-identifier hs-var hs-var">nEval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span id="local-6989586621679438043"><span class="annot"><span class="annottext">m :: Map FragIndex NExpr
</span><a href="#local-6989586621679438043"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679438042"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#RunResult"><span class="hs-identifier hs-type">RunResult</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExpr"><span class="hs-identifier hs-type">NExpr</span></a></span><span>
</span><span id="line-39"></span><span>      </span><span id="local-6989586621679438042"><span class="annot"><span class="annottext">eval :: NExpr -&gt; NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438042"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679438041"><span class="annot"><span class="annottext">env :: NExpr
</span><a href="#local-6989586621679438041"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679438040"><span class="annot"><span class="annottext">frag :: NExpr
</span><a href="#local-6989586621679438040"><span class="hs-identifier hs-var">frag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679438039"><span class="annot"><span class="annottext">recur :: NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438042"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438041"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438040"><span class="hs-identifier hs-var">frag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-40"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679438037"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679438037"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679438036"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679438036"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExpr -&gt; NExpr)
-&gt; RunResult NExpr -&gt; ExceptT RunTimeError IO (NExpr -&gt; NExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438037"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT RunTimeError IO (NExpr -&gt; NExpr)
-&gt; RunResult NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438036"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-type">NEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438041"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-42"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NLeft"><span class="hs-identifier hs-type">NLeft</span></a></span><span> </span><span id="local-6989586621679438032"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679438032"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438032"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">RunResult NExpr -&gt; (NExpr -&gt; RunResult NExpr) -&gt; RunResult NExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679438031"><span class="annot"><span class="annottext">y :: NExpr
</span><a href="#local-6989586621679438031"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438031"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-43"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679438030"><span class="annot"><span class="annottext">l :: NExpr
</span><a href="#local-6989586621679438030"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438030"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-44"></span><span>          </span><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-type">NZero</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span><span>
</span><span id="line-45"></span><span>          </span><span id="local-6989586621679438028"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679438028"><span class="hs-identifier hs-var">z</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; RunResult NExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;nleft on &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438028"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; before &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438032"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NRight"><span class="hs-identifier hs-type">NRight</span></a></span><span> </span><span id="local-6989586621679438024"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679438024"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438024"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">RunResult NExpr -&gt; (NExpr -&gt; RunResult NExpr) -&gt; RunResult NExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679438023"><span class="annot"><span class="annottext">y :: NExpr
</span><a href="#local-6989586621679438023"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438023"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-47"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679438022"><span class="annot"><span class="annottext">r :: NExpr
</span><a href="#local-6989586621679438022"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438022"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-48"></span><span>          </span><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-type">NZero</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span><span>
</span><span id="line-49"></span><span>          </span><span id="local-6989586621679438021"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679438021"><span class="hs-identifier hs-var">z</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; RunResult NExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;nright on &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438021"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NDefer"><span class="hs-identifier hs-type">NDefer</span></a></span><span> </span><span id="local-6989586621679438019"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679438019"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex NExpr -&gt; Maybe NExpr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679438019"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679438043"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-51"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679438017"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679438017"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438017"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-52"></span><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; RunResult NExpr
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; RunResult NExpr)
-&gt; RunTimeError -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; RunTimeError
</span><a href="Telomare.html#GenericRunTimeError"><span class="hs-identifier hs-var">GenericRunTimeError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;nEval bad index for function: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679438019"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><a href="Naturals.html#NTrace"><span class="hs-identifier hs-type">NTrace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; RunResult NExpr) -&gt; NExpr -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NExpr -&gt; NExpr
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438041"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438041"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-54"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-type">NSetEnv</span></a></span><span> </span><span id="local-6989586621679438011"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679438011"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438011"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">RunResult NExpr -&gt; (NExpr -&gt; RunResult NExpr) -&gt; RunResult NExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679438010"><span class="annot"><span class="annottext">y :: NExpr
</span><a href="#local-6989586621679438010"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438010"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-55"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679438009"><span class="annot"><span class="annottext">c :: NExpr
</span><a href="#local-6989586621679438009"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679438008"><span class="annot"><span class="annottext">i :: NExpr
</span><a href="#local-6989586621679438008"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438009"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-56"></span><span>            </span><span class="annot"><a href="Naturals.html#NGate"><span class="hs-identifier hs-type">NGate</span></a></span><span> </span><span id="local-6989586621679438006"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679438006"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679438005"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679438005"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438008"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-57"></span><span>              </span><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-type">NZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438006"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-58"></span><span>              </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438005"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-59"></span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438042"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438008"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438009"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-60"></span><span>          </span><span id="local-6989586621679438004"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679438004"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; RunResult NExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;nEval nsetenv - not pair - &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438004"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NApp"><span class="hs-identifier hs-type">NApp</span></a></span><span> </span><span id="local-6989586621679438002"><span class="annot"><span class="annottext">c :: NExpr
</span><a href="#local-6989586621679438002"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679438001"><span class="annot"><span class="annottext">i :: NExpr
</span><a href="#local-6989586621679438001"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-62"></span><span>          </span><span id="local-6989586621679438000"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438000"><span class="hs-identifier hs-var">nc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438002"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-63"></span><span>          </span><span id="local-6989586621679437999"><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437999"><span class="hs-identifier hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438001"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-64"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679437998"><span class="annot"><span class="annottext">appl :: NExpr -&gt; NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679437998"><span class="hs-identifier hs-var hs-var">appl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679437997"><span class="annot"><span class="annottext">c :: NExpr
</span><a href="#local-6989586621679437997"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679437996"><span class="annot"><span class="annottext">e :: NExpr
</span><a href="#local-6989586621679437996"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679437995"><span class="annot"><span class="annottext">i :: NExpr
</span><a href="#local-6989586621679437995"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438042"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437995"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437996"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437997"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-65"></span><span>              </span><span class="annot"><a href="#local-6989586621679437998"><span class="hs-identifier hs-var">appl</span></a></span><span> </span><span id="local-6989586621679437994"><span class="annot"><span class="annottext">y :: NExpr
</span><a href="#local-6989586621679437994"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679437993"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679437993"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RunResult NExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;nEval napp appl no pair &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437994"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; --- &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437993"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438000"><span class="hs-identifier hs-var">nc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-67"></span><span>            </span><span id="local-6989586621679437992"><span class="annot"><span class="annottext">p :: NExpr
</span><a href="#local-6989586621679437992"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679437998"><span class="hs-identifier hs-var">appl</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437992"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437999"><span class="hs-identifier hs-var">ni</span></a></span><span>
</span><span id="line-68"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NLamNum"><span class="hs-identifier hs-type">NLamNum</span></a></span><span> </span><span id="local-6989586621679437990"><span class="annot"><span class="annottext">n :: Int64
</span><a href="#local-6989586621679437990"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679437989"><span class="annot"><span class="annottext">e :: NExpr
</span><a href="#local-6989586621679437989"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; RunResult NExpr) -&gt; NExpr -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437999"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-69"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NLamNum"><span class="hs-identifier hs-type">NLamNum</span></a></span><span> </span><span id="local-6989586621679437988"><span class="annot"><span class="annottext">m :: Int64
</span><a href="#local-6989586621679437988"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; NExpr
</span><a href="Naturals.html#NNum"><span class="hs-identifier hs-var">NNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679437990"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679437988"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437989"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-70"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPartialNum"><span class="hs-identifier hs-type">NPartialNum</span></a></span><span> </span><span id="local-6989586621679437984"><span class="annot"><span class="annottext">m :: Int64
</span><a href="#local-6989586621679437984"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679437983"><span class="annot"><span class="annottext">f :: NExpr
</span><a href="#local-6989586621679437983"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; NExpr
</span><a href="Naturals.html#NNum"><span class="hs-identifier hs-var">NNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679437990"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679437984"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437983"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-71"></span><span>            </span><span class="annot"><a href="Naturals.html#NToNum"><span class="hs-identifier hs-type">NToNum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; RunResult NExpr) -&gt; NExpr -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NApp"><span class="hs-identifier hs-var">NApp</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NToNum"><span class="hs-identifier hs-var">NToNum</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437999"><span class="hs-identifier hs-var">ni</span></a></span><span>
</span><span id="line-72"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NApp"><span class="hs-identifier hs-type">NApp</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NToNum"><span class="hs-identifier hs-type">NToNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-type">NNum</span></a></span><span> </span><span id="local-6989586621679437980"><span class="annot"><span class="annottext">nn :: Int64
</span><a href="#local-6989586621679437980"><span class="hs-identifier hs-var">nn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-type">NEnv</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679437979"><span class="annot"><span class="annottext">nenv :: NExpr
</span><a href="#local-6989586621679437979"><span class="hs-identifier hs-var">nenv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679437978"><span class="annot"><span class="annottext">fStep :: t -&gt; NExpr -&gt; p
</span><a href="#local-6989586621679437978"><span class="hs-identifier hs-var hs-var">fStep</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-74"></span><span>                  </span><span class="annot"><a href="#local-6989586621679437978"><span class="hs-identifier hs-var">fStep</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-type">NZero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-75"></span><span>                  </span><span class="annot"><a href="#local-6989586621679437978"><span class="hs-identifier hs-var">fStep</span></a></span><span> </span><span id="local-6989586621679437977"><span class="annot"><span class="annottext">x :: t
</span><a href="#local-6989586621679437977"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679437976"><span class="annot"><span class="annottext">pr :: NExpr
</span><a href="#local-6989586621679437976"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-type">NZero</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; NExpr -&gt; p
</span><a href="#local-6989586621679437978"><span class="hs-identifier hs-var">fStep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679437977"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437976"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-76"></span><span>                  </span><span class="annot"><a href="#local-6989586621679437978"><span class="hs-identifier hs-var">fStep</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679437974"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679437974"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; p
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;napp ntonum fstep bad pair: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437974"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; RunResult NExpr) -&gt; NExpr -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; NExpr
</span><a href="Naturals.html#NNum"><span class="hs-identifier hs-var">NNum</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; NExpr) -&gt; Int64 -&gt; NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; NExpr -&gt; Int64
forall t p. (Eq t, Num t, Num p) =&gt; t -&gt; NExpr -&gt; p
</span><a href="#local-6989586621679437978"><span class="hs-identifier hs-var">fStep</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679437980"><span class="hs-identifier hs-var">nn</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437999"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437979"><span class="hs-identifier hs-var">nenv</span></a></span><span>
</span><span id="line-78"></span><span>            </span><span id="local-6989586621679437973"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679437973"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; RunResult NExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;nEval napp error - non pair c - &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437973"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &lt;&lt;from&gt;&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679438002"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-type">NOldDefer</span></a></span><span> </span><span id="local-6989586621679437971"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679437971"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437971"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NNum"><span class="hs-identifier hs-type">NNum</span></a></span><span> </span><span id="local-6989586621679437970"><span class="annot"><span class="annottext">x :: Int64
</span><a href="#local-6989586621679437970"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679437969"><span class="annot"><span class="annottext">buildF :: t -&gt; NExpr
</span><a href="#local-6989586621679437969"><span class="hs-identifier hs-var hs-var">buildF</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NLeft"><span class="hs-identifier hs-var">NLeft</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span>
</span><span id="line-81"></span><span>                        </span><span class="annot"><a href="#local-6989586621679437969"><span class="hs-identifier hs-var">buildF</span></a></span><span> </span><span id="local-6989586621679437968"><span class="annot"><span class="annottext">x :: t
</span><a href="#local-6989586621679437968"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NApp"><span class="hs-identifier hs-var">NApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NLeft"><span class="hs-identifier hs-var">NLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr
</span><a href="Naturals.html#NRight"><span class="hs-identifier hs-var">NRight</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NEnv"><span class="hs-identifier hs-var">NEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; NExpr
</span><a href="#local-6989586621679437969"><span class="hs-identifier hs-var">buildF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679437968"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; RunResult NExpr) -&gt; NExpr -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; NExpr
forall t. (Eq t, Num t) =&gt; t -&gt; NExpr
</span><a href="#local-6989586621679437969"><span class="hs-identifier hs-var">buildF</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679437970"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NTwiddle"><span class="hs-identifier hs-type">NTwiddle</span></a></span><span> </span><span id="local-6989586621679437966"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679437966"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438039"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437966"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">RunResult NExpr -&gt; (NExpr -&gt; RunResult NExpr) -&gt; RunResult NExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679437965"><span class="annot"><span class="annottext">nx :: NExpr
</span><a href="#local-6989586621679437965"><span class="hs-identifier hs-var">nx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437965"><span class="hs-identifier hs-var">nx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-84"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679437964"><span class="annot"><span class="annottext">c :: NExpr
</span><a href="#local-6989586621679437964"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679437963"><span class="annot"><span class="annottext">e :: NExpr
</span><a href="#local-6989586621679437963"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679437962"><span class="annot"><span class="annottext">i :: NExpr
</span><a href="#local-6989586621679437962"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; RunResult NExpr) -&gt; NExpr -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437964"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; NExpr
</span><a href="Naturals.html#NPair"><span class="hs-identifier hs-var">NPair</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437963"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>          </span><span id="local-6989586621679437961"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679437961"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; RunResult NExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;neval ntwiddle not pairpair: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437961"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>        </span><span id="local-6989586621679437960"><span class="annot"><span class="annottext">z :: NExpr
</span><a href="#local-6989586621679437960"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; RunResult NExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437960"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex NExpr -&gt; Maybe NExpr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679438043"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679437958"><span class="annot"><span class="annottext">f :: NExpr
</span><a href="#local-6989586621679437958"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; NExpr -&gt; RunResult NExpr
</span><a href="#local-6989586621679438042"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="Naturals.html#NZero"><span class="hs-identifier hs-var">NZero</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437958"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; RunResult NExpr
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; RunResult NExpr)
-&gt; RunTimeError -&gt; RunResult NExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; RunTimeError
</span><a href="Telomare.html#GenericRunTimeError"><span class="hs-identifier hs-var">GenericRunTimeError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;nEval: no root frag&quot;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- |IExpr evaluation with a given enviroment `e`</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- (as in the second element of a closure).</span><span>
</span><span id="line-93"></span><span id="local-6989586621679438101"><span class="annot"><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-type">rEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679438101"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-comment">-- ^ The enviroment.</span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-comment">-- ^ IExpr to be evaluated.</span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438101"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span></span><span>
</span><span id="line-97"></span><span id="rEval"><span class="annot"><span class="annottext">rEval :: IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var hs-var">rEval</span></a></span></span><span> </span><span id="local-6989586621679437956"><span class="annot"><span class="annottext">e :: IExpr
</span><a href="#local-6989586621679437956"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Base IExpr (IExpr, m IExpr) -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall t a. Recursive t =&gt; (Base t (t, a) -&gt; a) -&gt; t -&gt; a
</span><span class="hs-identifier hs-var">para</span></span><span> </span><span class="annot"><span class="annottext">Base IExpr (IExpr, m IExpr) -&gt; m IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
Base IExpr (IExpr, m IExpr) -&gt; m IExpr
</span><a href="#local-6989586621679437954"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679438103"><span class="annot"><a href="#local-6989586621679437954"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679438103"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Base</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679438103"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438103"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span></span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679437954"><span class="annot"><span class="annottext">alg :: Base IExpr (IExpr, m IExpr) -&gt; m IExpr
</span><a href="#local-6989586621679437954"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-type">ZeroF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="Telomare.html#EnvF"><span class="hs-identifier hs-type">EnvF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#DeferF"><span class="hs-identifier hs-type">DeferF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679437949"><span class="annot"><a href="#local-6989586621679437949"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; (IExpr -&gt; IExpr) -&gt; IExpr -&gt; m IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437949"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Telomare.html#TraceF"><span class="hs-identifier hs-type">TraceF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; IExpr
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437956"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437956"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#GateF"><span class="hs-identifier hs-type">GateF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679437945"><span class="annot"><a href="#local-6989586621679437945"><span class="hs-identifier hs-var">ie1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679437944"><span class="annot"><a href="#local-6989586621679437944"><span class="hs-identifier hs-var">ie2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437945"><span class="hs-identifier hs-var">ie1</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437944"><span class="hs-identifier hs-var">ie2</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PairF"><span class="hs-identifier hs-type">PairF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679437941"><span class="annot"><a href="#local-6989586621679437941"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679437940"><span class="annot"><a href="#local-6989586621679437940"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; IExpr) -&gt; m IExpr -&gt; m (IExpr -&gt; IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m IExpr
</span><a href="#local-6989586621679437941"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">m (IExpr -&gt; IExpr) -&gt; m IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m IExpr
</span><a href="#local-6989586621679437940"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PRightF"><span class="hs-identifier hs-type">PRightF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679437937"><span class="annot"><a href="#local-6989586621679437937"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m IExpr
</span><a href="#local-6989586621679437937"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m IExpr -&gt; (IExpr -&gt; m IExpr) -&gt; m IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679437936"><span class="annot"><span class="annottext">r :: IExpr
</span><a href="#local-6989586621679437936"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437936"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PLeftF"><span class="hs-identifier hs-type">PLeftF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679437934"><span class="annot"><a href="#local-6989586621679437934"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m IExpr
</span><a href="#local-6989586621679437934"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m IExpr -&gt; (IExpr -&gt; m IExpr) -&gt; m IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679437933"><span class="annot"><span class="annottext">l :: IExpr
</span><a href="#local-6989586621679437933"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437933"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-type">SetEnvF</span></a></span><span> </span><span id="local-6989586621679437931"><span class="annot"><a href="#local-6989586621679437931"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679437930"><span class="annot"><a href="#local-6989586621679437930"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m IExpr
</span><a href="#local-6989586621679437930"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m IExpr -&gt; (IExpr -&gt; m IExpr) -&gt; m IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679437929"><span class="annot"><span class="annottext">c :: IExpr
</span><a href="#local-6989586621679437929"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679437928"><span class="annot"><span class="annottext">nenv :: IExpr
</span><a href="#local-6989586621679437928"><span class="hs-identifier hs-var">nenv</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; m IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437928"><span class="hs-identifier hs-var">nenv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437929"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679437927"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679437927"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; m IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437956"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437927"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-117"></span><span>      </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679437926"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679437926"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; m IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437956"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437926"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-comment">-- The next case should never actually occur,</span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-comment">-- because it should be caught by `typeCheck`.</span><span>
</span><span id="line-120"></span><span>      </span><span id="local-6989586621679437925"><span class="annot"><span class="annottext">z :: IExpr
</span><a href="#local-6989586621679437925"><span class="hs-identifier hs-var">z</span></a></span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; m IExpr
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; m IExpr) -&gt; RunTimeError -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; RunTimeError
</span><a href="Telomare.html#SetEnvError"><span class="hs-identifier hs-var">SetEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437925"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- |The fix point combinator of this function (of type `IExpr -&gt; IExpr -&gt; m IExpr`) yields a function that</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- evaluates an `IExpr` with a given enviroment (another `IExpr`).</span><span>
</span><span id="line-124"></span><span id="local-6989586621679438093"><span class="annot"><a href="Telomare.RunTime.html#iEval"><span class="hs-identifier hs-type">iEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679438093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span></span><span>
</span><span id="line-125"></span><span id="iEval"><span class="annot"><span class="annottext">iEval :: (IExpr -&gt; IExpr -&gt; m IExpr) -&gt; IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#iEval"><span class="hs-identifier hs-var hs-var">iEval</span></a></span></span><span> </span><span id="local-6989586621679437922"><span class="annot"><span class="annottext">f :: IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437922"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679437921"><span class="annot"><span class="annottext">env :: IExpr
</span><a href="#local-6989586621679437921"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679437920"><span class="annot"><span class="annottext">g :: IExpr
</span><a href="#local-6989586621679437920"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679437919"><span class="annot"><span class="annottext">f' :: IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437922"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437921"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437920"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Telomare.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; IExpr
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437921"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437921"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-comment">-- Abort -&gt; pure Abort</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679437917"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679437917"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437917"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679437916"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679437916"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679437915"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679437915"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; IExpr) -&gt; m IExpr -&gt; m (IExpr -&gt; IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437916"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m (IExpr -&gt; IExpr) -&gt; m IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437915"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679437914"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679437914"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679437913"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679437913"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437914"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437913"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="Telomare.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437921"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679437911"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679437911"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437911"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m IExpr -&gt; (IExpr -&gt; m IExpr) -&gt; m IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((IExpr -&gt; m IExpr) -&gt; m IExpr) -&gt; (IExpr -&gt; m IExpr) -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679437910"><span class="annot"><span class="annottext">cf :: IExpr
</span><a href="#local-6989586621679437910"><span class="hs-identifier hs-var">cf</span></a></span></span><span> </span><span id="local-6989586621679437909"><span class="annot"><span class="annottext">nenv :: IExpr
</span><a href="#local-6989586621679437909"><span class="hs-identifier hs-var">nenv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437910"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-135"></span><span>      </span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679437908"><span class="annot"><span class="annottext">c :: IExpr
</span><a href="#local-6989586621679437908"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437922"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437909"><span class="hs-identifier hs-var">nenv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437908"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-comment">-- do we change env in evaluation of a/b, or leave it same? change seems more consistent, leave more convenient</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679437907"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679437907"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679437906"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679437906"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437909"><span class="hs-identifier hs-var">nenv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437907"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437906"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span id="local-6989586621679437905"><span class="annot"><span class="annottext">z :: IExpr
</span><a href="#local-6989586621679437905"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; m IExpr
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; m IExpr) -&gt; RunTimeError -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; RunTimeError
</span><a href="Telomare.html#SetEnvError"><span class="hs-identifier hs-var">SetEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437905"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-comment">-- This should never actually occur, because it should be caught by typecheck</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679437904"><span class="annot"><span class="annottext">bx :: IExpr
</span><a href="#local-6989586621679437904"><span class="hs-identifier hs-var">bx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; m IExpr
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; m IExpr) -&gt; RunTimeError -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; RunTimeError
</span><a href="Telomare.html#SetEnvError"><span class="hs-identifier hs-var">SetEnvError</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437904"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="hs-comment">-- This should never actually occur, because it should be caught by typecheck</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679437902"><span class="annot"><span class="annottext">g :: IExpr
</span><a href="#local-6989586621679437902"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437902"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">m IExpr -&gt; (IExpr -&gt; m IExpr) -&gt; m IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679437901"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679437901"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437901"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679437899"><span class="annot"><span class="annottext">g :: IExpr
</span><a href="#local-6989586621679437899"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
</span><a href="#local-6989586621679437919"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437899"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">m IExpr -&gt; (IExpr -&gt; m IExpr) -&gt; m IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679437898"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679437898"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437898"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="Telomare.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; IExpr
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437921"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437921"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679437897"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679437897"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679437896"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679437896"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437897"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437896"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679437895"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679437895"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; m IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; m IExpr) -&gt; IExpr -&gt; m IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437895"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Telomare.html#TelomareLike"><span class="hs-identifier hs-type">TelomareLike</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679437891"><span class="annot"><span class="annottext">fromTelomare :: IExpr -&gt; IExpr
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromTelomare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679437888"><span class="annot"><span class="annottext">toTelomare :: IExpr -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var hs-var hs-var hs-var">toTelomare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-156"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Telomare.html#AbstractRunTime"><span class="hs-identifier hs-type">AbstractRunTime</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679437883"><span class="annot"><span class="annottext">eval :: IExpr -&gt; RunResult IExpr
</span><a href="Telomare.html#eval"><span class="hs-identifier hs-var hs-var hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IExpr -&gt; IExpr -&gt; RunResult IExpr)
 -&gt; IExpr -&gt; IExpr -&gt; RunResult IExpr)
-&gt; IExpr -&gt; IExpr -&gt; RunResult IExpr
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; RunResult IExpr)
-&gt; IExpr -&gt; IExpr -&gt; RunResult IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
(IExpr -&gt; IExpr -&gt; m IExpr) -&gt; IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#iEval"><span class="hs-identifier hs-var">iEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">-- eval = rEval Zero</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="resultIndex"><span class="annot"><span class="annottext">resultIndex :: FragIndex
</span><a href="Telomare.RunTime.html#resultIndex"><span class="hs-identifier hs-var hs-var">resultIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FragIndex
</span><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-var">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Telomare.html#TelomareLike"><span class="hs-identifier hs-type">TelomareLike</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679437877"><span class="annot"><span class="annottext">fromTelomare :: IExpr -&gt; NExprs
</span><a href="#local-6989586621679437877"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromTelomare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map FragIndex NExpr -&gt; NExprs
</span><a href="Naturals.html#NExprs"><span class="hs-identifier hs-var">NExprs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex NExpr -&gt; NExprs)
-&gt; (Map FragIndex ExprFrag -&gt; Map FragIndex NExpr)
-&gt; Map FragIndex ExprFrag
-&gt; NExprs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex ExprFrag -&gt; Map FragIndex NExpr
</span><a href="Naturals.html#fragsToNExpr"><span class="hs-identifier hs-var">fragsToNExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map FragIndex ExprFrag -&gt; NExprs)
-&gt; (IExpr -&gt; Map FragIndex ExprFrag) -&gt; IExpr -&gt; NExprs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Map FragIndex ExprFrag
</span><a href="Naturals.html#fragmentExpr"><span class="hs-identifier hs-var">fragmentExpr</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679437874"><span class="annot"><span class="annottext">toTelomare :: NExprs -&gt; Maybe IExpr
</span><a href="#local-6989586621679437874"><span class="hs-identifier hs-var hs-var hs-var hs-var">toTelomare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span id="local-6989586621679437873"><span class="annot"><span class="annottext">m :: Map FragIndex NExpr
</span><a href="#local-6989586621679437873"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679437872"><span class="annot"><span class="annottext">fromNExpr :: NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var hs-var">fromNExpr</span></a></span></span><span> </span><span id="local-6989586621679437871"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679437871"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437871"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-165"></span><span>          </span><span class="annot"><a href="Naturals.html#NZero"><span class="hs-identifier hs-type">NZero</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-166"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NPair"><span class="hs-identifier hs-type">NPair</span></a></span><span> </span><span id="local-6989586621679437870"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679437870"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679437869"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679437869"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe (IExpr -&gt; IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437870"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437869"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><a href="Naturals.html#NEnv"><span class="hs-identifier hs-type">NEnv</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NSetEnv"><span class="hs-identifier hs-type">NSetEnv</span></a></span><span> </span><span id="local-6989586621679437868"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679437868"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437868"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-169"></span><span>          </span><span class="annot"><a href="Naturals.html#NGate"><span class="hs-identifier hs-type">NGate</span></a></span><span> </span><span id="local-6989586621679437867"><span class="annot"><span class="annottext">a :: NExpr
</span><a href="#local-6989586621679437867"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679437866"><span class="annot"><span class="annottext">b :: NExpr
</span><a href="#local-6989586621679437866"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe (IExpr -&gt; IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437867"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-170"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NLeft"><span class="hs-identifier hs-type">NLeft</span></a></span><span> </span><span id="local-6989586621679437865"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679437865"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437865"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NRight"><span class="hs-identifier hs-type">NRight</span></a></span><span> </span><span id="local-6989586621679437864"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679437864"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PRight"><span class="hs-identifier hs-var">PRight</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437864"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-172"></span><span>          </span><span class="annot"><a href="Naturals.html#NTrace"><span class="hs-identifier hs-type">NTrace</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span>
</span><span id="line-173"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NDefer"><span class="hs-identifier hs-type">NDefer</span></a></span><span> </span><span id="local-6989586621679437863"><span class="annot"><span class="annottext">i :: FragIndex
</span><a href="#local-6989586621679437863"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex NExpr -&gt; Maybe NExpr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679437863"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679437873"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NExpr -&gt; (NExpr -&gt; Maybe IExpr) -&gt; Maybe IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe IExpr -&gt; Maybe IExpr)
-&gt; (NExpr -&gt; Maybe IExpr) -&gt; NExpr -&gt; Maybe IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NOldDefer"><span class="hs-identifier hs-type">NOldDefer</span></a></span><span> </span><span id="local-6989586621679437862"><span class="annot"><span class="annottext">x :: NExpr
</span><a href="#local-6989586621679437862"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; Maybe IExpr -&gt; Maybe IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437862"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; Map FragIndex NExpr -&gt; Maybe NExpr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="Telomare.RunTime.html#resultIndex"><span class="hs-identifier hs-var">resultIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679437873"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NExpr -&gt; (NExpr -&gt; Maybe IExpr) -&gt; Maybe IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">NExpr -&gt; Maybe IExpr
</span><a href="#local-6989586621679437872"><span class="hs-identifier hs-var">fromNExpr</span></a></span><span>
</span><span id="line-177"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Telomare.html#AbstractRunTime"><span class="hs-identifier hs-type">AbstractRunTime</span></a></span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679437859"><span class="annot"><span class="annottext">eval :: NExprs -&gt; RunResult NExprs
</span><a href="#local-6989586621679437859"><span class="hs-identifier hs-var hs-var hs-var hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679437858"><span class="annot"><span class="annottext">x :: NExprs
</span><a href="#local-6989586621679437858"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span> </span><span id="local-6989586621679437857"><span class="annot"><span class="annottext">m :: Map FragIndex NExpr
</span><a href="#local-6989586621679437857"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679437856"><span class="annot"><span class="annottext">r :: NExpr
</span><a href="#local-6989586621679437856"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr -&gt; NExprs
</span><a href="Naturals.html#NExprs"><span class="hs-identifier hs-var">NExprs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex NExpr -&gt; NExprs) -&gt; Map FragIndex NExpr -&gt; NExprs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; NExpr -&gt; Map FragIndex NExpr -&gt; Map FragIndex NExpr
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="Telomare.RunTime.html#resultIndex"><span class="hs-identifier hs-var">resultIndex</span></a></span><span> </span><span class="annot"><span class="annottext">NExpr
</span><a href="#local-6989586621679437856"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex NExpr
</span><a href="#local-6989586621679437857"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NExpr -&gt; NExprs) -&gt; RunResult NExpr -&gt; RunResult NExprs
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NExprs -&gt; RunResult NExpr
</span><a href="Telomare.RunTime.html#nEval"><span class="hs-identifier hs-var">nEval</span></a></span><span> </span><span class="annot"><span class="annottext">NExprs
</span><a href="#local-6989586621679437858"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span id="local-6989586621679438079"><span class="annot"><a href="Telomare.RunTime.html#evalAndConvert"><span class="hs-identifier hs-type">evalAndConvert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679438079"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#AbstractRunTime"><span class="hs-identifier hs-type">AbstractRunTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679438079"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438079"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#RunResult"><span class="hs-identifier hs-type">RunResult</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span></span><span>
</span><span id="line-181"></span><span id="evalAndConvert"><span class="annot"><span class="annottext">evalAndConvert :: a -&gt; RunResult IExpr
</span><a href="Telomare.RunTime.html#evalAndConvert"><span class="hs-identifier hs-var hs-var">evalAndConvert</span></a></span></span><span> </span><span id="local-6989586621679437853"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679437853"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679437852"><span class="annot"><span class="annottext">ar :: RunResult a
</span><a href="#local-6989586621679437852"><span class="hs-identifier hs-var hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; RunResult a
forall a. AbstractRunTime a =&gt; a -&gt; RunResult a
</span><a href="Telomare.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679437853"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe IExpr
forall a. TelomareLike a =&gt; a -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var">toTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe IExpr)
-&gt; RunResult a -&gt; ExceptT RunTimeError IO (Maybe IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RunResult a
</span><a href="#local-6989586621679437852"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExceptT RunTimeError IO (Maybe IExpr)
-&gt; (Maybe IExpr -&gt; RunResult IExpr) -&gt; RunResult IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679437851"><span class="annot"><span class="annottext">r :: Maybe IExpr
</span><a href="#local-6989586621679437851"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
</span><a href="#local-6989586621679437851"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679437850"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679437850"><span class="hs-identifier hs-var">ar'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RunResult a
</span><a href="#local-6989586621679437852"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">RunTimeError -&gt; RunResult IExpr
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RunTimeError -&gt; RunResult IExpr)
-&gt; (String -&gt; RunTimeError) -&gt; String -&gt; RunResult IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; RunTimeError
</span><a href="Telomare.html#ResultConversionError"><span class="hs-identifier hs-var">ResultConversionError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; RunResult IExpr) -&gt; String -&gt; RunResult IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679437850"><span class="hs-identifier hs-var">ar'</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679437848"><span class="annot"><span class="annottext">ir :: IExpr
</span><a href="#local-6989586621679437848"><span class="hs-identifier hs-var">ir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; RunResult IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437848"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Telomare.RunTime.html#simpleEval"><span class="hs-identifier hs-type">simpleEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-188"></span><span id="simpleEval"><span class="annot"><span class="annottext">simpleEval :: IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#simpleEval"><span class="hs-identifier hs-var hs-var">simpleEval</span></a></span></span><span> </span><span id="local-6989586621679437846"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679437846"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; RunResult IExpr
forall a. AbstractRunTime a =&gt; a -&gt; RunResult a
</span><a href="Telomare.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437846"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Either RunTimeError IExpr)
-&gt; (Either RunTimeError IExpr -&gt; IO IExpr) -&gt; IO IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679437844"><span class="annot"><span class="annottext">r :: Either RunTimeError IExpr
</span><a href="#local-6989586621679437844"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437844"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679437843"><span class="annot"><span class="annottext">e :: RunTimeError
</span><a href="#local-6989586621679437843"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO IExpr
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunTimeError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError
</span><a href="#local-6989586621679437843"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679437842"><span class="annot"><span class="annottext">i :: IExpr
</span><a href="#local-6989586621679437842"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437842"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Telomare.RunTime.html#fastInterpretEval"><span class="hs-identifier hs-type">fastInterpretEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-193"></span><span id="fastInterpretEval"><span class="annot"><span class="annottext">fastInterpretEval :: IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#fastInterpretEval"><span class="hs-identifier hs-var hs-var">fastInterpretEval</span></a></span></span><span> </span><span id="local-6989586621679437840"><span class="annot"><span class="annottext">e :: IExpr
</span><a href="#local-6989586621679437840"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679437839"><span class="annot"><span class="annottext">traceShow :: NExprs -&gt; NExprs
</span><a href="#local-6989586621679437839"><span class="hs-identifier hs-var hs-var">traceShow</span></a></span></span><span> </span><span id="local-6989586621679437838"><span class="annot"><span class="annottext">x :: NExprs
</span><a href="#local-6989586621679437838"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Telomare.RunTime.html#debug"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; NExprs -&gt; NExprs
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;toNExpr\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NExprs -&gt; String
</span><a href="PrettyPrint.html#showNExprs"><span class="hs-identifier hs-var">showNExprs</span></a></span><span> </span><span class="annot"><span class="annottext">NExprs
</span><a href="#local-6989586621679437838"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NExprs
</span><a href="#local-6989586621679437838"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">NExprs
</span><a href="#local-6989586621679437838"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><a href="#local-6989586621679437836"><span class="hs-identifier hs-type">nExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span id="local-6989586621679437836"><span class="annot"><span class="annottext">nExpr :: NExprs
</span><a href="#local-6989586621679437836"><span class="hs-identifier hs-var hs-var">nExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NExprs -&gt; NExprs
</span><a href="#local-6989586621679437839"><span class="hs-identifier hs-var">traceShow</span></a></span><span> </span><span class="annot"><span class="annottext">(NExprs -&gt; NExprs) -&gt; NExprs -&gt; NExprs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; NExprs
forall a. TelomareLike a =&gt; IExpr -&gt; a
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var">fromTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437840"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679437835"><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437835"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(RunResult IExpr -&gt; IO (Either RunTimeError IExpr))
-&gt; RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NExprs -&gt; RunResult IExpr
forall a. (Show a, AbstractRunTime a) =&gt; a -&gt; RunResult IExpr
</span><a href="Telomare.RunTime.html#evalAndConvert"><span class="hs-identifier hs-var">evalAndConvert</span></a></span><span> </span><span class="annot"><span class="annottext">NExprs
</span><a href="#local-6989586621679437836"><span class="hs-identifier hs-var">nExpr</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437835"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679437834"><span class="annot"><span class="annottext">e :: RunTimeError
</span><a href="#local-6989586621679437834"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO IExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;runtime error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError
</span><a href="#local-6989586621679437834"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679437833"><span class="annot"><span class="annottext">r :: IExpr
</span><a href="#local-6989586621679437833"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437833"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">{- commenting out until fixed
llvmEval :: NExpr -&gt; IO LLVM.RunResult
llvmEval nexpr = do
  let lmod = LLVM.makeModule nexpr
  when debug $ do
    print $ LLVM.DebugModule lmod
    putStrLn . concat . replicate 100 $ &quot;                                                                     \n&quot;
  result &lt;- catch (LLVM.evalJIT LLVM.defaultJITConfig lmod) $ \(e :: SomeException) -&gt; pure . Left $ show e
  case result of
    Left s -&gt; do
      hPrint stderr nexpr
      hPutStrLn stderr $ &quot;failed llvmEval: &quot; ++ s
      fail s
    Right x -&gt; pure x
-}</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Telomare.RunTime.html#optimizedEval"><span class="hs-identifier hs-type">optimizedEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-219"></span><span id="optimizedEval"><span class="annot"><span class="annottext">optimizedEval :: IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#optimizedEval"><span class="hs-identifier hs-var hs-var">optimizedEval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#fastInterpretEval"><span class="hs-identifier hs-var">fastInterpretEval</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Telomare.RunTime.html#pureIEval"><span class="hs-identifier hs-type">pureIEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-222"></span><span id="pureIEval"><span class="annot"><span class="annottext">pureIEval :: IExpr -&gt; Either RunTimeError IExpr
</span><a href="Telomare.RunTime.html#pureIEval"><span class="hs-identifier hs-var hs-var">pureIEval</span></a></span></span><span> </span><span id="local-6989586621679437830"><span class="annot"><span class="annottext">g :: IExpr
</span><a href="#local-6989586621679437830"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Either RunTimeError IExpr) -&gt; Either RunTimeError IExpr
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Either RunTimeError IExpr) -&gt; Either RunTimeError IExpr)
-&gt; (ExceptT RunTimeError Identity IExpr
    -&gt; Identity (Either RunTimeError IExpr))
-&gt; ExceptT RunTimeError Identity IExpr
-&gt; Either RunTimeError IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ExceptT RunTimeError Identity IExpr
-&gt; Identity (Either RunTimeError IExpr)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT RunTimeError Identity IExpr -&gt; Either RunTimeError IExpr)
-&gt; ExceptT RunTimeError Identity IExpr -&gt; Either RunTimeError IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((IExpr -&gt; IExpr -&gt; ExceptT RunTimeError Identity IExpr)
 -&gt; IExpr -&gt; IExpr -&gt; ExceptT RunTimeError Identity IExpr)
-&gt; IExpr -&gt; IExpr -&gt; ExceptT RunTimeError Identity IExpr
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; ExceptT RunTimeError Identity IExpr)
-&gt; IExpr -&gt; IExpr -&gt; ExceptT RunTimeError Identity IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
(IExpr -&gt; IExpr -&gt; m IExpr) -&gt; IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#iEval"><span class="hs-identifier hs-var">iEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437830"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-comment">-- this is the original version</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Telomare.RunTime.html#pureEval"><span class="hs-identifier hs-type">pureEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-225"></span><span id="pureEval"><span class="annot"><span class="annottext">pureEval :: IExpr -&gt; Either RunTimeError IExpr
</span><a href="Telomare.RunTime.html#pureEval"><span class="hs-identifier hs-var hs-var">pureEval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; Either RunTimeError IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span id="local-6989586621679438067"><span id="local-6989586621679438068"><span class="annot"><a href="Telomare.RunTime.html#showPass"><span class="hs-identifier hs-type">showPass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679438068"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679438067"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438067"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679438068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679438067"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679438068"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-228"></span><span id="showPass"><span class="annot"><span class="annottext">showPass :: m a -&gt; m a
</span><a href="Telomare.RunTime.html#showPass"><span class="hs-identifier hs-var hs-var">showPass</span></a></span></span><span> </span><span id="local-6989586621679437826"><span class="annot"><span class="annottext">a :: m a
</span><a href="#local-6989586621679437826"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679437826"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m a -&gt; (a -&gt; m ()) -&gt; m ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; (a -&gt; IO ()) -&gt; a -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m () -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679437826"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Telomare.RunTime.html#tEval"><span class="hs-identifier hs-type">tEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-231"></span><span id="tEval"><span class="annot"><span class="annottext">tEval :: IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#tEval"><span class="hs-identifier hs-var hs-var">tEval</span></a></span></span><span> </span><span id="local-6989586621679437823"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679437823"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((IExpr -&gt; IExpr -&gt; RunResult IExpr)
 -&gt; IExpr -&gt; IExpr -&gt; RunResult IExpr)
-&gt; IExpr -&gt; IExpr -&gt; RunResult IExpr
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679437822"><span class="annot"><span class="annottext">f :: IExpr -&gt; IExpr -&gt; RunResult IExpr
</span><a href="#local-6989586621679437822"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679437821"><span class="annot"><span class="annottext">e :: IExpr
</span><a href="#local-6989586621679437821"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679437820"><span class="annot"><span class="annottext">g :: IExpr
</span><a href="#local-6989586621679437820"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunResult IExpr -&gt; RunResult IExpr
forall a (m :: * -&gt; *). (Show a, MonadIO m) =&gt; m a -&gt; m a
</span><a href="Telomare.RunTime.html#showPass"><span class="hs-identifier hs-var">showPass</span></a></span><span> </span><span class="annot"><span class="annottext">(RunResult IExpr -&gt; RunResult IExpr)
-&gt; RunResult IExpr -&gt; RunResult IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; RunResult IExpr)
-&gt; IExpr -&gt; IExpr -&gt; RunResult IExpr
forall (m :: * -&gt; *).
MonadError RunTimeError m =&gt;
(IExpr -&gt; IExpr -&gt; m IExpr) -&gt; IExpr -&gt; IExpr -&gt; m IExpr
</span><a href="Telomare.RunTime.html#iEval"><span class="hs-identifier hs-var">iEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; RunResult IExpr
</span><a href="#local-6989586621679437822"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437821"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437820"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437823"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Either RunTimeError IExpr)
-&gt; (Either RunTimeError IExpr -&gt; IO IExpr) -&gt; IO IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679437819"><span class="annot"><span class="annottext">r :: Either RunTimeError IExpr
</span><a href="#local-6989586621679437819"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437819"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679437818"><span class="annot"><span class="annottext">e :: RunTimeError
</span><a href="#local-6989586621679437818"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO IExpr
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunTimeError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RunTimeError
</span><a href="#local-6989586621679437818"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679437817"><span class="annot"><span class="annottext">i :: IExpr
</span><a href="#local-6989586621679437817"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437817"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Telomare.RunTime.html#typedEval"><span class="hs-identifier hs-type">typedEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span id="typedEval"><span class="annot"><span class="annottext">typedEval :: (IExpr -&gt; DataType -&gt; Bool) -&gt; IExpr -&gt; (IExpr -&gt; IO ()) -&gt; IO ()
</span><a href="Telomare.RunTime.html#typedEval"><span class="hs-identifier hs-var hs-var">typedEval</span></a></span></span><span> </span><span id="local-6989586621679437815"><span class="annot"><span class="annottext">typeCheck :: IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437815"><span class="hs-identifier hs-var">typeCheck</span></a></span></span><span> </span><span id="local-6989586621679437814"><span class="annot"><span class="annottext">iexpr :: IExpr
</span><a href="#local-6989586621679437814"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span id="local-6989586621679437813"><span class="annot"><span class="annottext">prettyPrint :: IExpr -&gt; IO ()
</span><a href="#local-6989586621679437813"><span class="hs-identifier hs-var">prettyPrint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437815"><span class="hs-identifier hs-var">typeCheck</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437814"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">DataType
</span><a href="Telomare.html#ZeroType"><span class="hs-identifier hs-var">ZeroType</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#simpleEval"><span class="hs-identifier hs-var">simpleEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437814"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">IO IExpr -&gt; (IExpr -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO ()
</span><a href="#local-6989586621679437813"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;failed typecheck&quot;</span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><a href="Telomare.RunTime.html#debugEval"><span class="hs-identifier hs-type">debugEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span id="debugEval"><span class="annot"><span class="annottext">debugEval :: (IExpr -&gt; DataType -&gt; Bool) -&gt; IExpr -&gt; IO ()
</span><a href="Telomare.RunTime.html#debugEval"><span class="hs-identifier hs-var hs-var">debugEval</span></a></span></span><span> </span><span id="local-6989586621679437809"><span class="annot"><span class="annottext">typeCheck :: IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437809"><span class="hs-identifier hs-var">typeCheck</span></a></span></span><span> </span><span id="local-6989586621679437808"><span class="annot"><span class="annottext">iexpr :: IExpr
</span><a href="#local-6989586621679437808"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437809"><span class="hs-identifier hs-var">typeCheck</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437808"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">DataType
</span><a href="Telomare.html#ZeroType"><span class="hs-identifier hs-var">ZeroType</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#tEval"><span class="hs-identifier hs-var">tEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437808"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">IO IExpr -&gt; (IExpr -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyIExpr -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(PrettyIExpr -&gt; IO ()) -&gt; (IExpr -&gt; PrettyIExpr) -&gt; IExpr -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; PrettyIExpr
</span><a href="Telomare.html#PrettyIExpr"><span class="hs-identifier hs-var">PrettyIExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;failed typecheck&quot;</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="fullEval"><span class="annot"><span class="annottext">fullEval :: (IExpr -&gt; DataType -&gt; Bool) -&gt; IExpr -&gt; IO ()
</span><a href="Telomare.RunTime.html#fullEval"><span class="hs-identifier hs-var hs-var">fullEval</span></a></span></span><span> </span><span id="local-6989586621679437805"><span class="annot"><span class="annottext">typeCheck :: IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437805"><span class="hs-identifier hs-var">typeCheck</span></a></span></span><span> </span><span id="local-6989586621679437804"><span class="annot"><span class="annottext">i :: IExpr
</span><a href="#local-6989586621679437804"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; DataType -&gt; Bool) -&gt; IExpr -&gt; (IExpr -&gt; IO ()) -&gt; IO ()
</span><a href="Telomare.RunTime.html#typedEval"><span class="hs-identifier hs-var">typedEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437805"><span class="hs-identifier hs-var">typeCheck</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437804"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span id="prettyEval"><span class="annot"><span class="annottext">prettyEval :: (IExpr -&gt; DataType -&gt; Bool) -&gt; IExpr -&gt; IO ()
</span><a href="Telomare.RunTime.html#prettyEval"><span class="hs-identifier hs-var hs-var">prettyEval</span></a></span></span><span> </span><span id="local-6989586621679437802"><span class="annot"><span class="annottext">typeCheck :: IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437802"><span class="hs-identifier hs-var">typeCheck</span></a></span></span><span> </span><span id="local-6989586621679437801"><span class="annot"><span class="annottext">i :: IExpr
</span><a href="#local-6989586621679437801"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; DataType -&gt; Bool) -&gt; IExpr -&gt; (IExpr -&gt; IO ()) -&gt; IO ()
</span><a href="Telomare.RunTime.html#typedEval"><span class="hs-identifier hs-var">typedEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; DataType -&gt; Bool
</span><a href="#local-6989586621679437802"><span class="hs-identifier hs-var">typeCheck</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437801"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyIExpr -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(PrettyIExpr -&gt; IO ()) -&gt; (IExpr -&gt; PrettyIExpr) -&gt; IExpr -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; PrettyIExpr
</span><a href="Telomare.html#PrettyIExpr"><span class="hs-identifier hs-var">PrettyIExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Telomare.RunTime.html#verifyEval"><span class="hs-identifier hs-type">verifyEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span id="verifyEval"><span class="annot"><span class="annottext">verifyEval :: IExpr
-&gt; IO
     (Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr))
</span><a href="Telomare.RunTime.html#verifyEval"><span class="hs-identifier hs-var hs-var">verifyEval</span></a></span></span><span> </span><span id="local-6989586621679437799"><span class="annot"><span class="annottext">expr :: IExpr
</span><a href="#local-6989586621679437799"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679437798"><span class="hs-identifier hs-type">nexpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span id="local-6989586621679437798"><span class="annot"><span class="annottext">nexpr :: NExprs
</span><a href="#local-6989586621679437798"><span class="hs-identifier hs-var hs-var">nexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; NExprs
forall a. TelomareLike a =&gt; IExpr -&gt; a
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var">fromTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437799"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679437797"><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437797"><span class="hs-identifier hs-var">iResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(RunResult IExpr -&gt; IO (Either RunTimeError IExpr))
-&gt; RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; RunResult IExpr
forall a. (Show a, AbstractRunTime a) =&gt; a -&gt; RunResult IExpr
</span><a href="Telomare.RunTime.html#evalAndConvert"><span class="hs-identifier hs-var">evalAndConvert</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679437799"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679437796"><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437796"><span class="hs-identifier hs-var">nResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(RunResult IExpr -&gt; IO (Either RunTimeError IExpr))
-&gt; RunResult IExpr -&gt; IO (Either RunTimeError IExpr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NExprs -&gt; RunResult IExpr
forall a. (Show a, AbstractRunTime a) =&gt; a -&gt; RunResult IExpr
</span><a href="Telomare.RunTime.html#evalAndConvert"><span class="hs-identifier hs-var">evalAndConvert</span></a></span><span> </span><span class="annot"><span class="annottext">NExprs
</span><a href="#local-6989586621679437798"><span class="hs-identifier hs-var">nexpr</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437797"><span class="hs-identifier hs-var">iResult</span></a></span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr -&gt; Either RunTimeError IExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437796"><span class="hs-identifier hs-var">nResult</span></a></span><span>
</span><span id="line-257"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr)
-&gt; IO
     (Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-258"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr)
-&gt; IO
     (Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr)
 -&gt; IO
      (Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr)))
-&gt; Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr)
-&gt; IO
     (Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Either RunTimeError IExpr, Either RunTimeError IExpr)
-&gt; Maybe (Either RunTimeError IExpr, Either RunTimeError IExpr)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437797"><span class="hs-identifier hs-var">iResult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr
</span><a href="#local-6989586621679437796"><span class="hs-identifier hs-var">nResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="testNEval"><span class="annot"><span class="annottext">testNEval :: IExpr -&gt; IO (Either RunTimeError NExprs)
</span><a href="Telomare.RunTime.html#testNEval"><span class="hs-identifier hs-var hs-var">testNEval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunResult NExprs -&gt; IO (Either RunTimeError NExprs)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(RunResult NExprs -&gt; IO (Either RunTimeError NExprs))
-&gt; (IExpr -&gt; RunResult NExprs)
-&gt; IExpr
-&gt; IO (Either RunTimeError NExprs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NExprs -&gt; RunResult NExprs
forall a. AbstractRunTime a =&gt; a -&gt; RunResult a
</span><a href="Telomare.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">(NExprs -&gt; RunResult NExprs)
-&gt; (IExpr -&gt; NExprs) -&gt; IExpr -&gt; RunResult NExprs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; NExprs
forall a. TelomareLike a =&gt; IExpr -&gt; a
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var">fromTelomare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Naturals.html#NExprs"><span class="hs-identifier hs-type">NExprs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span></pre></body></html>