<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.Decompiler</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Control.Monad.html#foldM"><span class="hs-identifier">foldM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#liftM2"><span class="hs-identifier">liftM2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.html"><span class="hs-identifier">Control.Monad.State</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.OldList.html#intercalate"><span class="hs-identifier">intercalate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Semigroup.html"><span class="hs-identifier">Data.Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Semigroup.html#Max"><span class="hs-identifier">Max</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExpr"><span class="hs-identifier">FragExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier">FragIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier">IExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#LamType"><span class="hs-identifier">LamType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>                 </span><span class="annot"><a href="Telomare.html#ParserTerm"><span class="hs-identifier">ParserTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier">Term1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier">Term2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier">Term3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier">Term3</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier">Term4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier">Term4</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>                 </span><span class="annot"><a href="Telomare.html#buildFragMap"><span class="hs-identifier">buildFragMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#deferF"><span class="hs-identifier">deferF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#rootFrag"><span class="hs-identifier">rootFrag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#unFragExprUR"><span class="hs-identifier">unFragExprUR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Parser.html"><span class="hs-identifier">Telomare.Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileUPT"><span class="hs-identifier hs-type">decompileUPT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-16"></span><span id="decompileUPT"><span class="annot"><span class="annottext">decompileUPT :: UnprocessedParsedTerm -&gt; String
</span><a href="Telomare.Decompiler.html#decompileUPT"><span class="hs-identifier hs-var hs-var">decompileUPT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388675"><span class="annot"><span class="annottext">lineLimit :: Integer
</span><a href="#local-6989586621679388675"><span class="hs-identifier hs-var hs-var">lineLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">120</span></span><span>
</span><span id="line-18"></span><span>      </span><span class="hs-comment">-- &quot;hello&quot;</span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><a href="#local-6989586621679388674"><span class="hs-identifier hs-type">showS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State.State</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-20"></span><span>      </span><span id="local-6989586621679388674"><span class="annot"><span class="annottext">showS :: String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var hs-var">showS</span></a></span></span><span> </span><span id="local-6989586621679388673"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388673"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388671"><span class="annot"><span class="annottext">indent :: Int
</span><a href="#local-6989586621679388671"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388673"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">State.modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388671"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388673"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-21"></span><span>      </span><span id="local-6989586621679388664"><span class="annot"><span class="annottext">drawIndent :: State Int String
</span><a href="#local-6989586621679388664"><span class="hs-identifier hs-var hs-var">drawIndent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">State.get</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679388662"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388662"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388662"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>      </span><span id="local-6989586621679388656"><span class="annot"><span class="annottext">drawList :: [State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var hs-var">drawList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span>
</span><span id="line-23"></span><span>      </span><span id="local-6989586621679388653"><span class="annot"><span class="annottext">needsParens :: UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679388653"><span class="hs-identifier hs-var hs-var">needsParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-comment">-- will need parens if on right side of application</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-type">AppUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-type">LeftUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-type">RightUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-type">TraceUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-32"></span><span>      </span><span id="local-6989586621679388645"><span class="annot"><span class="annottext">needsFirstParens :: UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679388645"><span class="hs-identifier hs-var hs-var">needsFirstParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-37"></span><span>      </span><span id="local-6989586621679388644"><span class="annot"><span class="annottext">drawParens :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388644"><span class="hs-identifier hs-var hs-var">drawParens</span></a></span></span><span> </span><span id="local-6989586621679388643"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388643"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679388653"><span class="hs-identifier hs-var">needsParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388643"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-38"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388643"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-39"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388643"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-40"></span><span>      </span><span id="local-6989586621679388641"><span class="annot"><span class="annottext">drawFirstParens :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388641"><span class="hs-identifier hs-var hs-var">drawFirstParens</span></a></span></span><span> </span><span id="local-6989586621679388640"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388640"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679388645"><span class="hs-identifier hs-var">needsFirstParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388640"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-41"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388640"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-42"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388640"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-43"></span><span>      </span><span class="annot"><a href="#local-6989586621679388642"><span class="hs-identifier hs-type">draw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State.State</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-44"></span><span>      </span><span id="local-6989586621679388642"><span class="annot"><span class="annottext">draw :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var hs-var">draw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-45"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-type">VarUP</span></a></span><span> </span><span id="local-6989586621679388638"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388638"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388638"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-46"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span id="local-6989586621679388637"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388637"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679388636"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388636"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679388635"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388635"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388637"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; then &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388636"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; else &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388635"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679388634"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388634"><span class="hs-identifier hs-var">firstName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679388633"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388633"><span class="hs-identifier hs-var">firstDef</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679388632"><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679388632"><span class="hs-identifier hs-var">bindingsXS</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388631"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388631"><span class="hs-identifier hs-var">in_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679388632"><span class="hs-identifier hs-var">bindingsXS</span></a></span><span>
</span><span id="line-48"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388634"><span class="hs-identifier hs-var">firstName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388633"><span class="hs-identifier hs-var">firstDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388631"><span class="hs-identifier hs-var">in_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-49"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-50"></span><span>            </span><span id="local-6989586621679388629"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388629"><span class="hs-identifier hs-var">startIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">State.get</span></a></span><span>
</span><span id="line-51"></span><span>            </span><span id="local-6989586621679388628"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388628"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let &quot;</span></span><span>
</span><span id="line-52"></span><span>            </span><span id="local-6989586621679388627"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388627"><span class="hs-identifier hs-var">startBind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">State.get</span></a></span><span>
</span><span id="line-53"></span><span>            </span><span id="local-6989586621679388626"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388626"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388634"><span class="hs-identifier hs-var">firstName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388633"><span class="hs-identifier hs-var">firstDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-54"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388620"><span class="annot"><span class="annottext">drawOne :: (String, UnprocessedParsedTerm) -&gt; State Int String
</span><a href="#local-6989586621679388620"><span class="hs-identifier hs-var hs-var">drawOne</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388619"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388619"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679388618"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388618"><span class="hs-identifier hs-var">upt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>                  </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">State.put</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388627"><span class="hs-identifier hs-var">startBind</span></a></span><span>
</span><span id="line-56"></span><span>                  </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679388664"><span class="hs-identifier hs-var">drawIndent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388619"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388618"><span class="hs-identifier hs-var">upt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>            </span><span id="local-6989586621679388616"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388616"><span class="hs-identifier hs-var">displayedBindings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">(String, UnprocessedParsedTerm) -&gt; State Int String
</span><a href="#local-6989586621679388620"><span class="hs-identifier hs-var">drawOne</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679388632"><span class="hs-identifier hs-var">bindingsXS</span></a></span><span>
</span><span id="line-58"></span><span>            </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">State.put</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388629"><span class="hs-identifier hs-var">startIn</span></a></span><span>
</span><span id="line-59"></span><span>            </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388628"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388626"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388616"><span class="hs-identifier hs-var">displayedBindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679388664"><span class="hs-identifier hs-var">drawIndent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388631"><span class="hs-identifier hs-var">in_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#ListUP"><span class="hs-identifier hs-type">ListUP</span></a></span><span> </span><span id="local-6989586621679388612"><span class="annot"><span class="annottext">[UnprocessedParsedTerm]
</span><a href="#local-6989586621679388612"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388611"><span class="annot"><span class="annottext">insertCommas :: [State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679388611"><span class="hs-identifier hs-var hs-var">insertCommas</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>                          </span><span class="annot"><a href="#local-6989586621679388611"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679388610"><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679388610"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679388610"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>                          </span><span class="annot"><a href="#local-6989586621679388611"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388609"><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679388609"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679388608"><span class="annot"><span class="annottext">[State Int String]
</span><a href="#local-6989586621679388608"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679388609"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679388611"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="annot"><span class="annottext">[State Int String]
</span><a href="#local-6989586621679388608"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-63"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679388611"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">[UnprocessedParsedTerm]
</span><a href="#local-6989586621679388612"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-type">IntUP</span></a></span><span> </span><span id="local-6989586621679388605"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388605"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388605"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-65"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#StringUP"><span class="hs-identifier hs-type">StringUP</span></a></span><span> </span><span id="local-6989586621679388602"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388602"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388602"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-type">PairUP</span></a></span><span> </span><span id="local-6989586621679388600"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388600"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679388599"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388599"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388600"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388599"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-type">AppUP</span></a></span><span> </span><span id="local-6989586621679388598"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388598"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679388597"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388597"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388641"><span class="hs-identifier hs-var">drawFirstParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388598"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388644"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388597"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span>          </span><span class="hs-comment">-- TODO flatten nested lambdas</span><span>
</span><span id="line-69"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span id="local-6989586621679388596"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388596"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679388595"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388595"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388596"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388595"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#ChurchUP"><span class="hs-identifier hs-type">ChurchUP</span></a></span><span> </span><span id="local-6989586621679388593"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388593"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388593"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-type">UnsizedRecursionUP</span></a></span><span> </span><span id="local-6989586621679388591"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388591"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679388590"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388590"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679388589"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388589"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388591"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388590"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388589"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-type">LeftUP</span></a></span><span> </span><span id="local-6989586621679388588"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388588"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;left &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388644"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388588"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-type">RightUP</span></a></span><span> </span><span id="local-6989586621679388587"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388587"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;right &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388644"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388587"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-type">TraceUP</span></a></span><span> </span><span id="local-6989586621679388586"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388586"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;trace &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388644"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388586"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#CheckUP"><span class="hs-identifier hs-type">CheckUP</span></a></span><span> </span><span id="local-6989586621679388584"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388584"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679388583"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388583"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388583"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679388674"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; : &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388584"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679388582"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388582"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#evalState"><span class="hs-identifier hs-var">State.evalState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679388642"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679388582"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">{-
      safeTail s = if null s then [] else tail s
      showMem s = do
        let indent = length . last . takeWhile (not . null) . iterate (safeTail . dropWhile (/= '\n')) $ s
        if elem '\n' s
          then State.put indent
          else State.modify (+ indent)
        pure s
      draw oneLine =
        let showTwo a b = undefined --let long =
            showLine l = do
              indent &lt;- State.get
              let long = intercalate &quot; &quot; l
                         in if length long &gt; lineLimit
                            then

-}</span><span>
</span><span id="line-95"></span><span>              </span><span class="hs-comment">{-m
          drawLineOr x y = if not oneLine &amp;&amp; draw
-}</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-type">decompileTerm1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-100"></span><span id="decompileTerm1"><span class="annot"><span class="annottext">decompileTerm1 :: Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var hs-var">decompileTerm1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">Term1
</span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Telomare.html#TPair"><span class="hs-identifier hs-type">TPair</span></a></span><span> </span><span id="local-6989586621679388577"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388577"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679388576"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388576"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388577"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388576"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Telomare.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span id="local-6989586621679388574"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388574"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388574"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Telomare.html#TApp"><span class="hs-identifier hs-type">TApp</span></a></span><span> </span><span id="local-6989586621679388572"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388572"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679388571"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388571"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388572"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388571"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Telomare.html#TCheck"><span class="hs-identifier hs-type">TCheck</span></a></span><span> </span><span id="local-6989586621679388569"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388569"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679388568"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388568"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#CheckUP"><span class="hs-identifier hs-var">CheckUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388569"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388568"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Telomare.html#TITE"><span class="hs-identifier hs-type">TITE</span></a></span><span> </span><span id="local-6989586621679388566"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388566"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679388565"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388565"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679388564"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388564"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388566"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388565"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388564"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Telomare.html#TLeft"><span class="hs-identifier hs-type">TLeft</span></a></span><span> </span><span id="local-6989586621679388562"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388562"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388562"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Telomare.html#TRight"><span class="hs-identifier hs-type">TRight</span></a></span><span> </span><span id="local-6989586621679388560"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388560"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388560"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Telomare.html#TTrace"><span class="hs-identifier hs-type">TTrace</span></a></span><span> </span><span id="local-6989586621679388558"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388558"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388558"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span id="local-6989586621679388555"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388555"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388554"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388554"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388555"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388554"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span id="local-6989586621679388552"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388552"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388551"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388551"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388552"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388551"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- not strictly equivalent</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-type">TLimitedRecursion</span></a></span><span> </span><span id="local-6989586621679388549"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388549"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679388548"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388548"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679388547"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388547"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388549"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388548"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388547"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm2"><span class="hs-identifier hs-type">decompileTerm2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a></span><span>
</span><span id="line-115"></span><span id="decompileTerm2"><span class="annot"><span class="annottext">decompileTerm2 :: Term2 -&gt; Term1
</span><a href="Telomare.Decompiler.html#decompileTerm2"><span class="hs-identifier hs-var hs-var">decompileTerm2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388539"><span class="annot"><span class="annottext">nameSupply :: [String]
</span><a href="#local-6989586621679388539"><span class="hs-identifier hs-var hs-var">nameSupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388538"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388537"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679388538"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388538"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679388539"><span class="hs-identifier hs-var">nameSupply</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679388537"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388537"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679388539"><span class="hs-identifier hs-var">nameSupply</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621679388533"><span class="annot"><span class="annottext">getName :: Int -&gt; String
</span><a href="#local-6989586621679388533"><span class="hs-identifier hs-var hs-var">getName</span></a></span></span><span> </span><span id="local-6989586621679388532"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388532"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388532"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679388539"><span class="hs-identifier hs-var">nameSupply</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679388539"><span class="hs-identifier hs-var">nameSupply</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388532"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span id="local-6989586621679388504"><span class="annot"><span class="annottext">go :: Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="annottext">Term2
</span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v
</span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="Telomare.html#TPair"><span class="hs-identifier hs-type">TPair</span></a></span><span> </span><span id="local-6989586621679388503"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388503"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679388502"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388502"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388503"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388502"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="Telomare.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span id="local-6989586621679388501"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388501"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Max a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Semigroup.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388501"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679388533"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388501"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="Telomare.html#TApp"><span class="hs-identifier hs-type">TApp</span></a></span><span> </span><span id="local-6989586621679388499"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388499"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679388498"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388498"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388499"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388498"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><a href="Telomare.html#TCheck"><span class="hs-identifier hs-type">TCheck</span></a></span><span> </span><span id="local-6989586621679388497"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388497"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679388496"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388496"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TCheck"><span class="hs-identifier hs-var">TCheck</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388497"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388496"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><a href="Telomare.html#TITE"><span class="hs-identifier hs-type">TITE</span></a></span><span> </span><span id="local-6989586621679388495"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388495"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679388494"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388494"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679388493"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388493"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v.
ParserTerm l v
-&gt; ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388495"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388494"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388493"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="Telomare.html#TLeft"><span class="hs-identifier hs-type">TLeft</span></a></span><span> </span><span id="local-6989586621679388492"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388492"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388492"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="Telomare.html#TRight"><span class="hs-identifier hs-type">TRight</span></a></span><span> </span><span id="local-6989586621679388491"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388491"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388491"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><a href="Telomare.html#TTrace"><span class="hs-identifier hs-type">TTrace</span></a></span><span> </span><span id="local-6989586621679388490"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388490"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388490"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388489"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388489"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Semigroup.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span id="local-6989586621679388488"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388488"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679388487"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388487"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Max a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Semigroup.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388488"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679388533"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388488"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388487"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388489"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- warning, untested</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388486"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388486"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Semigroup.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span id="local-6989586621679388485"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388485"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679388484"><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388484"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Max a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Semigroup.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679388533"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388485"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679388484"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388486"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-type">TLimitedRecursion</span></a></span><span> </span><span id="local-6989586621679388483"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388483"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679388482"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388482"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679388481"><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388481"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v.
ParserTerm l v
-&gt; ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-var">TLimitedRecursion</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388483"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388482"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679388481"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679388504"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679388763"><span class="annot"><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-type">decompileFragMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExpr"><span class="hs-identifier hs-type">FragExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679388763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span></span><span>
</span><span id="line-136"></span><span id="decompileFragMap"><span class="annot"><span class="annottext">decompileFragMap :: forall a. Map FragIndex (FragExpr a) -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-var hs-var">decompileFragMap</span></a></span></span><span> </span><span id="local-6989586621679388479"><span class="annot"><span class="annottext">Map FragIndex (FragExpr a)
</span><a href="#local-6989586621679388479"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388467"><span class="annot"><span class="annottext">decomp :: FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388467"><span class="hs-identifier hs-var hs-var">decomp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388466"><span class="annot"><span class="annottext">recur :: FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388467"><span class="hs-identifier hs-var">decomp</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="Telomare.html#ZeroFrag"><span class="hs-identifier hs-var">ZeroFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v
</span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="Telomare.html#PairFrag"><span class="hs-identifier hs-type">PairFrag</span></a></span><span> </span><span id="local-6989586621679388463"><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388463"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679388462"><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388462"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388463"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388462"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Telomare.html#SetEnvFrag"><span class="hs-identifier hs-type">SetEnvFrag</span></a></span><span> </span><span id="local-6989586621679388459"><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388459"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388459"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><a href="Telomare.html#DeferFrag"><span class="hs-identifier hs-type">DeferFrag</span></a></span><span> </span><span id="local-6989586621679388457"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679388457"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr a)
</span><a href="#local-6989586621679388479"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679388457"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="Telomare.html#AbortFrag"><span class="hs-identifier hs-var">AbortFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>          </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TCheck"><span class="hs-identifier hs-var">TCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="Telomare.html#GateFrag"><span class="hs-identifier hs-type">GateFrag</span></a></span><span> </span><span id="local-6989586621679388453"><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388453"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679388452"><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388452"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l v.
ParserTerm l v
-&gt; ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388452"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388453"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="Telomare.html#LeftFrag"><span class="hs-identifier hs-type">LeftFrag</span></a></span><span> </span><span id="local-6989586621679388450"><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388450"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388450"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="Telomare.html#RightFrag"><span class="hs-identifier hs-type">RightFrag</span></a></span><span> </span><span id="local-6989586621679388448"><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388448"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388466"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679388448"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="Telomare.html#TraceFrag"><span class="hs-identifier hs-var">TraceFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href="Telomare.html#AuxFrag"><span class="hs-identifier hs-type">AuxFrag</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decompileFragMap: TODO AuxFrag&quot;</span></span><span> </span><span class="hs-comment">-- TLimitedRecursion</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; Term2
</span><a href="#local-6989586621679388467"><span class="hs-identifier hs-var">decomp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Map FragIndex a -&gt; a
</span><a href="Telomare.html#rootFrag"><span class="hs-identifier hs-var">rootFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr a)
</span><a href="#local-6989586621679388479"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm4"><span class="hs-identifier hs-type">decompileTerm4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span>
</span><span id="line-153"></span><span id="decompileTerm4"><span class="annot"><span class="annottext">decompileTerm4 :: Term4 -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileTerm4"><span class="hs-identifier hs-var hs-var">decompileTerm4</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679388443"><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679388443"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Map FragIndex (FragExpr a) -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-var">decompileFragMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679388443"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm3"><span class="hs-identifier hs-type">decompileTerm3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span>
</span><span id="line-156"></span><span id="decompileTerm3"><span class="annot"><span class="annottext">decompileTerm3 :: Term3 -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileTerm3"><span class="hs-identifier hs-var hs-var">decompileTerm3</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span id="local-6989586621679388441"><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679388441"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Map FragIndex (FragExpr a) -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileFragMap"><span class="hs-identifier hs-var">decompileFragMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; FragExpr (RecursionSimulationPieces FragExprUR)
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679388441"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileIExpr"><span class="hs-identifier hs-type">decompileIExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-159"></span><span id="decompileIExpr"><span class="annot"><span class="annottext">decompileIExpr :: IExpr -&gt; Term4
</span><a href="Telomare.Decompiler.html#decompileIExpr"><span class="hs-identifier hs-var hs-var">decompileIExpr</span></a></span></span><span> </span><span id="local-6989586621679388438"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388438"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388425"><span class="annot"><span class="annottext">build :: IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-160"></span><span>                         </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a
</span><a href="Telomare.html#ZeroFrag"><span class="hs-identifier hs-var">ZeroFrag</span></a></span><span>
</span><span id="line-161"></span><span>                         </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679388422"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388422"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679388421"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388421"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a -&gt; FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#PairFrag"><span class="hs-identifier hs-var">PairFrag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388422"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388421"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-162"></span><span>                         </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span>
</span><span id="line-163"></span><span>                         </span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679388418"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388418"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#SetEnvFrag"><span class="hs-identifier hs-var">SetEnvFrag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388418"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-164"></span><span>                         </span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679388416"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388416"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679388415"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388415"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a -&gt; FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#GateFrag"><span class="hs-identifier hs-var">GateFrag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388416"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388415"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-165"></span><span>                         </span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679388413"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388413"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#LeftFrag"><span class="hs-identifier hs-var">LeftFrag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388413"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-166"></span><span>                         </span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679388411"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388411"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#RightFrag"><span class="hs-identifier hs-var">RightFrag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388411"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-167"></span><span>                         </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FragExpr a
</span><a href="Telomare.html#TraceFrag"><span class="hs-identifier hs-var">TraceFrag</span></a></span><span>
</span><span id="line-168"></span><span>                         </span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679388408"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388408"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. BreakState' a b -&gt; BreakState' a b
</span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388408"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-169"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void) -&gt; Term4
</span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. BreakState' a b -&gt; Map FragIndex (FragExpr a)
</span><a href="Telomare.html#buildFragMap"><span class="hs-identifier hs-var">buildFragMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/vf2iy631xvajyjs6ylf26ibdr7f0qh6s-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b} {a}.
IExpr
-&gt; StateT
     (b, FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679388438"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-170"></span></pre></body></html>