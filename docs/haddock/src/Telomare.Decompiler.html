<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.Decompiler</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM2</span></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Max</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.Parser.html"><span class="hs-identifier">Telomare.Parser</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileUPT"><span class="hs-identifier hs-type">decompileUPT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-14"></span><span id="decompileUPT"><span class="annot"><span class="annottext">decompileUPT :: UnprocessedParsedTerm -&gt; String
</span><a href="Telomare.Decompiler.html#decompileUPT"><span class="hs-identifier hs-var hs-var">decompileUPT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445077"><span class="annot"><span class="annottext">lineLimit :: Integer
</span><a href="#local-6989586621679445077"><span class="hs-identifier hs-var hs-var">lineLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">120</span></span><span>
</span><span id="line-16"></span><span>      </span><span class="hs-comment">-- &quot;hello&quot;</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="#local-6989586621679445076"><span class="hs-identifier hs-type">showS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State.State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-18"></span><span>      </span><span id="local-6989586621679445076"><span class="annot"><span class="annottext">showS :: String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var hs-var">showS</span></a></span></span><span> </span><span id="local-6989586621679445075"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679445075"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445074"><span class="annot"><span class="annottext">indent :: Int
</span><a href="#local-6989586621679445074"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445075"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445074"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity () -&gt; State Int String -&gt; State Int String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445075"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-19"></span><span>      </span><span id="local-6989586621679445070"><span class="annot"><span class="annottext">drawIndent :: State Int String
</span><a href="#local-6989586621679445070"><span class="hs-identifier hs-var hs-var">drawIndent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
-&gt; (Int -&gt; State Int String) -&gt; State Int String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679445068"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679445068"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State Int String) -&gt; String -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445068"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>      </span><span id="local-6989586621679445066"><span class="annot"><span class="annottext">drawList :: [State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var hs-var">drawList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">(StateT Int Identity [String] -&gt; State Int String)
-&gt; ([State Int String] -&gt; StateT Int Identity [String])
-&gt; [State Int String]
-&gt; State Int String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span>
</span><span id="line-21"></span><span>      </span><span id="local-6989586621679445063"><span class="annot"><span class="annottext">needsParens :: UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679445063"><span class="hs-identifier hs-var hs-var">needsParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-comment">-- will need parens if on right side of application</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-type">AppUP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-type">LeftUP</span></a></span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-type">RightUP</span></a></span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-type">TraceUP</span></a></span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-29"></span><span>        </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-30"></span><span>      </span><span id="local-6989586621679445055"><span class="annot"><span class="annottext">needsFirstParens :: UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679445055"><span class="hs-identifier hs-var hs-var">needsFirstParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-34"></span><span>        </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-35"></span><span>      </span><span id="local-6989586621679445054"><span class="annot"><span class="annottext">drawParens :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445054"><span class="hs-identifier hs-var hs-var">drawParens</span></a></span></span><span> </span><span id="local-6989586621679445053"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445053"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679445063"><span class="hs-identifier hs-var">needsParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445053"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-36"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445053"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445053"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-38"></span><span>      </span><span id="local-6989586621679445051"><span class="annot"><span class="annottext">drawFirstParens :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445051"><span class="hs-identifier hs-var hs-var">drawFirstParens</span></a></span></span><span> </span><span id="local-6989586621679445050"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445050"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Bool
</span><a href="#local-6989586621679445055"><span class="hs-identifier hs-var">needsFirstParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445050"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-39"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445050"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-40"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445050"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-41"></span><span>      </span><span class="annot"><a href="#local-6989586621679445052"><span class="hs-identifier hs-type">draw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State.State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-42"></span><span>      </span><span id="local-6989586621679445052"><span class="annot"><span class="annottext">draw :: UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var hs-var">draw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-43"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-type">VarUP</span></a></span><span> </span><span id="local-6989586621679445048"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679445048"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445048"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-44"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-type">ITEUP</span></a></span><span> </span><span id="local-6989586621679445047"><span class="annot"><span class="annottext">i :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445047"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679445046"><span class="annot"><span class="annottext">t :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445046"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679445045"><span class="annot"><span class="annottext">e :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445045"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;if &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445047"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; then &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445046"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; else &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445045"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-45"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#LetUP"><span class="hs-identifier hs-type">LetUP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679445044"><span class="annot"><span class="annottext">firstName :: String
</span><a href="#local-6989586621679445044"><span class="hs-identifier hs-var">firstName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445043"><span class="annot"><span class="annottext">firstDef :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445043"><span class="hs-identifier hs-var">firstDef</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445042"><span class="annot"><span class="annottext">bindingsXS :: [(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679445042"><span class="hs-identifier hs-var">bindingsXS</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679445041"><span class="annot"><span class="annottext">in_ :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445041"><span class="hs-identifier hs-var">in_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679445042"><span class="hs-identifier hs-var">bindingsXS</span></a></span><span>
</span><span id="line-46"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;let &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445044"><span class="hs-identifier hs-var">firstName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445043"><span class="hs-identifier hs-var">firstDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; in &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445041"><span class="hs-identifier hs-var">in_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-48"></span><span>            </span><span id="local-6989586621679445039"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445039"><span class="hs-identifier hs-var">startIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-49"></span><span>            </span><span id="local-6989586621679445038"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445038"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;let &quot;</span></span><span>
</span><span id="line-50"></span><span>            </span><span id="local-6989586621679445037"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445037"><span class="hs-identifier hs-var">startBind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-51"></span><span>            </span><span id="local-6989586621679445036"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445036"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445044"><span class="hs-identifier hs-var">firstName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445043"><span class="hs-identifier hs-var">firstDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445035"><span class="annot"><span class="annottext">drawOne :: (String, UnprocessedParsedTerm) -&gt; State Int String
</span><a href="#local-6989586621679445035"><span class="hs-identifier hs-var hs-var">drawOne</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445034"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679445034"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445033"><span class="annot"><span class="annottext">upt :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445033"><span class="hs-identifier hs-var">upt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-53"></span><span>                  </span><span class="annot"><span class="annottext">Int -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">State.put</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445037"><span class="hs-identifier hs-var">startBind</span></a></span><span>
</span><span id="line-54"></span><span>                  </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679445070"><span class="hs-identifier hs-var">drawIndent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445034"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445033"><span class="hs-identifier hs-var">upt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span>            </span><span id="local-6989586621679445031"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445031"><span class="hs-identifier hs-var">displayedBindings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((String, UnprocessedParsedTerm) -&gt; State Int String)
-&gt; [(String, UnprocessedParsedTerm)]
-&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(String, UnprocessedParsedTerm) -&gt; State Int String
</span><a href="#local-6989586621679445035"><span class="hs-identifier hs-var">drawOne</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679445042"><span class="hs-identifier hs-var">bindingsXS</span></a></span><span>
</span><span id="line-56"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">State.put</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445039"><span class="hs-identifier hs-var">startIn</span></a></span><span>
</span><span id="line-57"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445038"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445036"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445031"><span class="hs-identifier hs-var">displayedBindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679445070"><span class="hs-identifier hs-var">drawIndent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;in &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445041"><span class="hs-identifier hs-var">in_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#ListUP"><span class="hs-identifier hs-type">ListUP</span></a></span><span> </span><span id="local-6989586621679445027"><span class="annot"><span class="annottext">l :: [UnprocessedParsedTerm]
</span><a href="#local-6989586621679445027"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445026"><span class="annot"><span class="annottext">insertCommas :: [State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679445026"><span class="hs-identifier hs-var hs-var">insertCommas</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>                          </span><span class="annot"><a href="#local-6989586621679445026"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679445025"><span class="annot"><span class="annottext">x :: State Int String
</span><a href="#local-6989586621679445025"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679445025"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span>                          </span><span class="annot"><a href="#local-6989586621679445026"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445024"><span class="annot"><span class="annottext">x :: State Int String
</span><a href="#local-6989586621679445024"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445023"><span class="annot"><span class="annottext">xs :: [State Int String]
</span><a href="#local-6989586621679445023"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Int String
</span><a href="#local-6989586621679445024"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">State Int String -&gt; [State Int String] -&gt; [State Int String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">State Int String -&gt; [State Int String] -&gt; [State Int String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679445026"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="annot"><span class="annottext">[State Int String]
</span><a href="#local-6989586621679445023"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-61"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;[&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; StateT Int Identity [String] -&gt; State Int String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">(StateT Int Identity [String] -&gt; State Int String)
-&gt; ([State Int String] -&gt; StateT Int Identity [String])
-&gt; [State Int String]
-&gt; State Int String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; StateT Int Identity [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([State Int String] -&gt; StateT Int Identity [String])
-&gt; ([State Int String] -&gt; [State Int String])
-&gt; [State Int String]
-&gt; StateT Int Identity [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; [State Int String]
</span><a href="#local-6989586621679445026"><span class="hs-identifier hs-var">insertCommas</span></a></span><span> </span><span class="annot"><span class="annottext">([State Int String] -&gt; State Int String)
-&gt; [State Int String] -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; State Int String)
-&gt; [UnprocessedParsedTerm] -&gt; [State Int String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">[UnprocessedParsedTerm]
</span><a href="#local-6989586621679445027"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-type">IntUP</span></a></span><span> </span><span id="local-6989586621679445020"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679445020"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State Int String) -&gt; String -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445020"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-63"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#StringUP"><span class="hs-identifier hs-type">StringUP</span></a></span><span> </span><span id="local-6989586621679445017"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679445017"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445017"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-type">PairUP</span></a></span><span> </span><span id="local-6989586621679445015"><span class="annot"><span class="annottext">a :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445015"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679445014"><span class="annot"><span class="annottext">b :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445014"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445015"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445014"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-type">AppUP</span></a></span><span> </span><span id="local-6989586621679445013"><span class="annot"><span class="annottext">f :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445013"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445012"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445012"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445051"><span class="hs-identifier hs-var">drawFirstParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445013"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445054"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445012"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>          </span><span class="hs-comment">-- TODO flatten nested lambdas</span><span>
</span><span id="line-67"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-type">LamUP</span></a></span><span> </span><span id="local-6989586621679445011"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679445011"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679445010"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445010"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\\&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679445011"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445010"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#ChurchUP"><span class="hs-identifier hs-type">ChurchUP</span></a></span><span> </span><span id="local-6989586621679445008"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679445008"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State Int String) -&gt; String -&gt; State Int String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445008"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-type">UnsizedRecursionUP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-70"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-type">LeftUP</span></a></span><span> </span><span id="local-6989586621679445006"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445006"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;left &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445054"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445006"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-type">RightUP</span></a></span><span> </span><span id="local-6989586621679445005"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445005"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;right &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445054"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445005"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-type">TraceUP</span></a></span><span> </span><span id="local-6989586621679445004"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445004"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;trace &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445054"><span class="hs-identifier hs-var">drawParens</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445004"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>          </span><span class="annot"><a href="Telomare.Parser.html#CheckUP"><span class="hs-identifier hs-type">CheckUP</span></a></span><span> </span><span id="local-6989586621679445002"><span class="annot"><span class="annottext">c :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445002"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679445001"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445001"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[State Int String] -&gt; State Int String
</span><a href="#local-6989586621679445066"><span class="hs-identifier hs-var">drawList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445001"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; State Int String
</span><a href="#local-6989586621679445076"><span class="hs-identifier hs-var">showS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; : &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445002"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679445000"><span class="annot"><span class="annottext">x :: UnprocessedParsedTerm
</span><a href="#local-6989586621679445000"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State Int String -&gt; Int -&gt; String
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">State.evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; State Int String
</span><a href="#local-6989586621679445052"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679445000"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">{-
      safeTail s = if null s then [] else tail s
      showMem s = do
        let indent = length . last . takeWhile (not . null) . iterate (safeTail . dropWhile (/= '\n')) $ s
        if elem '\n' s
          then State.put indent
          else State.modify (+ indent)
        pure s
      draw oneLine =
        let showTwo a b = undefined --let long =
            showLine l = do
              indent &lt;- State.get
              let long = intercalate &quot; &quot; l
                         in if length long &gt; lineLimit
                            then

-}</span><span>
</span><span id="line-93"></span><span>              </span><span class="hs-comment">{-m
          drawLineOr x y = if not oneLine &amp;&amp; draw
-}</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-type">decompileTerm1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.Parser.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-98"></span><span id="decompileTerm1"><span class="annot"><span class="annottext">decompileTerm1 :: Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var hs-var">decompileTerm1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Telomare.html#TZero"><span class="hs-identifier hs-type">TZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="Telomare.html#TPair"><span class="hs-identifier hs-type">TPair</span></a></span><span> </span><span id="local-6989586621679444995"><span class="annot"><span class="annottext">a :: Term1
</span><a href="#local-6989586621679444995"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679444994"><span class="annot"><span class="annottext">b :: Term1
</span><a href="#local-6989586621679444994"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444995"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444994"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="Telomare.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span id="local-6989586621679444992"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679444992"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679444992"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Telomare.html#TApp"><span class="hs-identifier hs-type">TApp</span></a></span><span> </span><span id="local-6989586621679444990"><span class="annot"><span class="annottext">f :: Term1
</span><a href="#local-6989586621679444990"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679444989"><span class="annot"><span class="annottext">x :: Term1
</span><a href="#local-6989586621679444989"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444990"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444989"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Telomare.html#TCheck"><span class="hs-identifier hs-type">TCheck</span></a></span><span> </span><span id="local-6989586621679444987"><span class="annot"><span class="annottext">c :: Term1
</span><a href="#local-6989586621679444987"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679444986"><span class="annot"><span class="annottext">x :: Term1
</span><a href="#local-6989586621679444986"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#CheckUP"><span class="hs-identifier hs-var">CheckUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444987"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444986"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Telomare.html#TITE"><span class="hs-identifier hs-type">TITE</span></a></span><span> </span><span id="local-6989586621679444984"><span class="annot"><span class="annottext">i :: Term1
</span><a href="#local-6989586621679444984"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679444983"><span class="annot"><span class="annottext">t :: Term1
</span><a href="#local-6989586621679444983"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679444982"><span class="annot"><span class="annottext">e :: Term1
</span><a href="#local-6989586621679444982"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444984"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444983"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444982"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Telomare.html#TLeft"><span class="hs-identifier hs-type">TLeft</span></a></span><span> </span><span id="local-6989586621679444980"><span class="annot"><span class="annottext">x :: Term1
</span><a href="#local-6989586621679444980"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444980"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Telomare.html#TRight"><span class="hs-identifier hs-type">TRight</span></a></span><span> </span><span id="local-6989586621679444978"><span class="annot"><span class="annottext">x :: Term1
</span><a href="#local-6989586621679444978"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444978"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Telomare.html#TTrace"><span class="hs-identifier hs-type">TTrace</span></a></span><span> </span><span id="local-6989586621679444976"><span class="annot"><span class="annottext">x :: Term1
</span><a href="#local-6989586621679444976"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444976"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span id="local-6989586621679444973"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679444973"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679444972"><span class="annot"><span class="annottext">x :: Term1
</span><a href="#local-6989586621679444972"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679444973"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444972"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span id="local-6989586621679444970"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679444970"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679444969"><span class="annot"><span class="annottext">x :: Term1
</span><a href="#local-6989586621679444969"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679444970"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term1 -&gt; UnprocessedParsedTerm
</span><a href="Telomare.Decompiler.html#decompileTerm1"><span class="hs-identifier hs-var">decompileTerm1</span></a></span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444969"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- not strictly equivalent</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-type">TLimitedRecursion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="Telomare.Parser.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm2"><span class="hs-identifier hs-type">decompileTerm2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term1"><span class="hs-identifier hs-type">Term1</span></a></span><span>
</span><span id="line-113"></span><span id="decompileTerm2"><span class="annot"><span class="annottext">decompileTerm2 :: Term2 -&gt; Term1
</span><a href="Telomare.Decompiler.html#decompileTerm2"><span class="hs-identifier hs-var hs-var">decompileTerm2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679444966"><span class="annot"><span class="annottext">nameSupply :: [String]
</span><a href="#local-6989586621679444966"><span class="hs-identifier hs-var hs-var">nameSupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String) -&gt; String -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679444965"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679444964"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679444965"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679444965"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679444966"><span class="hs-identifier hs-var">nameSupply</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679444964"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679444964"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679444966"><span class="hs-identifier hs-var">nameSupply</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621679444963"><span class="annot"><span class="annottext">getName :: Int -&gt; String
</span><a href="#local-6989586621679444963"><span class="hs-identifier hs-var hs-var">getName</span></a></span></span><span> </span><span id="local-6989586621679444962"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679444962"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679444962"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679444966"><span class="hs-identifier hs-var">nameSupply</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int -&gt; String
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679444966"><span class="hs-identifier hs-var">nameSupply</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int -&gt; String
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679444962"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span id="local-6989586621679444959"><span class="annot"><span class="annottext">go :: Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><a href="Telomare.html#TZero"><span class="hs-identifier hs-type">TZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term1
forall l v. ParserTerm l v
</span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><a href="Telomare.html#TPair"><span class="hs-identifier hs-type">TPair</span></a></span><span> </span><span id="local-6989586621679444958"><span class="annot"><span class="annottext">a :: Term2
</span><a href="#local-6989586621679444958"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679444957"><span class="annot"><span class="annottext">b :: Term2
</span><a href="#local-6989586621679444957"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; Term1
forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444958"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444957"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="Telomare.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span id="local-6989586621679444956"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679444956"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Max Int
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679444956"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Term1
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679444963"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679444956"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="Telomare.html#TApp"><span class="hs-identifier hs-type">TApp</span></a></span><span> </span><span id="local-6989586621679444954"><span class="annot"><span class="annottext">f :: Term2
</span><a href="#local-6989586621679444954"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679444953"><span class="annot"><span class="annottext">x :: Term2
</span><a href="#local-6989586621679444953"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; Term1
forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444954"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444953"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="Telomare.html#TCheck"><span class="hs-identifier hs-type">TCheck</span></a></span><span> </span><span id="local-6989586621679444952"><span class="annot"><span class="annottext">c :: Term2
</span><a href="#local-6989586621679444952"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679444951"><span class="annot"><span class="annottext">x :: Term2
</span><a href="#local-6989586621679444951"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; Term1
forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TCheck"><span class="hs-identifier hs-var">TCheck</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444952"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444951"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="Telomare.html#TITE"><span class="hs-identifier hs-type">TITE</span></a></span><span> </span><span id="local-6989586621679444950"><span class="annot"><span class="annottext">i :: Term2
</span><a href="#local-6989586621679444950"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679444949"><span class="annot"><span class="annottext">t :: Term2
</span><a href="#local-6989586621679444949"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679444948"><span class="annot"><span class="annottext">e :: Term2
</span><a href="#local-6989586621679444948"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1 -&gt; Term1 -&gt; Term1
forall l v.
ParserTerm l v
-&gt; ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444950"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1 -&gt; Term1)
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1 -&gt; Term1)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444949"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444948"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><a href="Telomare.html#TLeft"><span class="hs-identifier hs-type">TLeft</span></a></span><span> </span><span id="local-6989586621679444947"><span class="annot"><span class="annottext">x :: Term2
</span><a href="#local-6989586621679444947"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444947"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><a href="Telomare.html#TRight"><span class="hs-identifier hs-type">TRight</span></a></span><span> </span><span id="local-6989586621679444946"><span class="annot"><span class="annottext">x :: Term2
</span><a href="#local-6989586621679444946"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444946"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="Telomare.html#TTrace"><span class="hs-identifier hs-type">TTrace</span></a></span><span> </span><span id="local-6989586621679444945"><span class="annot"><span class="annottext">x :: Term2
</span><a href="#local-6989586621679444945"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; Term1
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a></span><span> </span><span class="annot"><span class="annottext">(Term1 -&gt; Term1) -&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444945"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679444944"><span class="annot"><span class="annottext">x :: Term2
</span><a href="#local-6989586621679444944"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span id="local-6989586621679444943"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679444943"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679444942"><span class="annot"><span class="annottext">r :: Term1
</span><a href="#local-6989586621679444942"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Max Int
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679444943"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamType String -&gt; Term1 -&gt; Term1
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; LamType String
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679444963"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679444943"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444942"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Max Int, Term1) -&gt; (Max Int, Term1))
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444944"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- warning, untested</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><a href="Telomare.html#TLam"><span class="hs-identifier hs-type">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Closed"><span class="hs-identifier hs-type">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679444941"><span class="annot"><span class="annottext">x :: Term2
</span><a href="#local-6989586621679444941"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span id="local-6989586621679444940"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679444940"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679444939"><span class="annot"><span class="annottext">r :: Term1
</span><a href="#local-6989586621679444939"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Max Int
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamType String -&gt; Term1 -&gt; Term1
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; LamType String
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679444963"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679444940"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term1
</span><a href="#local-6989586621679444939"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Max Int, Term1) -&gt; (Max Int, Term1))
-&gt; (Max Int, Term1) -&gt; (Max Int, Term1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2
</span><a href="#local-6989586621679444941"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-type">TLimitedRecursion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term1 -&gt; (Max Int, Term1)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term1
forall l v. ParserTerm l v
</span><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-var">TLimitedRecursion</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Max Int, Term1) -&gt; Term1
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Max Int, Term1) -&gt; Term1)
-&gt; (Term2 -&gt; (Max Int, Term1)) -&gt; Term2 -&gt; Term1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; (Max Int, Term1)
</span><a href="#local-6989586621679444959"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileTerm4"><span class="hs-identifier hs-type">decompileTerm4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term2"><span class="hs-identifier hs-type">Term2</span></a></span><span>
</span><span id="line-134"></span><span id="decompileTerm4"><span class="annot"><span class="annottext">decompileTerm4 :: Term4 -&gt; Term2
</span><a href="Telomare.Decompiler.html#decompileTerm4"><span class="hs-identifier hs-var hs-var">decompileTerm4</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679444936"><span class="annot"><span class="annottext">tm :: Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679444936"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679444935"><span class="annot"><span class="annottext">decomp :: FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444935"><span class="hs-identifier hs-var hs-var">decomp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679444934"><span class="annot"><span class="annottext">recur :: FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444935"><span class="hs-identifier hs-var">decomp</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="Telomare.html#ZeroFrag"><span class="hs-identifier hs-type">ZeroFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2
forall l v. ParserTerm l v
</span><a href="Telomare.html#TZero"><span class="hs-identifier hs-var">TZero</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><a href="Telomare.html#PairFrag"><span class="hs-identifier hs-type">PairFrag</span></a></span><span> </span><span id="local-6989586621679444931"><span class="annot"><span class="annottext">a :: FragExpr Void
</span><a href="#local-6989586621679444931"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679444930"><span class="annot"><span class="annottext">b :: FragExpr Void
</span><a href="#local-6989586621679444930"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TPair"><span class="hs-identifier hs-var">TPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
</span><a href="#local-6989586621679444931"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
</span><a href="#local-6989586621679444930"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-type">EnvFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="Telomare.html#SetEnvFrag"><span class="hs-identifier hs-type">SetEnvFrag</span></a></span><span> </span><span id="local-6989586621679444927"><span class="annot"><span class="annottext">x :: FragExpr Void
</span><a href="#local-6989586621679444927"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; Term2
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TApp"><span class="hs-identifier hs-var">TApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2) -&gt; Term2 -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
</span><a href="#local-6989586621679444927"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="Telomare.html#DeferFrag"><span class="hs-identifier hs-type">DeferFrag</span></a></span><span> </span><span id="local-6989586621679444925"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679444925"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; Term2
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2)
-&gt; (FragExpr Void -&gt; Term2) -&gt; FragExpr Void -&gt; Term2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr Void -&gt; Term2) -&gt; FragExpr Void -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679444936"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void) -&gt; FragIndex -&gt; FragExpr Void
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679444925"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Telomare.html#AbortFrag"><span class="hs-identifier hs-type">AbortFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; Term2
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2) -&gt; (Term2 -&gt; Term2) -&gt; Term2 -&gt; Term2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; Term2
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>          </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2) -&gt; Term2 -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TCheck"><span class="hs-identifier hs-var">TCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; Term2
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><a href="Telomare.html#GateFrag"><span class="hs-identifier hs-type">GateFrag</span></a></span><span> </span><span id="local-6989586621679444921"><span class="annot"><span class="annottext">l :: FragExpr Void
</span><a href="#local-6989586621679444921"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679444920"><span class="annot"><span class="annottext">r :: FragExpr Void
</span><a href="#local-6989586621679444920"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; Term2
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2) -&gt; Term2 -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2 -&gt; Term2 -&gt; Term2
forall l v.
ParserTerm l v
-&gt; ParserTerm l v -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TITE"><span class="hs-identifier hs-var">TITE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
</span><a href="#local-6989586621679444920"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
</span><a href="#local-6989586621679444921"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><a href="Telomare.html#LeftFrag"><span class="hs-identifier hs-type">LeftFrag</span></a></span><span> </span><span id="local-6989586621679444918"><span class="annot"><span class="annottext">x :: FragExpr Void
</span><a href="#local-6989586621679444918"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLeft"><span class="hs-identifier hs-var">TLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2) -&gt; Term2 -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
</span><a href="#local-6989586621679444918"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="Telomare.html#RightFrag"><span class="hs-identifier hs-type">RightFrag</span></a></span><span> </span><span id="local-6989586621679444916"><span class="annot"><span class="annottext">x :: FragExpr Void
</span><a href="#local-6989586621679444916"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TRight"><span class="hs-identifier hs-var">TRight</span></a></span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2) -&gt; Term2 -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444934"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr Void
</span><a href="#local-6989586621679444916"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="Telomare.html#TraceFrag"><span class="hs-identifier hs-type">TraceFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LamType () -&gt; Term2 -&gt; Term2
forall l v. LamType l -&gt; ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TLam"><span class="hs-identifier hs-var">TLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; LamType ()
forall l. l -&gt; LamType l
</span><a href="Telomare.html#Closed"><span class="hs-identifier hs-var">Closed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term2 -&gt; Term2) -&gt; Term2 -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term2 -&gt; Term2
forall l v. ParserTerm l v -&gt; ParserTerm l v
</span><a href="Telomare.html#TTrace"><span class="hs-identifier hs-var">TTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2
forall l v. v -&gt; ParserTerm l v
</span><a href="Telomare.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="Telomare.html#AuxFrag"><span class="hs-identifier hs-type">AuxFrag</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2
forall l v. ParserTerm l v
</span><a href="Telomare.html#TLimitedRecursion"><span class="hs-identifier hs-var">TLimitedRecursion</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FragExpr Void -&gt; Term2
</span><a href="#local-6989586621679444935"><span class="hs-identifier hs-var">decomp</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr Void -&gt; Term2) -&gt; FragExpr Void -&gt; Term2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void) -&gt; FragExpr Void
forall a. Map FragIndex a -&gt; a
</span><a href="Telomare.html#rootFrag"><span class="hs-identifier hs-var">rootFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679444936"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Telomare.Decompiler.html#decompileIExpr"><span class="hs-identifier hs-type">decompileIExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-151"></span><span id="decompileIExpr"><span class="annot"><span class="annottext">decompileIExpr :: IExpr -&gt; Term4
</span><a href="Telomare.Decompiler.html#decompileIExpr"><span class="hs-identifier hs-var hs-var">decompileIExpr</span></a></span></span><span> </span><span id="local-6989586621679444911"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679444911"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679444910"><span class="annot"><span class="annottext">build :: IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-152"></span><span>                         </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">FragExpr a
forall a. FragExpr a
</span><a href="Telomare.html#ZeroFrag"><span class="hs-identifier hs-var">ZeroFrag</span></a></span><span>
</span><span id="line-153"></span><span>                         </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679444907"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679444907"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679444906"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679444906"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; FragExpr a -&gt; FragExpr a
forall a. FragExpr a -&gt; FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#PairFrag"><span class="hs-identifier hs-var">PairFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr a -&gt; FragExpr a -&gt; FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a))
     Identity
     (FragExpr a -&gt; FragExpr a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444907"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex (FragExpr a))
  Identity
  (FragExpr a -&gt; FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444906"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-154"></span><span>                         </span><span class="annot"><a href="Telomare.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">FragExpr a
forall a. FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span>
</span><span id="line-155"></span><span>                         </span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679444903"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679444903"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; FragExpr a
forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#SetEnvFrag"><span class="hs-identifier hs-var">SetEnvFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr a -&gt; FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444903"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-156"></span><span>                         </span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679444901"><span class="annot"><span class="annottext">l :: IExpr
</span><a href="#local-6989586621679444901"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679444900"><span class="annot"><span class="annottext">r :: IExpr
</span><a href="#local-6989586621679444900"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; FragExpr a -&gt; FragExpr a
forall a. FragExpr a -&gt; FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#GateFrag"><span class="hs-identifier hs-var">GateFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr a -&gt; FragExpr a -&gt; FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a))
     Identity
     (FragExpr a -&gt; FragExpr a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444901"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex (FragExpr a))
  Identity
  (FragExpr a -&gt; FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444900"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-157"></span><span>                         </span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679444898"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679444898"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; FragExpr a
forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#LeftFrag"><span class="hs-identifier hs-var">LeftFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr a -&gt; FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444898"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-158"></span><span>                         </span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679444896"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679444896"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a -&gt; FragExpr a
forall a. FragExpr a -&gt; FragExpr a
</span><a href="Telomare.html#RightFrag"><span class="hs-identifier hs-var">RightFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr a -&gt; FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444896"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-159"></span><span>                         </span><span class="annot"><a href="Telomare.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">FragExpr a
forall a. FragExpr a
</span><a href="Telomare.html#TraceFrag"><span class="hs-identifier hs-var">TraceFrag</span></a></span><span>
</span><span id="line-160"></span><span>                         </span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679444893"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679444893"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT
  (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall a. BreakState' a -&gt; BreakState' a
</span><a href="Telomare.html#deferF"><span class="hs-identifier hs-var">deferF</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT
   (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
 -&gt; StateT
      (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a))
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444893"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-161"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void) -&gt; Term4
</span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (FragExpr Void) -&gt; Term4)
-&gt; (BreakState' Void -&gt; Map FragIndex (FragExpr Void))
-&gt; BreakState' Void
-&gt; Term4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BreakState' Void -&gt; Map FragIndex (FragExpr Void)
forall a. BreakState' a -&gt; Map FragIndex (FragExpr a)
</span><a href="Telomare.html#buildFragMap"><span class="hs-identifier hs-var">buildFragMap</span></a></span><span> </span><span class="annot"><span class="annottext">(BreakState' Void -&gt; Term4) -&gt; BreakState' Void -&gt; Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; BreakState' Void
forall a.
IExpr
-&gt; StateT
     (FragIndex, Map FragIndex (FragExpr a)) Identity (FragExpr a)
</span><a href="#local-6989586621679444910"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679444911"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-162"></span></pre></body></html>