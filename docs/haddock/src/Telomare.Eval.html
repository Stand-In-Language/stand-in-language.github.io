<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html"><span class="hs-identifier">Control.Comonad.Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator">(:&lt;)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#hoistCofree"><span class="hs-identifier">hoistCofree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html"><span class="hs-identifier">Control.Lens.Plated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#Plated"><span class="hs-identifier">Plated</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transform"><span class="hs-identifier">transform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier">transformM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StateT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bimap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fix</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/nkxcfn1kvlkh491i67549y0m2b8jji3n-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html"><span class="hs-identifier">Data.Functor.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/nkxcfn1kvlkh491i67549y0m2b8jji3n-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#Base"><span class="hs-identifier">Base</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/nkxcfn1kvlkh491i67549y0m2b8jji3n-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#para"><span class="hs-identifier">para</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">trace</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PrettyPrint.html"><span class="hs-identifier">PrettyPrint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PrettyPrint.html#prettyPrint"><span class="hs-identifier">prettyPrint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hGetContents</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q31s60qx953044l007x0da9bb0yqg1fs-strict-0.5-doc/share/doc/strict-0.5/html/src/System.IO.Strict.html"><span class="hs-identifier">System.IO.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CreateProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">std_out</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StdStream</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CreatePipe</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>                       </span><span class="annot"><span class="hs-identifier">createProcess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shell</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Optimizer.html"><span class="hs-identifier">Telomare.Optimizer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Optimizer.html#optimize"><span class="hs-identifier">optimize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Parser.html"><span class="hs-identifier">Telomare.Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier">AnnotatedUPT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#parseOneExprOrTopLevelDefs"><span class="hs-identifier">parseOneExprOrTopLevelDefs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier">parsePrelude</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Possible.html"><span class="hs-identifier">Telomare.Possible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Possible.html#AbortExpr"><span class="hs-identifier">AbortExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#abortExprToTerm4"><span class="hs-identifier">abortExprToTerm4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#evalA"><span class="hs-identifier">evalA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Possible.html#sizeTerm"><span class="hs-identifier">sizeTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                          </span><span class="annot"><a href="Telomare.Possible.html#term3ToUnsizedExpr"><span class="hs-identifier">term3ToUnsizedExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.Resolver.html"><span class="hs-identifier">Telomare.Resolver</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Resolver.html#parseMain"><span class="hs-identifier">parseMain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Resolver.html#process"><span class="hs-identifier">process</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.RunTime.html"><span class="hs-identifier">Telomare.RunTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.RunTime.html#pureEval"><span class="hs-identifier">pureEval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier">rEval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Telomare.TypeChecker.html"><span class="hs-identifier">Telomare.TypeChecker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.TypeChecker.html#TypeCheckError"><span class="hs-identifier">TypeCheckError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.TypeChecker.html#typeCheck"><span class="hs-identifier">typeCheck</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/rf55ybn55ssrz2kwdgpi5n38b48gkzss-megaparsec-9.6.1-doc/share/doc/megaparsec-9.6.1/html/src/Text.Megaparsec.html"><span class="hs-identifier">Text.Megaparsec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rf55ybn55ssrz2kwdgpi5n38b48gkzss-megaparsec-9.6.1-doc/share/doc/megaparsec-9.6.1/html/src/Text.Megaparsec.Error.html#errorBundlePretty"><span class="hs-identifier">errorBundlePretty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/rf55ybn55ssrz2kwdgpi5n38b48gkzss-megaparsec-9.6.1-doc/share/doc/megaparsec-9.6.1/html/src/Text.Megaparsec.html#runParser"><span class="hs-identifier">runParser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="annot"><a href="Telomare.Eval.html#debug"><span class="hs-identifier hs-type">debug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-34"></span><span id="debug"><span class="annot"><span class="annottext">debug :: Bool
</span><a href="Telomare.Eval.html#debug"><span class="hs-identifier hs-var hs-var">debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span id="local-6989586621679259303"><span class="annot"><a href="Telomare.Eval.html#debugTrace"><span class="hs-identifier hs-type">debugTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679259303"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679259303"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-37"></span><span id="debugTrace"><span class="annot"><span class="annottext">debugTrace :: forall a. [Char] -&gt; a -&gt; a
</span><a href="Telomare.Eval.html#debugTrace"><span class="hs-identifier hs-var hs-var">debugTrace</span></a></span></span><span> </span><span id="local-6989586621679259817"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679259817"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679259818"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259818"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Telomare.Eval.html#debug"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a -&gt; a
forall a. [Char] -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679259817"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259818"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259818"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span> </span><span id="ExpP"><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-var">ExpP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ZeroP"><span class="annot"><a href="Telomare.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a></span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PairP"><span class="annot"><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="VarP"><span class="annot"><a href="Telomare.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a></span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SetEnvP"><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DeferP"><span class="annot"><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AbortP"><span class="annot"><a href="Telomare.Eval.html#AbortP"><span class="hs-identifier hs-var">AbortP</span></a></span></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="GateP"><span class="annot"><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LeftP"><span class="annot"><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RightP"><span class="annot"><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TraceP"><span class="annot"><a href="Telomare.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a></span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259830"><span id="local-6989586621679259843"><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; Bool
(ExpP -&gt; ExpP -&gt; Bool) -&gt; (ExpP -&gt; ExpP -&gt; Bool) -&gt; Eq ExpP
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ExpP -&gt; ExpP -&gt; Bool
== :: ExpP -&gt; ExpP -&gt; Bool
$c/= :: ExpP -&gt; ExpP -&gt; Bool
/= :: ExpP -&gt; ExpP -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259847"><span id="local-6989586621679259867"><span id="local-6989586621679259870"><span class="annot"><span class="annottext">Int -&gt; ExpP -&gt; ShowS
[ExpP] -&gt; ShowS
ExpP -&gt; [Char]
(Int -&gt; ExpP -&gt; ShowS)
-&gt; (ExpP -&gt; [Char]) -&gt; ([ExpP] -&gt; ShowS) -&gt; Show ExpP
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ExpP -&gt; ShowS
showsPrec :: Int -&gt; ExpP -&gt; ShowS
$cshow :: ExpP -&gt; [Char]
show :: ExpP -&gt; [Char]
$cshowList :: [ExpP] -&gt; ShowS
showList :: [ExpP] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259876"><span id="local-6989586621679259889"><span id="local-6989586621679259892"><span id="local-6989586621679259895"><span id="local-6989586621679259898"><span id="local-6989586621679259901"><span id="local-6989586621679259904"><span class="annot"><span class="annottext">Eq ExpP
Eq ExpP =&gt;
(ExpP -&gt; ExpP -&gt; Ordering)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; ExpP)
-&gt; (ExpP -&gt; ExpP -&gt; ExpP)
-&gt; Ord ExpP
ExpP -&gt; ExpP -&gt; Bool
ExpP -&gt; ExpP -&gt; Ordering
ExpP -&gt; ExpP -&gt; ExpP
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: ExpP -&gt; ExpP -&gt; Ordering
compare :: ExpP -&gt; ExpP -&gt; Ordering
$c&lt; :: ExpP -&gt; ExpP -&gt; Bool
&lt; :: ExpP -&gt; ExpP -&gt; Bool
$c&lt;= :: ExpP -&gt; ExpP -&gt; Bool
&lt;= :: ExpP -&gt; ExpP -&gt; Bool
$c&gt; :: ExpP -&gt; ExpP -&gt; Bool
&gt; :: ExpP -&gt; ExpP -&gt; Bool
$c&gt;= :: ExpP -&gt; ExpP -&gt; Bool
&gt;= :: ExpP -&gt; ExpP -&gt; Bool
$cmax :: ExpP -&gt; ExpP -&gt; ExpP
max :: ExpP -&gt; ExpP -&gt; ExpP
$cmin :: ExpP -&gt; ExpP -&gt; ExpP
min :: ExpP -&gt; ExpP -&gt; ExpP
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#Plated"><span class="hs-identifier hs-type">Plated</span></a></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679259924"><span class="annot"><span class="annottext">plate :: Traversal' ExpP ExpP
</span><a href="#local-6989586621679259924"><span class="hs-identifier hs-var hs-var hs-var hs-var">plate</span></a></span></span><span> </span><span id="local-6989586621679259926"><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-type">PairP</span></a></span><span> </span><span id="local-6989586621679259927"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259927"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679259928"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259928"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f (ExpP -&gt; ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259927"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f (ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259928"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-type">SetEnvP</span></a></span><span> </span><span id="local-6989586621679259930"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259930"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679259931"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679259931"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; Bool -&gt; ExpP
</span><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; Bool -&gt; ExpP) -&gt; f ExpP -&gt; f (Bool -&gt; ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259930"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (Bool -&gt; ExpP) -&gt; f Bool -&gt; f ExpP
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f Bool
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679259931"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-type">DeferP</span></a></span><span> </span><span id="local-6989586621679259932"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259932"><span class="hs-identifier hs-var">x</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259932"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-type">GateP</span></a></span><span> </span><span id="local-6989586621679259933"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259933"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679259934"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259934"><span class="hs-identifier hs-var">r</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f (ExpP -&gt; ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259933"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">f (ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259934"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-type">LeftP</span></a></span><span> </span><span id="local-6989586621679259935"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259935"><span class="hs-identifier hs-var">x</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259935"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-type">RightP</span></a></span><span> </span><span id="local-6989586621679259936"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259936"><span class="hs-identifier hs-var">x</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259936"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621679259937"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259937"><span class="hs-identifier hs-var">x</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679259937"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">data</span><span> </span><span id="EvalError"><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-var">EvalError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RTE"><span class="annot"><a href="Telomare.Eval.html#RTE"><span class="hs-identifier hs-var">RTE</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TCE"><span class="annot"><a href="Telomare.Eval.html#TCE"><span class="hs-identifier hs-var">TCE</span></a></span></span><span> </span><span class="annot"><a href="Telomare.TypeChecker.html#TypeCheckError"><span class="hs-identifier hs-type">TypeCheckError</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StaticCheckError"><span class="annot"><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CompileConversionError"><span class="annot"><a href="Telomare.Eval.html#CompileConversionError"><span class="hs-identifier hs-var">CompileConversionError</span></a></span></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RecursionLimitError"><span class="annot"><a href="Telomare.Eval.html#RecursionLimitError"><span class="hs-identifier hs-var">RecursionLimitError</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#UnsizedRecursionToken"><span class="hs-identifier hs-type">UnsizedRecursionToken</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259944"><span id="local-6989586621679259955"><span class="annot"><span class="annottext">EvalError -&gt; EvalError -&gt; Bool
(EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool) -&gt; Eq EvalError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: EvalError -&gt; EvalError -&gt; Bool
== :: EvalError -&gt; EvalError -&gt; Bool
$c/= :: EvalError -&gt; EvalError -&gt; Bool
/= :: EvalError -&gt; EvalError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259962"><span id="local-6989586621679259973"><span id="local-6989586621679259977"><span id="local-6989586621679259980"><span id="local-6989586621679259983"><span id="local-6989586621679259986"><span id="local-6989586621679259989"><span class="annot"><span class="annottext">Eq EvalError
Eq EvalError =&gt;
(EvalError -&gt; EvalError -&gt; Ordering)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; EvalError)
-&gt; (EvalError -&gt; EvalError -&gt; EvalError)
-&gt; Ord EvalError
EvalError -&gt; EvalError -&gt; Bool
EvalError -&gt; EvalError -&gt; Ordering
EvalError -&gt; EvalError -&gt; EvalError
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: EvalError -&gt; EvalError -&gt; Ordering
compare :: EvalError -&gt; EvalError -&gt; Ordering
$c&lt; :: EvalError -&gt; EvalError -&gt; Bool
&lt; :: EvalError -&gt; EvalError -&gt; Bool
$c&lt;= :: EvalError -&gt; EvalError -&gt; Bool
&lt;= :: EvalError -&gt; EvalError -&gt; Bool
$c&gt; :: EvalError -&gt; EvalError -&gt; Bool
&gt; :: EvalError -&gt; EvalError -&gt; Bool
$c&gt;= :: EvalError -&gt; EvalError -&gt; Bool
&gt;= :: EvalError -&gt; EvalError -&gt; Bool
$cmax :: EvalError -&gt; EvalError -&gt; EvalError
max :: EvalError -&gt; EvalError -&gt; EvalError
$cmin :: EvalError -&gt; EvalError -&gt; EvalError
min :: EvalError -&gt; EvalError -&gt; EvalError
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259993"><span id="local-6989586621679260008"><span id="local-6989586621679260011"><span class="annot"><span class="annottext">Int -&gt; EvalError -&gt; ShowS
[EvalError] -&gt; ShowS
EvalError -&gt; [Char]
(Int -&gt; EvalError -&gt; ShowS)
-&gt; (EvalError -&gt; [Char])
-&gt; ([EvalError] -&gt; ShowS)
-&gt; Show EvalError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; EvalError -&gt; ShowS
showsPrec :: Int -&gt; EvalError -&gt; ShowS
$cshow :: EvalError -&gt; [Char]
show :: EvalError -&gt; [Char]
$cshowList :: [EvalError] -&gt; ShowS
showList :: [EvalError] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">type</span><span> </span><span id="ExpFullEnv"><span class="annot"><a href="Telomare.Eval.html#ExpFullEnv"><span class="hs-identifier hs-var">ExpFullEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Telomare.html#ExprA"><span class="hs-identifier hs-type">ExprA</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">newtype</span><span> </span><span id="BetterMap"><span class="annot"><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-var">BetterMap</span></a></span></span><span> </span><span id="local-6989586621679259325"><span class="annot"><a href="#local-6989586621679259325"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679259326"><span class="annot"><a href="#local-6989586621679259326"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BetterMap"><span class="annot"><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-var">BetterMap</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unBetterMap"><span class="annot"><span class="annottext">forall k v. BetterMap k v -&gt; Map k v
</span><a href="Telomare.Eval.html#unBetterMap"><span class="hs-identifier hs-var hs-var">unBetterMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679259325"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259326"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679259336"><span id="local-6989586621679260020"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-type">BetterMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259336"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679260025"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; BetterMap k a -&gt; BetterMap k b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679260026"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679260026"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-type">BetterMap</span></a></span><span> </span><span id="local-6989586621679260027"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679260027"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; BetterMap k b
forall k v. Map k v -&gt; BetterMap k v
</span><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-var">BetterMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map k b -&gt; BetterMap k b) -&gt; Map k b -&gt; BetterMap k b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Map k a -&gt; Map k b
forall a b. (a -&gt; b) -&gt; Map k a -&gt; Map k b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679260026"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679260027"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679259348"><span id="local-6989586621679259349"><span id="local-6989586621679260032"><span id="local-6989586621679260036"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679259348"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679259349"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-type">BetterMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259348"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259349"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679260043"><span class="annot"><span class="annottext">&lt;&gt; :: BetterMap k m -&gt; BetterMap k m -&gt; BetterMap k m
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-type">BetterMap</span></a></span><span> </span><span id="local-6989586621679260044"><span class="annot"><span class="annottext">Map k m
</span><a href="#local-6989586621679260044"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-type">BetterMap</span></a></span><span> </span><span id="local-6989586621679260045"><span class="annot"><span class="annottext">Map k m
</span><a href="#local-6989586621679260045"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k m -&gt; BetterMap k m
forall k v. Map k v -&gt; BetterMap k v
</span><a href="Telomare.Eval.html#BetterMap"><span class="hs-identifier hs-var">BetterMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map k m -&gt; BetterMap k m) -&gt; Map k m -&gt; BetterMap k m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(m -&gt; m -&gt; m) -&gt; Map k m -&gt; Map k m -&gt; Map k m
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWith</span></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">Map k m
</span><a href="#local-6989586621679260044"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map k m
</span><a href="#local-6989586621679260045"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-type">annotateEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span id="annotateEnv"><span class="annot"><span class="annottext">annotateEnv :: IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var hs-var">annotateEnv</span></a></span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679260050"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260050"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260051"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260051"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260052"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">at</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260053"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260053"><span class="hs-identifier hs-var">na</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260050"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679260054"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260054"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260055"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260055"><span class="hs-identifier hs-var">nb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260051"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260054"><span class="hs-identifier hs-var">bt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260053"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260055"><span class="hs-identifier hs-var">nb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679260059"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260059"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260060"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260060"><span class="hs-identifier hs-var">xt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260061"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260061"><span class="hs-identifier hs-var">nx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260059"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260060"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; Bool -&gt; ExpP
</span><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260061"><span class="hs-identifier hs-var">nx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260060"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679260063"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260063"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260064"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260064"><span class="hs-identifier hs-var">nx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260063"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260064"><span class="hs-identifier hs-var">nx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679260066"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260066"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260067"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260067"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260068"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260068"><span class="hs-identifier hs-var">at</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260069"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260069"><span class="hs-identifier hs-var">na</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260066"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679260070"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260070"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260071"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260071"><span class="hs-identifier hs-var">nb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260067"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260068"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679260070"><span class="hs-identifier hs-var">bt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260069"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260071"><span class="hs-identifier hs-var">nb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679260073"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260073"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; (Bool, ExpP) -&gt; (Bool, ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260073"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679260075"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260075"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; (Bool, ExpP) -&gt; (Bool, ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260075"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-type">fromFullEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-96"></span><span id="fromFullEnv"><span class="annot"><span class="annottext">fromFullEnv :: (ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var hs-var">fromFullEnv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679260078"><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-type">PairP</span></a></span><span> </span><span id="local-6989586621679260079"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260079"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260080"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260080"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260079"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260080"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679260081"><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260081"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-type">SetEnvP</span></a></span><span> </span><span id="local-6989586621679260082"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260082"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260082"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679260083"><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260083"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-type">DeferP</span></a></span><span> </span><span id="local-6989586621679260084"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260084"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260083"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260084"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679260085"><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260085"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-type">GateP</span></a></span><span> </span><span id="local-6989586621679260086"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260086"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260087"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260087"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260086"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260087"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679260088"><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260088"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-type">LeftP</span></a></span><span> </span><span id="local-6989586621679260089"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260089"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260088"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260089"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679260090"><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260090"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-type">RightP</span></a></span><span> </span><span id="local-6989586621679260091"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260091"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PRight"><span class="hs-identifier hs-var">PRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="#local-6989586621679260090"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260091"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Telomare.html#TelomareLike"><span class="hs-identifier hs-type">TelomareLike</span></a></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679260096"><span class="annot"><span class="annottext">fromTelomare :: IExpr -&gt; ExpP
</span><a href="#local-6989586621679260096"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromTelomare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool, ExpP) -&gt; ExpP
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Bool, ExpP) -&gt; ExpP) -&gt; (IExpr -&gt; (Bool, ExpP)) -&gt; IExpr -&gt; ExpP
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679260101"><span class="annot"><span class="annottext">toTelomare :: ExpP -&gt; Maybe IExpr
</span><a href="#local-6989586621679260101"><span class="hs-identifier hs-var hs-var hs-var hs-var">toTelomare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Maybe IExpr
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; Maybe IExpr) -&gt; (ExpP -&gt; IExpr) -&gt; ExpP -&gt; Maybe IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-type">partiallyEvaluate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-111"></span><span id="partiallyEvaluate"><span class="annot"><span class="annottext">partiallyEvaluate :: ExpP -&gt; IExpr
</span><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-var hs-var">partiallyEvaluate</span></a></span></span><span> </span><span id="local-6989586621679260104"><span class="annot"><span class="annottext">se :: ExpP
</span><a href="#local-6989586621679260104"><span class="hs-identifier hs-var">se</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-type">SetEnvP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#pureEval"><span class="hs-identifier hs-var">pureEval</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; (IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.Optimizer.html#optimize"><span class="hs-identifier hs-var">optimize</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260104"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-var">partiallyEvaluate</span></a></span><span> </span><span id="local-6989586621679260105"><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260105"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; IExpr) -&gt; ExpP -&gt; IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; IExpr
</span><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-var">partiallyEvaluate</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679260105"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Telomare.Eval.html#convertPT"><span class="hs-identifier hs-type">convertPT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#UnsizedRecursionToken"><span class="hs-identifier hs-type">UnsizedRecursionToken</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-115"></span><span id="convertPT"><span class="annot"><span class="annottext">convertPT :: (UnsizedRecursionToken -&gt; Int) -&gt; Term3 -&gt; Term4
</span><a href="Telomare.Eval.html#convertPT"><span class="hs-identifier hs-var hs-var">convertPT</span></a></span></span><span> </span><span id="local-6989586621679260107"><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; Int
</span><a href="#local-6989586621679260107"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span id="local-6989586621679260109"><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679260109"><span class="hs-identifier hs-var">termMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679260110"><span class="annot"><span class="annottext">unURedMap :: Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260110"><span class="hs-identifier hs-var hs-var">unURedMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex FragExprUR
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679260109"><span class="hs-identifier hs-var">termMap</span></a></span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621679260115"><span class="annot"><span class="annottext">startKey :: FragIndex
</span><a href="#local-6989586621679260115"><span class="hs-identifier hs-var hs-var">startKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragIndex
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex -&gt; FragIndex)
-&gt; ((FragIndex, FragExprUR) -&gt; FragIndex)
-&gt; (FragIndex, FragExprUR)
-&gt; FragIndex
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex, FragExprUR) -&gt; FragIndex
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((FragIndex, FragExprUR) -&gt; FragIndex)
-&gt; (FragIndex, FragExprUR) -&gt; FragIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR -&gt; (FragIndex, FragExprUR)
forall k a. Map k a -&gt; (k, a)
</span><span class="hs-identifier hs-var">Map.findMax</span></span><span> </span><span class="annot"><span class="annottext">Map FragIndex FragExprUR
</span><a href="#local-6989586621679260109"><span class="hs-identifier hs-var">termMap</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><a href="#local-6989586621679260119"><span class="hs-identifier hs-type">changeFrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span>
</span><span id="line-119"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State.State</span></span><span>
</span><span id="line-120"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>                       </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span>
</span><span id="line-122"></span><span>                         </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-123"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>      </span><span id="local-6989586621679260119"><span class="annot"><span class="annottext">changeFrag :: Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260119"><span class="hs-identifier hs-var hs-var">changeFrag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679260120"><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679260120"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#NestedSetEnvs"><span class="hs-identifier hs-type">NestedSetEnvs</span></a></span><span> </span><span id="local-6989586621679260123"><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679260123"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; Int
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. LocTag -&gt; Int -&gt; BreakState' a b
</span><a href="Telomare.html#innerChurchF"><span class="hs-identifier hs-var">innerChurchF</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="#local-6989586621679260120"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Int
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; Int
</span><a href="#local-6989586621679260107"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679260123"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">LocTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#SizingWrapper"><span class="hs-identifier hs-type">SizingWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679260126"><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679260126"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall (m :: * -&gt; *) a.
(Monad m, Plated a) =&gt;
(a -&gt; m a) -&gt; a -&gt; m a
</span><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier hs-var">transformM</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260119"><span class="hs-identifier hs-var">changeFrag</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragExprUR -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="Telomare.html#unFragExprUR"><span class="hs-identifier hs-var">unFragExprUR</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprUR
</span><a href="#local-6989586621679260126"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621679260127"><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall a.
a
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><a href="#local-6989586621679260128"><span class="hs-identifier hs-type">insertChanged</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#FragIndex"><span class="hs-identifier hs-type">FragIndex</span></a></span><span>
</span><span id="line-130"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Telomare.html#LocTag"><span class="hs-identifier hs-type">LocTag</span></a></span><span>
</span><span id="line-131"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#BreakState"><span class="hs-identifier hs-type">BreakState</span></a></span><span> </span><span class="annot"><a href="Telomare.html#RecursionPieceFrag"><span class="hs-identifier hs-type">RecursionPieceFrag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>      </span><span id="local-6989586621679260128"><span class="annot"><span class="annottext">insertChanged :: FragIndex
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; BreakState RecursionPieceFrag () ()
</span><a href="#local-6989586621679260128"><span class="hs-identifier hs-var hs-var">insertChanged</span></a></span></span><span> </span><span id="local-6989586621679260129"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260129"><span class="hs-identifier hs-var">nk</span></a></span></span><span> </span><span id="local-6989586621679260130"><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679260130"><span class="hs-identifier hs-var">nv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((), FragIndex,
  Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
 -&gt; ((), FragIndex,
     Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)))
-&gt; BreakState RecursionPieceFrag () ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260132"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260132"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260133"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260133"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260132"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260129"><span class="hs-identifier hs-var">nk</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679260130"><span class="hs-identifier hs-var">nv</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260133"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>      </span><span id="local-6989586621679260143"><span class="annot"><span class="annottext">builder :: StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  (Map FragIndex ())
</span><a href="#local-6989586621679260143"><span class="hs-identifier hs-var hs-var">builder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (BreakState RecursionPieceFrag () ())
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     (Map FragIndex ())
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a.
Monad m =&gt;
Map FragIndex (m a) -&gt; m (Map FragIndex a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (BreakState RecursionPieceFrag () ())
 -&gt; StateT
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      Identity
      (Map FragIndex ()))
-&gt; Map FragIndex (BreakState RecursionPieceFrag () ())
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     (Map FragIndex ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FragIndex
 -&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; BreakState RecursionPieceFrag () ())
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex (BreakState RecursionPieceFrag () ())
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679260146"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260146"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679260147"><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679260147"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; State
      ((), FragIndex,
       Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
      (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
forall (m :: * -&gt; *) a.
(Monad m, Plated a) =&gt;
(a -&gt; m a) -&gt; a -&gt; m a
</span><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transformM"><span class="hs-identifier hs-var">transformM</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; State
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260119"><span class="hs-identifier hs-var">changeFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF RecursionPieceFrag) LocTag
</span><a href="#local-6989586621679260147"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">State
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; (Cofree (FragExprF RecursionPieceFrag) LocTag
    -&gt; BreakState RecursionPieceFrag () ())
-&gt; BreakState RecursionPieceFrag () ()
forall a b.
StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  a
-&gt; (a
    -&gt; StateT
         ((), FragIndex,
          Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
         Identity
         b)
-&gt; StateT
     ((), FragIndex,
      Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
     Identity
     b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FragIndex
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; BreakState RecursionPieceFrag () ()
</span><a href="#local-6989586621679260128"><span class="hs-identifier hs-var">insertChanged</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260146"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260110"><span class="hs-identifier hs-var">unURedMap</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FragIndex
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679260148"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260148"><span class="hs-identifier hs-var">newMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  (Map FragIndex ())
-&gt; ((), FragIndex,
    Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
-&gt; ((), FragIndex,
    Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
forall s a. State s a -&gt; s -&gt; s
</span><span class="hs-identifier hs-var">State.execState</span></span><span> </span><span class="annot"><span class="annottext">StateT
  ((), FragIndex,
   Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag))
  Identity
  (Map FragIndex ())
</span><a href="#local-6989586621679260143"><span class="hs-identifier hs-var">builder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260115"><span class="hs-identifier hs-var">startKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260110"><span class="hs-identifier hs-var">unURedMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>      </span><span id="local-6989586621679259391"><span id="local-6989586621679259392"><span id="local-6989586621679259393"><span class="annot"><a href="#local-6989586621679260150"><span class="hs-identifier hs-type">changeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259392"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#FragExprF"><span class="hs-identifier hs-type">FragExprF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259393"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259392"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-136"></span><span>      </span><span id="local-6989586621679260150"><span class="annot"><span class="annottext">changeType :: forall a x b. FragExprF a x -&gt; FragExprF b x
</span><a href="#local-6989586621679260150"><span class="hs-identifier hs-var hs-var">changeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#ZeroFragF"><span class="hs-identifier hs-var">ZeroFragF</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#ZeroFragF"><span class="hs-identifier hs-var">ZeroFragF</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="Telomare.html#PairFragF"><span class="hs-identifier hs-type">PairFragF</span></a></span><span> </span><span id="local-6989586621679260155"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260155"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260156"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260156"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; FragExprF b x
forall a r. r -&gt; r -&gt; FragExprF a r
</span><a href="Telomare.html#PairFragF"><span class="hs-identifier hs-var">PairFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260155"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260156"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#EnvFragF"><span class="hs-identifier hs-var">EnvFragF</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#EnvFragF"><span class="hs-identifier hs-var">EnvFragF</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="Telomare.html#SetEnvFragF"><span class="hs-identifier hs-type">SetEnvFragF</span></a></span><span> </span><span id="local-6989586621679260159"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260159"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; FragExprF b x
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#SetEnvFragF"><span class="hs-identifier hs-var">SetEnvFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260159"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Telomare.html#DeferFragF"><span class="hs-identifier hs-type">DeferFragF</span></a></span><span> </span><span id="local-6989586621679260161"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260161"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragExprF b x
forall a r. FragIndex -&gt; FragExprF a r
</span><a href="Telomare.html#DeferFragF"><span class="hs-identifier hs-var">DeferFragF</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260161"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#AbortFragF"><span class="hs-identifier hs-var">AbortFragF</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#AbortFragF"><span class="hs-identifier hs-var">AbortFragF</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><a href="Telomare.html#GateFragF"><span class="hs-identifier hs-type">GateFragF</span></a></span><span> </span><span id="local-6989586621679260164"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260164"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679260165"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260165"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; FragExprF b x
forall a r. r -&gt; r -&gt; FragExprF a r
</span><a href="Telomare.html#GateFragF"><span class="hs-identifier hs-var">GateFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260164"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260165"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><a href="Telomare.html#LeftFragF"><span class="hs-identifier hs-type">LeftFragF</span></a></span><span> </span><span id="local-6989586621679260167"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260167"><span class="hs-identifier hs-var">x</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; FragExprF b x
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#LeftFragF"><span class="hs-identifier hs-var">LeftFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260167"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="Telomare.html#RightFragF"><span class="hs-identifier hs-type">RightFragF</span></a></span><span> </span><span id="local-6989586621679260169"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260169"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; FragExprF b x
forall a r. r -&gt; FragExprF a r
</span><a href="Telomare.html#RightFragF"><span class="hs-identifier hs-var">RightFragF</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679260169"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">FragExprF a x
</span><a href="Telomare.html#TraceFragF"><span class="hs-identifier hs-var">TraceFragF</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExprF b x
forall a r. FragExprF a r
</span><a href="Telomare.html#TraceFragF"><span class="hs-identifier hs-var">TraceFragF</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="Telomare.html#AuxFragF"><span class="hs-identifier hs-type">AuxFragF</span></a></span><span> </span><span id="local-6989586621679260171"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260171"><span class="hs-identifier hs-var">z</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FragExprF b x
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;convertPT should be no AuxFrags here TODO&quot;</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4
</span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4)
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF RecursionPieceFrag) LocTag
 -&gt; Cofree (FragExprF Void) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag)
forall a b. (a -&gt; b) -&gt; Map FragIndex a -&gt; Map FragIndex b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. FragExprF RecursionPieceFrag x -&gt; FragExprF Void x)
-&gt; Cofree (FragExprF RecursionPieceFrag) LocTag
-&gt; Cofree (FragExprF Void) LocTag
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
Functor f =&gt;
(forall x. f x -&gt; g x) -&gt; Cofree f a -&gt; Cofree g a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#hoistCofree"><span class="hs-identifier hs-var">hoistCofree</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF RecursionPieceFrag x -&gt; FragExprF Void x
forall x. FragExprF RecursionPieceFrag x -&gt; FragExprF Void x
forall a x b. FragExprF a x -&gt; FragExprF b x
</span><a href="#local-6989586621679260150"><span class="hs-identifier hs-var">changeType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF RecursionPieceFrag) LocTag)
</span><a href="#local-6989586621679260148"><span class="hs-identifier hs-var">newMap</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-type">findChurchSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-151"></span><span id="findChurchSize"><span class="annot"><span class="annottext">findChurchSize :: Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-var hs-var">findChurchSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Either EvalError Term4)
-&gt; (Term3 -&gt; Term4) -&gt; Term3 -&gt; Either EvalError Term4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UnsizedRecursionToken -&gt; Int) -&gt; Term3 -&gt; Term4
</span><a href="Telomare.Eval.html#convertPT"><span class="hs-identifier hs-var">convertPT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; UnsizedRecursionToken -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- findChurchSize = calculateRecursionLimits -- works fine for unit tests, but uses too much memory for tictactoe</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- we should probably redo the types so that this is also a type conversion</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-type">removeChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-156"></span><span id="removeChecks"><span class="annot"><span class="annottext">removeChecks :: Term4 -&gt; Term4
</span><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-var hs-var">removeChecks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679260177"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679260177"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679260178"><span class="annot"><span class="annottext">f :: Cofree (FragExprF a) a -&gt; Cofree (FragExprF a) a
</span><a href="#local-6989586621679260178"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-158"></span><span>        </span><span id="local-6989586621679260179"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260179"><span class="hs-identifier hs-var">anno</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF a (Cofree (FragExprF a) a)
</span><a href="Telomare.html#AbortFragF"><span class="hs-identifier hs-var">AbortFragF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260179"><span class="hs-identifier hs-var">anno</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; FragExprF a (Cofree (FragExprF a) a) -&gt; Cofree (FragExprF a) a
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragExprF a (Cofree (FragExprF a) a)
forall a r. FragIndex -&gt; FragExprF a r
</span><a href="Telomare.html#DeferFragF"><span class="hs-identifier hs-var">DeferFragF</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260180"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span id="local-6989586621679260181"><span class="annot"><span class="annottext">Cofree (FragExprF a) a
</span><a href="#local-6989586621679260181"><span class="hs-identifier hs-var">x</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) a
</span><a href="#local-6989586621679260181"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679260180"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260180"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260182"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679260182"><span class="hs-identifier hs-var">newM</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Map FragIndex (Cofree (FragExprF Void) LocTag)) FragIndex
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag)
-&gt; (FragIndex, Map FragIndex (Cofree (FragExprF Void) LocTag))
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">State.runState</span></span><span> </span><span class="annot"><span class="annottext">State (Map FragIndex (Cofree (FragExprF Void) LocTag)) FragIndex
forall {a}.
StateT
  (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex
</span><a href="#local-6989586621679260184"><span class="hs-identifier hs-var">builder</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679260177"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span id="local-6989586621679260184"><span class="annot"><span class="annottext">builder :: StateT
  (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex
</span><a href="#local-6989586621679260184"><span class="hs-identifier hs-var hs-var">builder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>        </span><span id="local-6989586621679260191"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260191"><span class="hs-identifier hs-var">envDefer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
-&gt; StateT
     (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex
forall e a. (Ord e, Enum e) =&gt; a -&gt; State (Map e a) e
</span><a href="Telomare.html#insertAndGetKey"><span class="hs-identifier hs-var">insertAndGetKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF a) LocTag
 -&gt; StateT
      (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex)
-&gt; Cofree (FragExprF a) LocTag
-&gt; StateT
     (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExprF a (Cofree (FragExprF a) LocTag)
-&gt; Cofree (FragExprF a) LocTag
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragExprF a (Cofree (FragExprF a) LocTag)
forall a r. FragExprF a r
</span><a href="Telomare.html#EnvFragF"><span class="hs-identifier hs-var">EnvFragF</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">Cofree (FragExprF a) LocTag
-&gt; StateT
     (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex
forall e a. (Ord e, Enum e) =&gt; a -&gt; State (Map e a) e
</span><a href="Telomare.html#insertAndGetKey"><span class="hs-identifier hs-var">insertAndGetKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF a) LocTag
 -&gt; StateT
      (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex)
-&gt; Cofree (FragExprF a) LocTag
-&gt; StateT
     (Map FragIndex (Cofree (FragExprF a) LocTag)) Identity FragIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
-&gt; FragExprF a (Cofree (FragExprF a) LocTag)
-&gt; Cofree (FragExprF a) LocTag
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragExprF a (Cofree (FragExprF a) LocTag)
forall a r. FragIndex -&gt; FragExprF a r
</span><a href="Telomare.html#DeferFragF"><span class="hs-identifier hs-var">DeferFragF</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679260191"><span class="hs-identifier hs-var">envDefer</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4
</span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4)
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag) -&gt; Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag)
-&gt; Map FragIndex (Cofree (FragExprF Void) LocTag)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag)
-&gt; Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag
forall a. Plated a =&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="file:///nix/store/va6c59q7x4nyfihgh321rihg1piy6vci-lens-5.2.3-doc/share/doc/lens-5.2.3/html/src/Control.Lens.Plated.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree (FragExprF Void) LocTag -&gt; Cofree (FragExprF Void) LocTag
forall {a} {a}. Cofree (FragExprF a) a -&gt; Cofree (FragExprF a) a
</span><a href="#local-6989586621679260178"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679260182"><span class="hs-identifier hs-var">newM</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Telomare.Eval.html#convertAbortMessage"><span class="hs-identifier hs-type">convertAbortMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-167"></span><span id="convertAbortMessage"><span class="annot"><span class="annottext">convertAbortMessage :: IExpr -&gt; [Char]
</span><a href="Telomare.Eval.html#convertAbortMessage"><span class="hs-identifier hs-var hs-var">convertAbortMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#AbortRecursion"><span class="hs-identifier hs-var">AbortRecursion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;recursion overflow (should be caught by other means)&quot;</span></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="Telomare.html#AbortUser"><span class="hs-identifier hs-type">AbortUser</span></a></span><span> </span><span id="local-6989586621679260197"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260197"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;user abort: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; [Char]
</span><a href="Telomare.html#g2s"><span class="hs-identifier hs-var">g2s</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260197"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#AbortAny"><span class="hs-identifier hs-var">AbortAny</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;user abort of all possible abort reasons (non-deterministic input)&quot;</span></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679260200"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260200"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unexpected abort: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260200"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-type">runStaticChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-174"></span><span id="runStaticChecks"><span class="annot"><span class="annottext">runStaticChecks :: Term4 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-var hs-var">runStaticChecks</span></a></span></span><span> </span><span id="local-6989586621679260203"><span class="annot"><span class="annottext">t :: Term4
</span><a href="#local-6989586621679260203"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679260204"><span class="annot"><span class="annottext">Map FragIndex (Cofree (FragExprF Void) LocTag)
</span><a href="#local-6989586621679260204"><span class="hs-identifier hs-var">termMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679260205"><span class="annot"><span class="annottext">result :: Maybe IExpr
</span><a href="#local-6989586621679260205"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe IExpr -&gt; Maybe IExpr -&gt; Maybe IExpr)
-&gt; Maybe IExpr -&gt; Term4 -&gt; Maybe IExpr
</span><a href="Telomare.Possible.html#evalA"><span class="hs-identifier hs-var">evalA</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe IExpr -&gt; Maybe IExpr -&gt; Maybe IExpr
forall {a} {a}. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679260206"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; Maybe IExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679260203"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-176"></span><span>      </span><span id="local-6989586621679260206"><span class="annot"><span class="annottext">combine :: Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679260206"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679260207"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679260207"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260208"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679260208"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679260207"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679260208"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679260209"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679260209"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679260209"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
</span><a href="#local-6989586621679260205"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679260203"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679260210"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260210"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError Term4
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError Term4)
-&gt; ([Char] -&gt; EvalError) -&gt; [Char] -&gt; Either EvalError Term4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; EvalError
</span><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Either EvalError Term4)
-&gt; [Char] -&gt; Either EvalError Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; [Char]
</span><a href="Telomare.Eval.html#convertAbortMessage"><span class="hs-identifier hs-var">convertAbortMessage</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260210"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Telomare.Eval.html#compileMain"><span class="hs-identifier hs-type">compileMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-185"></span><span id="compileMain"><span class="annot"><span class="annottext">compileMain :: Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compileMain"><span class="hs-identifier hs-var hs-var">compileMain</span></a></span></span><span> </span><span id="local-6989586621679260212"><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260212"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PartialType -&gt; Term3 -&gt; Maybe TypeCheckError
</span><a href="Telomare.TypeChecker.html#typeCheck"><span class="hs-identifier hs-var">typeCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PartialType -&gt; PartialType -&gt; PartialType
</span><a href="Telomare.html#PairTypeP"><span class="hs-identifier hs-var">PairTypeP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PartialType -&gt; PartialType -&gt; PartialType
</span><a href="Telomare.html#ArrTypeP"><span class="hs-identifier hs-var">ArrTypeP</span></a></span><span> </span><span class="annot"><span class="annottext">PartialType
</span><a href="Telomare.html#ZeroTypeP"><span class="hs-identifier hs-var">ZeroTypeP</span></a></span><span> </span><span class="annot"><span class="annottext">PartialType
</span><a href="Telomare.html#ZeroTypeP"><span class="hs-identifier hs-var">ZeroTypeP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PartialType
</span><a href="Telomare.html#AnyType"><span class="hs-identifier hs-var">AnyType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260212"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679260217"><span class="annot"><span class="annottext">TypeCheckError
</span><a href="#local-6989586621679260217"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError IExpr)
-&gt; EvalError -&gt; Either EvalError IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeCheckError -&gt; EvalError
</span><a href="Telomare.Eval.html#TCE"><span class="hs-identifier hs-var">TCE</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCheckError
</span><a href="#local-6989586621679260217"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">Maybe TypeCheckError
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Either EvalError Term4)
-&gt; Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260212"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-comment">-- TODO add runStaticChecks back in</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-type">compileUnitTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-190"></span><span id="compileUnitTest"><span class="annot"><span class="annottext">compileUnitTest :: Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-var hs-var">compileUnitTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Either EvalError Term4)
-&gt; Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-var">runStaticChecks</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-193"></span><span id="compile"><span class="annot"><span class="annottext">compile :: (Term4 -&gt; Either EvalError Term4)
-&gt; Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span id="local-6989586621679260220"><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
</span><a href="#local-6989586621679260220"><span class="hs-identifier hs-var">staticCheck</span></a></span></span><span> </span><span id="local-6989586621679260221"><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260221"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either EvalError IExpr -&gt; Either EvalError IExpr
forall a. [Char] -&gt; a -&gt; a
</span><a href="Telomare.Eval.html#debugTrace"><span class="hs-identifier hs-var">debugTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compiling term3:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; [Char]
forall p. PrettyPrintable p =&gt; p -&gt; [Char]
</span><a href="PrettyPrint.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260221"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><span class="annottext">(Either EvalError IExpr -&gt; Either EvalError IExpr)
-&gt; Either EvalError IExpr -&gt; Either EvalError IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Maybe IExpr
forall a. TelomareLike a =&gt; a -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var">toTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Maybe IExpr) -&gt; (Term4 -&gt; Term4) -&gt; Term4 -&gt; Maybe IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Term4
</span><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-var">removeChecks</span></a></span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Maybe IExpr)
-&gt; Either EvalError Term4 -&gt; Either EvalError (Maybe IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-var">findChurchSize</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260221"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Either EvalError Term4
-&gt; (Term4 -&gt; Either EvalError Term4) -&gt; Either EvalError Term4
forall a b.
Either EvalError a
-&gt; (a -&gt; Either EvalError b) -&gt; Either EvalError b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
</span><a href="#local-6989586621679260220"><span class="hs-identifier hs-var">staticCheck</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679260222"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260222"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Either EvalError IExpr
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260222"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="Telomare.Eval.html#CompileConversionError"><span class="hs-identifier hs-var">CompileConversionError</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679260223"><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679260223"><span class="hs-identifier hs-var">e</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679260223"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- converts between easily understood Haskell types and untyped IExprs around an iteration of a Telomare expression</span><span>
</span><span id="line-200"></span><span class="annot"><a href="Telomare.Eval.html#funWrap"><span class="hs-identifier hs-type">funWrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span id="funWrap"><span class="annot"><span class="annottext">funWrap :: (IExpr -&gt; IExpr)
-&gt; IExpr -&gt; Maybe ([Char], IExpr) -&gt; ([Char], Maybe IExpr)
</span><a href="Telomare.Eval.html#funWrap"><span class="hs-identifier hs-var hs-var">funWrap</span></a></span></span><span> </span><span id="local-6989586621679260225"><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="#local-6989586621679260225"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679260226"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260226"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679260227"><span class="annot"><span class="annottext">Maybe ([Char], IExpr)
</span><a href="#local-6989586621679260227"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679260228"><span class="annot"><span class="annottext">iexpInp :: IExpr
</span><a href="#local-6989586621679260228"><span class="hs-identifier hs-var hs-var">iexpInp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ([Char], IExpr)
</span><a href="#local-6989586621679260227"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">Maybe ([Char], IExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260229"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260229"><span class="hs-identifier hs-var">userInp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260230"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260230"><span class="hs-identifier hs-var">oldState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; IExpr
</span><a href="Telomare.html#s2g"><span class="hs-identifier hs-var">s2g</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260229"><span class="hs-identifier hs-var">userInp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260230"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="#local-6989586621679260225"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260226"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260228"><span class="hs-identifier hs-var">iexpInp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;aborted&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679260233"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260233"><span class="hs-identifier hs-var">disp</span></a></span></span><span> </span><span id="local-6989586621679260234"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260234"><span class="hs-identifier hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; [Char]
</span><a href="Telomare.html#g2s"><span class="hs-identifier hs-var">g2s</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260233"><span class="hs-identifier hs-var">disp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Maybe IExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260234"><span class="hs-identifier hs-var">newState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679260235"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260235"><span class="hs-identifier hs-var">z</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;runtime error, dumped:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260235"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span id="local-6989586621679259424"><span class="annot"><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-type">runMainCore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679259424"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679259424"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-211"></span><span id="runMainCore"><span class="annot"><span class="annottext">runMainCore :: forall a. [Char] -&gt; [Char] -&gt; (IExpr -&gt; IO a) -&gt; IO a
</span><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-var hs-var">runMainCore</span></a></span></span><span> </span><span id="local-6989586621679260247"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260247"><span class="hs-identifier hs-var">preludeString</span></a></span></span><span> </span><span id="local-6989586621679260248"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260248"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679260249"><span class="annot"><span class="annottext">IExpr -&gt; IO a
</span><a href="#local-6989586621679260249"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679260250"><span class="hs-identifier hs-type">prelude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>      </span><span id="local-6989586621679260250"><span class="annot"><span class="annottext">prelude :: [([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260250"><span class="hs-identifier hs-var hs-var">prelude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] [([Char], AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier hs-var">parsePrelude</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260247"><span class="hs-identifier hs-var">preludeString</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260251"><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260251"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260251"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-216"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679260252"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260252"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [([Char], AnnotatedUPT)]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260252"><span class="hs-identifier hs-var">pe</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compileMain"><span class="hs-identifier hs-var">compileMain</span></a></span><span> </span><span class="annot"><span class="annottext">(Term3 -&gt; Either EvalError IExpr)
-&gt; Either [Char] Term3 -&gt; Either [Char] (Either EvalError IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)] -&gt; [Char] -&gt; Either [Char] Term3
</span><a href="Telomare.Resolver.html#parseMain"><span class="hs-identifier hs-var">parseMain</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260250"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260248"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-219"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679260253"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260253"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO a) -&gt; [Char] -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;failed to parse &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260248"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260253"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260255"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO a
</span><a href="#local-6989586621679260249"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260256"><span class="annot"><span class="annottext">Either EvalError IExpr
</span><a href="#local-6989586621679260256"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO a) -&gt; [Char] -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compilation failed somehow, with result &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either EvalError IExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Either EvalError IExpr
</span><a href="#local-6989586621679260256"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Telomare.Eval.html#runMain_"><span class="hs-identifier hs-type">runMain_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-224"></span><span id="runMain_"><span class="annot"><span class="annottext">runMain_ :: [Char] -&gt; [Char] -&gt; IO [Char]
</span><a href="Telomare.Eval.html#runMain_"><span class="hs-identifier hs-var hs-var">runMain_</span></a></span></span><span> </span><span id="local-6989586621679260258"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260258"><span class="hs-identifier hs-var">preludeString</span></a></span></span><span> </span><span id="local-6989586621679260259"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260259"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; (IExpr -&gt; IO [Char]) -&gt; IO [Char]
forall a. [Char] -&gt; [Char] -&gt; (IExpr -&gt; IO a) -&gt; IO a
</span><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-var">runMainCore</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260258"><span class="hs-identifier hs-var">preludeString</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260259"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-var">evalLoop_</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Telomare.Eval.html#runMain"><span class="hs-identifier hs-type">runMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span id="runMain"><span class="annot"><span class="annottext">runMain :: [Char] -&gt; [Char] -&gt; IO ()
</span><a href="Telomare.Eval.html#runMain"><span class="hs-identifier hs-var hs-var">runMain</span></a></span></span><span> </span><span id="local-6989586621679260262"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260262"><span class="hs-identifier hs-var">preludeString</span></a></span></span><span> </span><span id="local-6989586621679260263"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260263"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; (IExpr -&gt; IO ()) -&gt; IO ()
forall a. [Char] -&gt; [Char] -&gt; (IExpr -&gt; IO a) -&gt; IO a
</span><a href="Telomare.Eval.html#runMainCore"><span class="hs-identifier hs-var">runMainCore</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260262"><span class="hs-identifier hs-var">preludeString</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260263"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO ()
</span><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-var">evalLoop</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Telomare.Eval.html#schemeEval"><span class="hs-identifier hs-type">schemeEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span id="schemeEval"><span class="annot"><span class="annottext">schemeEval :: IExpr -&gt; IO ()
</span><a href="Telomare.Eval.html#schemeEval"><span class="hs-identifier hs-var hs-var">schemeEval</span></a></span></span><span> </span><span id="local-6989586621679260266"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260266"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;scheme.txt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260266"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679260268"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679260268"><span class="hs-identifier hs-var">mhout</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">createProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">shell</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;chez-script runtime.so&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">std_out</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CreatePipe</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679260269"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260269"><span class="hs-identifier hs-var">scheme</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO [Char]
</span><span class="hs-identifier hs-var">hGetContents</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679260268"><span class="hs-identifier hs-var">mhout</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260269"><span class="hs-identifier hs-var">scheme</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-type">evalLoopCore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-237"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-239"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-241"></span><span id="evalLoopCore"><span class="annot"><span class="annottext">evalLoopCore :: IExpr
-&gt; ([Char] -&gt; [Char] -&gt; IO [Char])
-&gt; [Char]
-&gt; [[Char]]
-&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var hs-var">evalLoopCore</span></a></span></span><span> </span><span id="local-6989586621679260272"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260272"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span id="local-6989586621679260273"><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO [Char]
</span><a href="#local-6989586621679260273"><span class="hs-identifier hs-var">accumFn</span></a></span></span><span> </span><span id="local-6989586621679260274"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260274"><span class="hs-identifier hs-var">initAcc</span></a></span></span><span> </span><span id="local-6989586621679260275"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260275"><span class="hs-identifier hs-var">manualInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679260276"><span class="hs-identifier hs-type">wrappedEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>      </span><span id="local-6989586621679260276"><span class="annot"><span class="annottext">wrappedEval :: Maybe ([Char], IExpr) -&gt; ([Char], Maybe IExpr)
</span><a href="#local-6989586621679260276"><span class="hs-identifier hs-var hs-var">wrappedEval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr)
-&gt; IExpr -&gt; Maybe ([Char], IExpr) -&gt; ([Char], Maybe IExpr)
</span><a href="Telomare.Eval.html#funWrap"><span class="hs-identifier hs-var">funWrap</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
forall a. AbstractRunTime a =&gt; a -&gt; a
</span><a href="Telomare.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260272"><span class="hs-identifier hs-var">iexpr</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><a href="#local-6989586621679260278"><span class="hs-identifier hs-type">mainLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-245"></span><span>      </span><span id="local-6989586621679260278"><span class="annot"><span class="annottext">mainLoop :: [Char] -&gt; [[Char]] -&gt; Maybe ([Char], IExpr) -&gt; IO [Char]
</span><a href="#local-6989586621679260278"><span class="hs-identifier hs-var hs-var">mainLoop</span></a></span></span><span> </span><span id="local-6989586621679260279"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260279"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679260280"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260280"><span class="hs-identifier hs-var">strInput</span></a></span></span><span> </span><span id="local-6989586621679260281"><span class="annot"><span class="annottext">Maybe ([Char], IExpr)
</span><a href="#local-6989586621679260281"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260282"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260282"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260283"><span class="annot"><span class="annottext">Maybe IExpr
</span><a href="#local-6989586621679260283"><span class="hs-identifier hs-var">nextState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ([Char], IExpr) -&gt; ([Char], Maybe IExpr)
</span><a href="#local-6989586621679260276"><span class="hs-identifier hs-var">wrappedEval</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ([Char], IExpr)
</span><a href="#local-6989586621679260281"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span id="local-6989586621679260284"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260284"><span class="hs-identifier hs-var">newAcc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO [Char]
</span><a href="#local-6989586621679260273"><span class="hs-identifier hs-var">accumFn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260279"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260282"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-248"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe IExpr
</span><a href="#local-6989586621679260283"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-249"></span><span>          </span><span class="annot"><span class="annottext">Maybe IExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO [Char]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260279"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-250"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO [Char]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO [Char]) -&gt; [Char] -&gt; IO [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260284"><span class="hs-identifier hs-var">newAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;done&quot;</span></span><span>
</span><span id="line-251"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679260285"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260285"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679260286"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260286"><span class="hs-identifier hs-var">inp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260287"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260287"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-253"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260280"><span class="hs-identifier hs-var">strInput</span></a></span><span>
</span><span id="line-254"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ([Char], [[Char]]))
-&gt; IO [Char] -&gt; IO ([Char], [[Char]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getLine</span></span><span>
</span><span id="line-255"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">([Char], [[Char]]) -&gt; IO ([Char], [[Char]])
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260280"><span class="hs-identifier hs-var">strInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260280"><span class="hs-identifier hs-var">strInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; Maybe ([Char], IExpr) -&gt; IO [Char]
</span><a href="#local-6989586621679260278"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260284"><span class="hs-identifier hs-var">newAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260287"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ([Char], IExpr) -&gt; IO [Char])
-&gt; Maybe ([Char], IExpr) -&gt; IO [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Char], IExpr) -&gt; Maybe ([Char], IExpr)
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260286"><span class="hs-identifier hs-var">inp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260285"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; Maybe ([Char], IExpr) -&gt; IO [Char]
</span><a href="#local-6989586621679260278"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260274"><span class="hs-identifier hs-var">initAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260275"><span class="hs-identifier hs-var">manualInput</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ([Char], IExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-type">evalLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span id="evalLoop"><span class="annot"><span class="annottext">evalLoop :: IExpr -&gt; IO ()
</span><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-var hs-var">evalLoop</span></a></span></span><span> </span><span id="local-6989586621679260292"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260292"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [Char] -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO [Char] -&gt; IO ()) -&gt; IO [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; ([Char] -&gt; [Char] -&gt; IO [Char])
-&gt; [Char]
-&gt; [[Char]]
-&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var">evalLoopCore</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260292"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO [Char]
forall {p}. p -&gt; [Char] -&gt; IO [Char]
</span><a href="#local-6989586621679260293"><span class="hs-identifier hs-var">printAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679260293"><span class="annot"><span class="annottext">printAcc :: p -&gt; [Char] -&gt; IO [Char]
</span><a href="#local-6989586621679260293"><span class="hs-identifier hs-var hs-var">printAcc</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679260296"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260296"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260296"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; IO [Char]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><a href="Telomare.Eval.html#evalLoopWithInput"><span class="hs-identifier hs-type">evalLoopWithInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-267"></span><span id="evalLoopWithInput"><span class="annot"><span class="annottext">evalLoopWithInput :: [[Char]] -&gt; IExpr -&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoopWithInput"><span class="hs-identifier hs-var hs-var">evalLoopWithInput</span></a></span></span><span> </span><span id="local-6989586621679260298"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260298"><span class="hs-identifier hs-var">inputList</span></a></span></span><span> </span><span id="local-6989586621679260299"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260299"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; ([Char] -&gt; [Char] -&gt; IO [Char])
-&gt; [Char]
-&gt; [[Char]]
-&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var">evalLoopCore</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260299"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO [Char]
forall {f :: * -&gt; *}. Applicative f =&gt; [Char] -&gt; [Char] -&gt; f [Char]
</span><a href="#local-6989586621679260300"><span class="hs-identifier hs-var">printAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260298"><span class="hs-identifier hs-var">inputList</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679260300"><span class="annot"><span class="annottext">printAcc :: [Char] -&gt; [Char] -&gt; f [Char]
</span><a href="#local-6989586621679260300"><span class="hs-identifier hs-var hs-var">printAcc</span></a></span></span><span> </span><span id="local-6989586621679260310"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260310"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679260311"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260311"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260310"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-270"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f [Char]
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260311"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-271"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f [Char]
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260310"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260311"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Telomare.Eval.html#runMainWithInput"><span class="hs-identifier hs-type">runMainWithInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-274"></span><span id="runMainWithInput"><span class="annot"><span class="annottext">runMainWithInput :: [[Char]] -&gt; [Char] -&gt; [Char] -&gt; IO [Char]
</span><a href="Telomare.Eval.html#runMainWithInput"><span class="hs-identifier hs-var hs-var">runMainWithInput</span></a></span></span><span> </span><span id="local-6989586621679260313"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260313"><span class="hs-identifier hs-var">inputList</span></a></span></span><span> </span><span id="local-6989586621679260314"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260314"><span class="hs-identifier hs-var">preludeString</span></a></span></span><span> </span><span id="local-6989586621679260315"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260315"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679260316"><span class="hs-identifier hs-type">prelude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span>      </span><span id="local-6989586621679260316"><span class="annot"><span class="annottext">prelude :: [([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260316"><span class="hs-identifier hs-var hs-var">prelude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] [([Char], AnnotatedUPT)]
</span><a href="Telomare.Parser.html#parsePrelude"><span class="hs-identifier hs-var">parsePrelude</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260314"><span class="hs-identifier hs-var">preludeString</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-278"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260317"><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260317"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260317"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-279"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679260318"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260318"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [([Char], AnnotatedUPT)]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260318"><span class="hs-identifier hs-var">pe</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compileMain"><span class="hs-identifier hs-var">compileMain</span></a></span><span> </span><span class="annot"><span class="annottext">(Term3 -&gt; Either EvalError IExpr)
-&gt; Either [Char] Term3 -&gt; Either [Char] (Either EvalError IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)] -&gt; [Char] -&gt; Either [Char] Term3
</span><a href="Telomare.Resolver.html#parseMain"><span class="hs-identifier hs-var">parseMain</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260316"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260315"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679260319"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260319"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO [Char]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO [Char]) -&gt; [Char] -&gt; IO [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;failed to parse &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260315"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260319"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260320"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260320"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; IExpr -&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoopWithInput"><span class="hs-identifier hs-var">evalLoopWithInput</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260313"><span class="hs-identifier hs-var">inputList</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260320"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260321"><span class="annot"><span class="annottext">Either EvalError IExpr
</span><a href="#local-6989586621679260321"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO [Char]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO [Char]) -&gt; [Char] -&gt; IO [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compilation failed somehow, with result &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either EvalError IExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Either EvalError IExpr
</span><a href="#local-6989586621679260321"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><span class="hs-comment">-- |Same as `evalLoop`, but keeping what was displayed.</span></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-type">evalLoop_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-288"></span><span id="evalLoop_"><span class="annot"><span class="annottext">evalLoop_ :: IExpr -&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-var hs-var">evalLoop_</span></a></span></span><span> </span><span id="local-6989586621679260322"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260322"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr
-&gt; ([Char] -&gt; [Char] -&gt; IO [Char])
-&gt; [Char]
-&gt; [[Char]]
-&gt; IO [Char]
</span><a href="Telomare.Eval.html#evalLoopCore"><span class="hs-identifier hs-var">evalLoopCore</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260322"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO [Char]
forall {f :: * -&gt; *}. Applicative f =&gt; [Char] -&gt; [Char] -&gt; f [Char]
</span><a href="#local-6989586621679260323"><span class="hs-identifier hs-var">printAcc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621679260323"><span class="annot"><span class="annottext">printAcc :: [Char] -&gt; [Char] -&gt; f [Char]
</span><a href="#local-6989586621679260323"><span class="hs-identifier hs-var hs-var">printAcc</span></a></span></span><span> </span><span id="local-6989586621679260333"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260333"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679260334"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260334"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260333"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-291"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f [Char]
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260334"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-292"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f [Char]
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260333"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260334"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Telomare.Eval.html#calculateRecursionLimits"><span class="hs-identifier hs-type">calculateRecursionLimits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-295"></span><span id="calculateRecursionLimits"><span class="annot"><span class="annottext">calculateRecursionLimits :: Term3 -&gt; Either EvalError Term4
</span><a href="Telomare.Eval.html#calculateRecursionLimits"><span class="hs-identifier hs-var hs-var">calculateRecursionLimits</span></a></span></span><span> </span><span id="local-6989586621679260336"><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260336"><span class="hs-identifier hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679260337"><span class="hs-identifier hs-type">abortExprToTerm4'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.Possible.html#AbortExpr"><span class="hs-identifier hs-type">AbortExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span id="local-6989586621679260337"><span class="annot"><span class="annottext">abortExprToTerm4' :: AbortExpr -&gt; Either IExpr Term4
</span><a href="#local-6989586621679260337"><span class="hs-identifier hs-var hs-var">abortExprToTerm4'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbortExpr -&gt; Either IExpr Term4
forall g (f :: * -&gt; *).
(Base g ~ f, BasicBase f, StuckBase f, AbortBase f, Foldable f,
 Recursive g) =&gt;
g -&gt; Either IExpr Term4
</span><a href="Telomare.Possible.html#abortExprToTerm4"><span class="hs-identifier hs-var">abortExprToTerm4</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span id="local-6989586621679260339"><span class="annot"><span class="annottext">limitSize :: Int
</span><a href="#local-6989586621679260339"><span class="hs-identifier hs-var hs-var">limitSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(AbortExpr -&gt; Either IExpr Term4)
-&gt; Either UnsizedRecursionToken AbortExpr
-&gt; Either UnsizedRecursionToken (Either IExpr Term4)
forall a b.
(a -&gt; b)
-&gt; Either UnsizedRecursionToken a -&gt; Either UnsizedRecursionToken b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">AbortExpr -&gt; Either IExpr Term4
</span><a href="#local-6989586621679260337"><span class="hs-identifier hs-var">abortExprToTerm4'</span></a></span><span> </span><span class="annot"><span class="annottext">(Either UnsizedRecursionToken AbortExpr
 -&gt; Either UnsizedRecursionToken (Either IExpr Term4))
-&gt; (UnsizedExpr -&gt; Either UnsizedRecursionToken AbortExpr)
-&gt; UnsizedExpr
-&gt; Either UnsizedRecursionToken (Either IExpr Term4)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnsizedExpr -&gt; Either UnsizedRecursionToken AbortExpr
</span><a href="Telomare.Possible.html#sizeTerm"><span class="hs-identifier hs-var">sizeTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260339"><span class="hs-identifier hs-var">limitSize</span></a></span><span> </span><span class="annot"><span class="annottext">(UnsizedExpr -&gt; Either UnsizedRecursionToken (Either IExpr Term4))
-&gt; UnsizedExpr -&gt; Either UnsizedRecursionToken (Either IExpr Term4)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term3 -&gt; UnsizedExpr
</span><a href="Telomare.Possible.html#term3ToUnsizedExpr"><span class="hs-identifier hs-var">term3ToUnsizedExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260339"><span class="hs-identifier hs-var">limitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679260336"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679260340"><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679260340"><span class="hs-identifier hs-var">urt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError Term4
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError Term4)
-&gt; EvalError -&gt; Either EvalError Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken -&gt; EvalError
</span><a href="Telomare.Eval.html#RecursionLimitError"><span class="hs-identifier hs-var">RecursionLimitError</span></a></span><span> </span><span class="annot"><span class="annottext">UnsizedRecursionToken
</span><a href="#local-6989586621679260340"><span class="hs-identifier hs-var">urt</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260341"><span class="annot"><span class="annottext">Either IExpr Term4
</span><a href="#local-6989586621679260341"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IExpr Term4
</span><a href="#local-6989586621679260341"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679260342"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260342"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError Term4
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError Term4)
-&gt; (IExpr -&gt; EvalError) -&gt; IExpr -&gt; Either EvalError Term4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; EvalError
</span><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; EvalError) -&gt; (IExpr -&gt; [Char]) -&gt; IExpr -&gt; EvalError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; [Char]
</span><a href="Telomare.Eval.html#convertAbortMessage"><span class="hs-identifier hs-var">convertAbortMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; Either EvalError Term4)
-&gt; IExpr -&gt; Either EvalError Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260342"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679260343"><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679260343"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Either EvalError Term4
forall a. a -&gt; Either EvalError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679260343"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Telomare.Eval.html#eval2IExpr"><span class="hs-identifier hs-type">eval2IExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-306"></span><span id="eval2IExpr"><span class="annot"><span class="annottext">eval2IExpr :: [([Char], AnnotatedUPT)] -&gt; [Char] -&gt; Either [Char] IExpr
</span><a href="Telomare.Eval.html#eval2IExpr"><span class="hs-identifier hs-var hs-var">eval2IExpr</span></a></span></span><span> </span><span id="local-6989586621679260345"><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260345"><span class="hs-identifier hs-var">prelude</span></a></span></span><span> </span><span id="local-6989586621679260346"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260346"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ParseErrorBundle [Char] Void -&gt; [Char])
-&gt; (AnnotatedUPT -&gt; AnnotatedUPT)
-&gt; Either (ParseErrorBundle [Char] Void) AnnotatedUPT
-&gt; Either [Char] AnnotatedUPT
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Either a c -&gt; Either b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">ParseErrorBundle [Char] Void -&gt; [Char]
forall s e.
(VisualStream s, TraversableStream s, ShowErrorComponent e) =&gt;
ParseErrorBundle s e -&gt; [Char]
</span><a href="file:///nix/store/rf55ybn55ssrz2kwdgpi5n38b48gkzss-megaparsec-9.6.1-doc/share/doc/megaparsec-9.6.1/html/src/Text.Megaparsec.Error.html#errorBundlePretty"><span class="hs-identifier hs-var">errorBundlePretty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679260347"><span class="annot"><span class="annottext">AnnotatedUPT
</span><a href="#local-6989586621679260347"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag -&gt; UnprocessedParsedTermF AnnotatedUPT -&gt; AnnotatedUPT
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
-&gt; AnnotatedUPT -&gt; UnprocessedParsedTermF AnnotatedUPT
forall r. [([Char], r)] -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LetUPF"><span class="hs-identifier hs-var">LetUPF</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260345"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUPT
</span><a href="#local-6989586621679260347"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parsec Void [Char] AnnotatedUPT
-&gt; [Char]
-&gt; [Char]
-&gt; Either (ParseErrorBundle [Char] Void) AnnotatedUPT
forall e s a.
Parsec e s a -&gt; [Char] -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><a href="file:///nix/store/rf55ybn55ssrz2kwdgpi5n38b48gkzss-megaparsec-9.6.1-doc/share/doc/megaparsec-9.6.1/html/src/Text.Megaparsec.html#runParser"><span class="hs-identifier hs-var">runParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)] -&gt; Parsec Void [Char] AnnotatedUPT
</span><a href="Telomare.Parser.html#parseOneExprOrTopLevelDefs"><span class="hs-identifier hs-var">parseOneExprOrTopLevelDefs</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260345"><span class="hs-identifier hs-var">prelude</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260346"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>                           </span><span class="annot"><span class="annottext">Either [Char] AnnotatedUPT
-&gt; (AnnotatedUPT -&gt; Either [Char] Term3) -&gt; Either [Char] Term3
forall a b.
Either [Char] a -&gt; (a -&gt; Either [Char] b) -&gt; Either [Char] b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)] -&gt; AnnotatedUPT -&gt; Either [Char] Term3
</span><a href="Telomare.Resolver.html#process"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260345"><span class="hs-identifier hs-var">prelude</span></a></span><span>
</span><span id="line-308"></span><span>                           </span><span class="annot"><span class="annottext">Either [Char] Term3
-&gt; (Term3 -&gt; Either [Char] IExpr) -&gt; Either [Char] IExpr
forall a b.
Either [Char] a -&gt; (a -&gt; Either [Char] b) -&gt; Either [Char] b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; [Char])
-&gt; Either EvalError IExpr -&gt; Either [Char] IExpr
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Either EvalError IExpr -&gt; Either [Char] IExpr)
-&gt; (Term3 -&gt; Either EvalError IExpr)
-&gt; Term3
-&gt; Either [Char] IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-var">compileUnitTest</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Telomare.Eval.html#tagIExprWithEval"><span class="hs-identifier hs-type">tagIExprWithEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExprF"><span class="hs-identifier hs-type">IExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span id="tagIExprWithEval"><span class="annot"><span class="annottext">tagIExprWithEval :: IExpr -&gt; Cofree IExprF (Int, IExpr)
</span><a href="Telomare.Eval.html#tagIExprWithEval"><span class="hs-identifier hs-var hs-var">tagIExprWithEval</span></a></span></span><span> </span><span id="local-6989586621679260350"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260350"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
-&gt; Int -&gt; Cofree IExprF (Int, IExpr)
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; IExpr -&gt; State Int (Cofree IExprF (Int, IExpr))
forall t a. Recursive t =&gt; (Base t (t, a) -&gt; a) -&gt; t -&gt; a
forall a. (Base IExpr (IExpr, a) -&gt; a) -&gt; IExpr -&gt; a
</span><a href="file:///nix/store/nkxcfn1kvlkh491i67549y0m2b8jji3n-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#para"><span class="hs-identifier hs-var">para</span></a></span><span> </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
-&gt; State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260351"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260350"><span class="hs-identifier hs-var">iexpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><a href="#local-6989586621679260352"><span class="hs-identifier hs-type">statePlus1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621679260352"><span class="annot"><span class="annottext">statePlus1 :: State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var hs-var">statePlus1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-314"></span><span>      </span><span id="local-6989586621679260353"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260353"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; State Int Int
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260353"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><a href="#local-6989586621679260351"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/nkxcfn1kvlkh491i67549y0m2b8jji3n-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-318"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-319"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExprF"><span class="hs-identifier hs-type">IExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExprF"><span class="hs-identifier hs-type">IExprF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679260351"><span class="annot"><span class="annottext">alg :: Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
-&gt; State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260351"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
IExprF (IExpr, State Int (Cofree IExprF (Int, IExpr)))
</span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>      </span><span id="local-6989586621679260357"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260357"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260357"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExprF (Cofree IExprF (Int, IExpr))
forall r. IExprF r
</span><a href="Telomare.html#ZeroF"><span class="hs-identifier hs-var">ZeroF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
IExprF (IExpr, State Int (Cofree IExprF (Int, IExpr)))
</span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>      </span><span id="local-6989586621679260359"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260359"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260359"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExprF (Cofree IExprF (Int, IExpr))
forall r. IExprF r
</span><a href="Telomare.html#EnvF"><span class="hs-identifier hs-var">EnvF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">Base IExpr (IExpr, State Int (Cofree IExprF (Int, IExpr)))
IExprF (IExpr, State Int (Cofree IExprF (Int, IExpr)))
</span><a href="Telomare.html#TraceF"><span class="hs-identifier hs-var">TraceF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>      </span><span id="local-6989586621679260361"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260361"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260361"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">IExprF (Cofree IExprF (Int, IExpr))
forall r. IExprF r
</span><a href="Telomare.html#TraceF"><span class="hs-identifier hs-var">TraceF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-type">SetEnvF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260363"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260363"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260364"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260364"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621679260365"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260365"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span id="local-6989586621679260366"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260366"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260364"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260365"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260363"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#SetEnvF"><span class="hs-identifier hs-var">SetEnvF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260366"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><a href="Telomare.html#DeferF"><span class="hs-identifier hs-type">DeferF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260368"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260368"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260369"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260369"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>      </span><span id="local-6989586621679260370"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260370"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span id="local-6989586621679260371"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260371"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260369"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260370"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260368"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#DeferF"><span class="hs-identifier hs-var">DeferF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260371"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="Telomare.html#PLeftF"><span class="hs-identifier hs-type">PLeftF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260373"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260373"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260374"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260374"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>      </span><span id="local-6989586621679260375"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260375"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-342"></span><span>      </span><span id="local-6989586621679260376"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260376"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260374"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260375"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260373"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#PLeftF"><span class="hs-identifier hs-var">PLeftF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260376"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="Telomare.html#PRightF"><span class="hs-identifier hs-type">PRightF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260378"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260378"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260379"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260379"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>      </span><span id="local-6989586621679260380"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260380"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-346"></span><span>      </span><span id="local-6989586621679260381"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260381"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260379"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260380"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PRight"><span class="hs-identifier hs-var">PRight</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260378"><span class="hs-identifier hs-var">iexpr0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr) -&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; IExprF r
</span><a href="Telomare.html#PRightF"><span class="hs-identifier hs-var">PRightF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260381"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="Telomare.html#PairF"><span class="hs-identifier hs-type">PairF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260383"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260383"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260384"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260384"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260385"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260385"><span class="hs-identifier hs-var">iexpr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260386"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260386"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>      </span><span id="local-6989586621679260387"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260387"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-350"></span><span>      </span><span id="local-6989586621679260388"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260388"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260384"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-351"></span><span>      </span><span id="local-6989586621679260389"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260389"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260386"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260387"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260383"><span class="hs-identifier hs-var">iexpr0</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260385"><span class="hs-identifier hs-var">iexpr1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; Cofree IExprF (Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; r -&gt; IExprF r
</span><a href="Telomare.html#PairF"><span class="hs-identifier hs-var">PairF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260388"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260389"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><a href="Telomare.html#GateF"><span class="hs-identifier hs-type">GateF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260391"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260391"><span class="hs-identifier hs-var">iexpr0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260392"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260392"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260393"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260393"><span class="hs-identifier hs-var">iexpr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260394"><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260394"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>      </span><span id="local-6989586621679260395"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260395"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
</span><a href="#local-6989586621679260352"><span class="hs-identifier hs-var">statePlus1</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span id="local-6989586621679260396"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260396"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260392"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-356"></span><span>      </span><span id="local-6989586621679260397"><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260397"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int (Cofree IExprF (Int, IExpr))
</span><a href="#local-6989586621679260394"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree IExprF (Int, IExpr)
 -&gt; State Int (Cofree IExprF (Int, IExpr)))
-&gt; Cofree IExprF (Int, IExpr)
-&gt; State Int (Cofree IExprF (Int, IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260395"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.RunTime.html#rEval"><span class="hs-identifier hs-var">rEval</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; IExpr -&gt; IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260391"><span class="hs-identifier hs-var">iexpr0</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679260393"><span class="hs-identifier hs-var">iexpr1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
-&gt; Cofree IExprF (Int, IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
-&gt; Cofree IExprF (Int, IExpr)
-&gt; IExprF (Cofree IExprF (Int, IExpr))
forall r. r -&gt; r -&gt; IExprF r
</span><a href="Telomare.html#GateF"><span class="hs-identifier hs-var">GateF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260396"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree IExprF (Int, IExpr)
</span><a href="#local-6989586621679260397"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="Telomare.Eval.html#tagUPTwithIExpr"><span class="hs-identifier hs-type">tagUPTwithIExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Parser.html#AnnotatedUPT"><span class="hs-identifier hs-type">AnnotatedUPT</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-360"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-361"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="tagUPTwithIExpr"><span class="annot"><span class="annottext">tagUPTwithIExpr :: [([Char], AnnotatedUPT)]
-&gt; UnprocessedParsedTerm
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="Telomare.Eval.html#tagUPTwithIExpr"><span class="hs-identifier hs-var hs-var">tagUPTwithIExpr</span></a></span></span><span> </span><span id="local-6989586621679260399"><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260399"><span class="hs-identifier hs-var">prelude</span></a></span></span><span> </span><span id="local-6989586621679260400"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260400"><span class="hs-identifier hs-var">upt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Int -&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Base
   UnprocessedParsedTerm
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; UnprocessedParsedTerm
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall t a. Recursive t =&gt; (Base t (t, a) -&gt; a) -&gt; t -&gt; a
forall a.
(Base UnprocessedParsedTerm (UnprocessedParsedTerm, a) -&gt; a)
-&gt; UnprocessedParsedTerm -&gt; a
</span><a href="file:///nix/store/nkxcfn1kvlkh491i67549y0m2b8jji3n-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#para"><span class="hs-identifier hs-var">para</span></a></span><span> </span><span class="annot"><span class="annottext">Base
  UnprocessedParsedTerm
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260401"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260400"><span class="hs-identifier hs-var">upt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><a href="#local-6989586621679260402"><span class="hs-identifier hs-type">upt2iexpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621679260402"><span class="annot"><span class="annottext">upt2iexpr :: UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var hs-var">upt2iexpr</span></a></span></span><span> </span><span id="local-6989586621679260403"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260403"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)] -&gt; AnnotatedUPT -&gt; Either [Char] Term3
</span><a href="Telomare.Resolver.html#process"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], AnnotatedUPT)]
</span><a href="#local-6989586621679260399"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocTag
-&gt; UnprocessedParsedTerm
-&gt; Cofree (Base UnprocessedParsedTerm) LocTag
forall a anno. Recursive a =&gt; anno -&gt; a -&gt; Cofree (Base a) anno
</span><a href="Telomare.html#tag"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocTag
</span><a href="Telomare.html#DummyLoc"><span class="hs-identifier hs-var">DummyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260403"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either [Char] Term3
-&gt; (Term3 -&gt; Either [Char] IExpr) -&gt; Either [Char] IExpr
forall a b.
Either [Char] a -&gt; (a -&gt; Either [Char] b) -&gt; Either [Char] b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; [Char])
-&gt; Either EvalError IExpr -&gt; Either [Char] IExpr
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Either EvalError IExpr -&gt; Either [Char] IExpr)
-&gt; (Term3 -&gt; Either EvalError IExpr)
-&gt; Term3
-&gt; Either [Char] IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compileUnitTest"><span class="hs-identifier hs-var">compileUnitTest</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><a href="#local-6989586621679260401"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/nkxcfn1kvlkh491i67549y0m2b8jji3n-recursion-schemes-5.2.3-doc/share/doc/recursion-schemes-5.2.3/html/src/Data.Functor.Foldable.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-366"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-367"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679260401"><span class="annot"><span class="annottext">alg :: Base
  UnprocessedParsedTerm
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260401"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><a href="Telomare.html#ITEUPF"><span class="hs-identifier hs-type">ITEUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260406"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260406"><span class="hs-identifier hs-var">utp1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260407"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260407"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260408"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260408"><span class="hs-identifier hs-var">utp2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260409"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260409"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260410"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260410"><span class="hs-identifier hs-var">utp3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260411"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260411"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>      </span><span id="local-6989586621679260412"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260412"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-373"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>      </span><span id="local-6989586621679260413"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260413"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260407"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span id="local-6989586621679260414"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260414"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260409"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span id="local-6989586621679260415"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260415"><span class="hs-identifier hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260411"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260412"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#ITEUP"><span class="hs-identifier hs-var">ITEUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260406"><span class="hs-identifier hs-var">utp1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260408"><span class="hs-identifier hs-var">utp2</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260410"><span class="hs-identifier hs-var">utp3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#ITEUPF"><span class="hs-identifier hs-var">ITEUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260413"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260414"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260415"><span class="hs-identifier hs-var">z'</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="Telomare.html#ListUPF"><span class="hs-identifier hs-type">ListUPF</span></a></span><span> </span><span id="local-6989586621679260418"><span class="annot"><span class="annottext">[(UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
</span><a href="#local-6989586621679260418"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-379"></span><span>      </span><span id="local-6989586621679260419"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260419"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679260420"><span class="hs-identifier hs-type">scupt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>          </span><span id="local-6989586621679260420"><span class="annot"><span class="annottext">scupt :: State
  Int [Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260420"><span class="hs-identifier hs-var hs-var">scupt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
-&gt; State
     Int [Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
</span><a href="#local-6989586621679260418"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-383"></span><span>      </span><span id="local-6989586621679260422"><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260422"><span class="hs-identifier hs-var">cupt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int [Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260420"><span class="hs-identifier hs-var">scupt</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260419"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; ([UnprocessedParsedTerm] -&gt; UnprocessedParsedTerm)
-&gt; [UnprocessedParsedTerm]
-&gt; Either [Char] IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[UnprocessedParsedTerm] -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#ListUP"><span class="hs-identifier hs-var">ListUP</span></a></span><span> </span><span class="annot"><span class="annottext">([UnprocessedParsedTerm] -&gt; Either [Char] IExpr)
-&gt; [UnprocessedParsedTerm] -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; UnprocessedParsedTerm
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; UnprocessedParsedTerm)
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
-&gt; [UnprocessedParsedTerm]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
</span><a href="#local-6989586621679260418"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. [r] -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#ListUPF"><span class="hs-identifier hs-var">ListUPF</span></a></span><span> </span><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260422"><span class="hs-identifier hs-var">cupt</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="Telomare.html#LetUPF"><span class="hs-identifier hs-type">LetUPF</span></a></span><span> </span><span id="local-6989586621679260424"><span class="annot"><span class="annottext">[([Char],
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
</span><a href="#local-6989586621679260424"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260425"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260425"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260426"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260426"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-386"></span><span>      </span><span id="local-6989586621679260427"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260427"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679260428"><span class="hs-identifier hs-type">lupt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-389"></span><span>          </span><span id="local-6989586621679260428"><span class="annot"><span class="annottext">lupt :: [([Char], UnprocessedParsedTerm)]
</span><a href="#local-6989586621679260428"><span class="hs-identifier hs-var hs-var">lupt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([Char],
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
 -&gt; ([Char], UnprocessedParsedTerm))
-&gt; [([Char],
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [([Char], UnprocessedParsedTerm)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((([Char],
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
  -&gt; ([Char], UnprocessedParsedTerm))
 -&gt; [([Char],
      (UnprocessedParsedTerm,
       State
         Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
 -&gt; [([Char], UnprocessedParsedTerm)])
-&gt; (((UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
     -&gt; UnprocessedParsedTerm)
    -&gt; ([Char],
        (UnprocessedParsedTerm,
         State
           Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
    -&gt; ([Char], UnprocessedParsedTerm))
-&gt; ((UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
    -&gt; UnprocessedParsedTerm)
-&gt; [([Char],
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [([Char], UnprocessedParsedTerm)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; UnprocessedParsedTerm)
-&gt; ([Char],
    (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; ([Char], UnprocessedParsedTerm)
forall a b. (a -&gt; b) -&gt; ([Char], a) -&gt; ([Char], b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; UnprocessedParsedTerm
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[([Char],
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
</span><a href="#local-6989586621679260424"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-390"></span><span>          </span><span class="annot"><a href="#local-6989586621679260429"><span class="hs-identifier hs-type">slcupt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-391"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-392"></span><span>          </span><span id="local-6989586621679260429"><span class="annot"><span class="annottext">slcupt :: State
  Int [Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260429"><span class="hs-identifier hs-var hs-var">slcupt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
-&gt; State
     Int [Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char],
 (UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Char],
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
 -&gt; (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; [([Char],
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [(UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[([Char],
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
</span><a href="#local-6989586621679260424"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>          </span><span class="annot"><a href="#local-6989586621679260430"><span class="hs-identifier hs-type">vnames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>          </span><span id="local-6989586621679260430"><span class="annot"><span class="annottext">vnames :: [[Char]]
</span><a href="#local-6989586621679260430"><span class="hs-identifier hs-var hs-var">vnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char],
 (UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; [Char]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([Char],
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
 -&gt; [Char])
-&gt; [([Char],
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [[Char]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[([Char],
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
</span><a href="#local-6989586621679260424"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span id="local-6989586621679260431"><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260431"><span class="hs-identifier hs-var">lcupt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int [Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260429"><span class="hs-identifier hs-var">slcupt</span></a></span><span>
</span><span id="line-396"></span><span>      </span><span id="local-6989586621679260432"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260432"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260426"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260427"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[([Char], UnprocessedParsedTerm)]
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LetUP"><span class="hs-identifier hs-var">LetUP</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], UnprocessedParsedTerm)]
</span><a href="#local-6989586621679260428"><span class="hs-identifier hs-var">lupt</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260425"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char],
  Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. [([Char], r)] -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LetUPF"><span class="hs-identifier hs-var">LetUPF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679260430"><span class="hs-identifier hs-var">vnames</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
-&gt; [Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
-&gt; [([Char],
     Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="annot"><span class="annottext">[Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)]
</span><a href="#local-6989586621679260431"><span class="hs-identifier hs-var">lcupt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260432"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><a href="Telomare.html#CaseUPF"><span class="hs-identifier hs-type">CaseUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260435"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260435"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260436"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260436"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679260437"><span class="annot"><span class="annottext">[(Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
</span><a href="#local-6989586621679260437"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-399"></span><span>      </span><span id="local-6989586621679260438"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260438"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-400"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>      </span><span id="local-6989586621679260439"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260439"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260436"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-402"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679260440"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-403"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTerm"><span class="hs-identifier hs-type">UnprocessedParsedTerm</span></a></span><span>
</span><span id="line-404"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>          </span><span id="local-6989586621679260440"><span class="annot"><span class="annottext">aux :: [(Pattern, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679260440"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
 -&gt; (Pattern, UnprocessedParsedTerm))
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [(Pattern, UnprocessedParsedTerm)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Pattern,
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
  -&gt; (Pattern, UnprocessedParsedTerm))
 -&gt; [(Pattern,
      (UnprocessedParsedTerm,
       State
         Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
 -&gt; [(Pattern, UnprocessedParsedTerm)])
-&gt; (((UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
     -&gt; UnprocessedParsedTerm)
    -&gt; (Pattern,
        (UnprocessedParsedTerm,
         State
           Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
    -&gt; (Pattern, UnprocessedParsedTerm))
-&gt; ((UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
    -&gt; UnprocessedParsedTerm)
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [(Pattern, UnprocessedParsedTerm)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; UnprocessedParsedTerm)
-&gt; (Pattern,
    (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; (Pattern, UnprocessedParsedTerm)
forall a b. (a -&gt; b) -&gt; (Pattern, a) -&gt; (Pattern, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; UnprocessedParsedTerm
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
</span><a href="#local-6989586621679260437"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-407"></span><span>          </span><span id="local-6989586621679260443"><span class="annot"><span class="annottext">aux0 :: [(Pattern,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
</span><a href="#local-6989586621679260443"><span class="hs-identifier hs-var hs-var">aux0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
 -&gt; (Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [(Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Pattern,
   (UnprocessedParsedTerm,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
  -&gt; (Pattern,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
 -&gt; [(Pattern,
      (UnprocessedParsedTerm,
       State
         Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
 -&gt; [(Pattern,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))])
-&gt; (((UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
     -&gt; State
          Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
    -&gt; (Pattern,
        (UnprocessedParsedTerm,
         State
           Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
    -&gt; (Pattern,
        State
          Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; ((UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
    -&gt; State
         Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; [(Pattern,
     (UnprocessedParsedTerm,
      State
        Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
-&gt; [(Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UnprocessedParsedTerm,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; (Pattern,
    (UnprocessedParsedTerm,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))
-&gt; (Pattern,
    State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
forall a b. (a -&gt; b) -&gt; (Pattern, a) -&gt; (Pattern, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  (UnprocessedParsedTerm,
   State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))))]
</span><a href="#local-6989586621679260437"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-408"></span><span>          </span><span class="annot"><a href="#local-6989586621679260444"><span class="hs-identifier hs-type">aux1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-409"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Telomare.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-410"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#Cofree"><span class="hs-identifier hs-type">Cofree</span></a></span><span> </span><span class="annot"><a href="Telomare.html#UnprocessedParsedTermF"><span class="hs-identifier hs-type">UnprocessedParsedTermF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>          </span><span id="local-6989586621679260444"><span class="annot"><span class="annottext">aux1 :: State
  Int
  [(Pattern,
    Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
</span><a href="#local-6989586621679260444"><span class="hs-identifier hs-var hs-var">aux1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Pattern,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
 -&gt; StateT
      Int
      Identity
      (Pattern,
       Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; [(Pattern,
     State
       Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
-&gt; State
     Int
     [(Pattern,
       Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(Pattern,
 State
   Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; StateT
     Int
     Identity
     (Pattern, Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; (Pattern, m a) -&gt; m (Pattern, a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  State
    Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))]
</span><a href="#local-6989586621679260443"><span class="hs-identifier hs-var">aux0</span></a></span><span>
</span><span id="line-414"></span><span>      </span><span id="local-6989586621679260445"><span class="annot"><span class="annottext">[(Pattern,
  Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
</span><a href="#local-6989586621679260445"><span class="hs-identifier hs-var">aux1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int
  [(Pattern,
    Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
</span><a href="#local-6989586621679260444"><span class="hs-identifier hs-var">aux1</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260438"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; [(Pattern, UnprocessedParsedTerm)] -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#CaseUP"><span class="hs-identifier hs-var">CaseUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260435"><span class="hs-identifier hs-var">upt0</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pattern, UnprocessedParsedTerm)]
</span><a href="#local-6989586621679260440"><span class="hs-identifier hs-var">aux</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; [(Pattern,
     Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; [(Pattern, r)] -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#CaseUPF"><span class="hs-identifier hs-var">CaseUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260439"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pattern,
  Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))]
</span><a href="#local-6989586621679260445"><span class="hs-identifier hs-var">aux1'</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><a href="Telomare.html#LamUPF"><span class="hs-identifier hs-type">LamUPF</span></a></span><span> </span><span id="local-6989586621679260448"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260448"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260449"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260449"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260450"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260450"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>      </span><span id="local-6989586621679260451"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260451"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>      </span><span id="local-6989586621679260452"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260452"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260450"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260451"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LamUP"><span class="hs-identifier hs-var">LamUP</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260448"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260449"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. [Char] -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LamUPF"><span class="hs-identifier hs-var">LamUPF</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260448"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260452"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><a href="Telomare.html#AppUPF"><span class="hs-identifier hs-type">AppUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260455"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260455"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260456"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260456"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260457"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260457"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260458"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260458"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>      </span><span id="local-6989586621679260459"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260459"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>      </span><span id="local-6989586621679260460"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260460"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260456"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span id="local-6989586621679260461"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260461"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260458"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260459"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#AppUP"><span class="hs-identifier hs-var">AppUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260455"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260457"><span class="hs-identifier hs-var">upt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#AppUPF"><span class="hs-identifier hs-var">AppUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260460"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260461"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Telomare.html#UnsizedRecursionUPF"><span class="hs-identifier hs-type">UnsizedRecursionUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260464"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260464"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260465"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260465"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260466"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260466"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260467"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260467"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260468"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260468"><span class="hs-identifier hs-var">upt3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260469"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260469"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>      </span><span id="local-6989586621679260470"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260470"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>      </span><span id="local-6989586621679260471"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260471"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260465"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-431"></span><span>      </span><span id="local-6989586621679260472"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260472"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260467"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-432"></span><span>      </span><span id="local-6989586621679260473"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260473"><span class="hs-identifier hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260469"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260470"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-434"></span><span>                   </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#UnsizedRecursionUP"><span class="hs-identifier hs-var">UnsizedRecursionUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260464"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260466"><span class="hs-identifier hs-var">upt2</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260468"><span class="hs-identifier hs-var">upt3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span>
</span><span id="line-435"></span><span>                     </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#UnsizedRecursionUPF"><span class="hs-identifier hs-var">UnsizedRecursionUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260471"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260472"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260473"><span class="hs-identifier hs-var">z'</span></a></span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><a href="Telomare.html#CheckUPF"><span class="hs-identifier hs-type">CheckUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260476"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260476"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260477"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260477"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260478"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260478"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260479"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260479"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-437"></span><span>      </span><span id="local-6989586621679260480"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260480"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>      </span><span id="local-6989586621679260481"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260481"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260477"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-440"></span><span>      </span><span id="local-6989586621679260482"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260482"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260479"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260480"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#CheckUP"><span class="hs-identifier hs-var">CheckUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260476"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260478"><span class="hs-identifier hs-var">upt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#CheckUPF"><span class="hs-identifier hs-var">CheckUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260481"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260482"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="Telomare.html#LeftUPF"><span class="hs-identifier hs-type">LeftUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260485"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260485"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260486"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260486"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-443"></span><span>      </span><span id="local-6989586621679260487"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260487"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>      </span><span id="local-6989586621679260488"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260488"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260486"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-446"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260487"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260485"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LeftUPF"><span class="hs-identifier hs-var">LeftUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260488"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="Telomare.html#RightUPF"><span class="hs-identifier hs-type">RightUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260491"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260491"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260492"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260492"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>      </span><span id="local-6989586621679260493"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260493"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-449"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>      </span><span id="local-6989586621679260494"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260494"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260492"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260493"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#RightUP"><span class="hs-identifier hs-var">RightUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260491"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#RightUPF"><span class="hs-identifier hs-var">RightUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260494"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="Telomare.html#TraceUPF"><span class="hs-identifier hs-type">TraceUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260497"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260497"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260498"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260498"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-453"></span><span>      </span><span id="local-6989586621679260499"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260499"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621679260500"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260500"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260498"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-456"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260499"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#TraceUP"><span class="hs-identifier hs-var">TraceUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260497"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#TraceUPF"><span class="hs-identifier hs-var">TraceUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260500"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><a href="Telomare.html#HashUPF"><span class="hs-identifier hs-type">HashUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260503"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260503"><span class="hs-identifier hs-var">upt0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260504"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260504"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>      </span><span id="local-6989586621679260505"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260505"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>      </span><span id="local-6989586621679260506"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260506"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260504"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260505"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#LeftUP"><span class="hs-identifier hs-var">LeftUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260503"><span class="hs-identifier hs-var">upt0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#LeftUPF"><span class="hs-identifier hs-var">LeftUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260506"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><a href="Telomare.html#IntUPF"><span class="hs-identifier hs-type">IntUPF</span></a></span><span> </span><span id="local-6989586621679260508"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260508"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-463"></span><span>      </span><span id="local-6989586621679260509"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260509"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-464"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260509"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#IntUP"><span class="hs-identifier hs-var">IntUP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260508"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. Int -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#IntUPF"><span class="hs-identifier hs-var">IntUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260508"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><a href="Telomare.html#VarUPF"><span class="hs-identifier hs-type">VarUPF</span></a></span><span> </span><span id="local-6989586621679260512"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260512"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>      </span><span id="local-6989586621679260513"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260513"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-468"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260513"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#VarUP"><span class="hs-identifier hs-var">VarUP</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260512"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. [Char] -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#VarUPF"><span class="hs-identifier hs-var">VarUPF</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679260512"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>    </span><span class="annot"><a href="Telomare.html#PairUPF"><span class="hs-identifier hs-type">PairUPF</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260516"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260516"><span class="hs-identifier hs-var">upt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260517"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260517"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260518"><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260518"><span class="hs-identifier hs-var">upt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260519"><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260519"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>      </span><span id="local-6989586621679260520"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260520"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State Int Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-472"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">State.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>      </span><span id="local-6989586621679260521"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260521"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260517"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-474"></span><span>      </span><span id="local-6989586621679260522"><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260522"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State
  Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
</span><a href="#local-6989586621679260519"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-475"></span><span>      </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a. a -&gt; StateT Int Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
 -&gt; State
      Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; State
     Int (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679260520"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm -&gt; Either [Char] IExpr
</span><a href="#local-6989586621679260402"><span class="hs-identifier hs-var">upt2iexpr</span></a></span><span> </span><span class="annot"><span class="annottext">(UnprocessedParsedTerm -&gt; Either [Char] IExpr)
-&gt; UnprocessedParsedTerm -&gt; Either [Char] IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
-&gt; UnprocessedParsedTerm -&gt; UnprocessedParsedTerm
</span><a href="Telomare.html#PairUP"><span class="hs-identifier hs-var">PairUP</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260516"><span class="hs-identifier hs-var">upt1</span></a></span><span> </span><span class="annot"><span class="annottext">UnprocessedParsedTerm
</span><a href="#local-6989586621679260518"><span class="hs-identifier hs-var">upt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
forall (f :: * -&gt; *) a. a -&gt; f (Cofree f a) -&gt; Cofree f a
</span><a href="file:///nix/store/vsrrbpdlmcw7cpkqw7xl0nmzk5sx7xwf-free-5.2-doc/share/doc/free-5.2/html/src/Control.Comonad.Cofree.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
-&gt; UnprocessedParsedTermF
     (Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr))
forall r. r -&gt; r -&gt; UnprocessedParsedTermF r
</span><a href="Telomare.html#PairUPF"><span class="hs-identifier hs-var">PairUPF</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260521"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Cofree UnprocessedParsedTermF (Int, Either [Char] IExpr)
</span><a href="#local-6989586621679260522"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-476"></span></pre></body></html>