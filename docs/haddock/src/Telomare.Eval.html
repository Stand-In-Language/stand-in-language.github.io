<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_3doYZZPf0AU0erQDKxAE8r"><span id="%24con2tag_Il7fAE19o8oByoBOSUmwDb"></span></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Telomare.Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens.Plated</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.html"><span class="hs-identifier">Telomare</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.Optimizer.html"><span class="hs-identifier">Telomare.Optimizer</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.Parser.html"><span class="hs-identifier">Telomare.Parser</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.Possible.html"><span class="hs-identifier">Telomare.Possible</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.RunTime.html"><span class="hs-identifier">Telomare.RunTime</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.Serializer.html"><span class="hs-identifier">Telomare.Serializer</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Telomare.TypeChecker.html"><span class="hs-identifier">Telomare.TypeChecker</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">data</span><span> </span><span id="ExpP"><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-var">ExpP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ZeroP"><span class="annot"><a href="Telomare.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a></span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PairP"><span class="annot"><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="VarP"><span class="annot"><a href="Telomare.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a></span></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SetEnvP"><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DeferP"><span class="annot"><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AbortP"><span class="annot"><a href="Telomare.Eval.html#AbortP"><span class="hs-identifier hs-var">AbortP</span></a></span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="GateP"><span class="annot"><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LeftP"><span class="annot"><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RightP"><span class="annot"><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a></span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TraceP"><span class="annot"><a href="Telomare.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a></span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439896"><span id="local-6989586621679439898"><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; Bool
(ExpP -&gt; ExpP -&gt; Bool) -&gt; (ExpP -&gt; ExpP -&gt; Bool) -&gt; Eq ExpP
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExpP -&gt; ExpP -&gt; Bool
$c/= :: ExpP -&gt; ExpP -&gt; Bool
== :: ExpP -&gt; ExpP -&gt; Bool
$c== :: ExpP -&gt; ExpP -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439889"><span id="local-6989586621679439891"><span id="local-6989586621679439893"><span class="annot"><span class="annottext">Int -&gt; ExpP -&gt; ShowS
[ExpP] -&gt; ShowS
ExpP -&gt; String
(Int -&gt; ExpP -&gt; ShowS)
-&gt; (ExpP -&gt; String) -&gt; ([ExpP] -&gt; ShowS) -&gt; Show ExpP
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExpP] -&gt; ShowS
$cshowList :: [ExpP] -&gt; ShowS
show :: ExpP -&gt; String
$cshow :: ExpP -&gt; String
showsPrec :: Int -&gt; ExpP -&gt; ShowS
$cshowsPrec :: Int -&gt; ExpP -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439873"><span id="local-6989586621679439875"><span id="local-6989586621679439877"><span id="local-6989586621679439879"><span id="local-6989586621679439881"><span id="local-6989586621679439883"><span id="local-6989586621679439885"><span class="annot"><span class="annottext">Eq ExpP
Eq ExpP =&gt;
(ExpP -&gt; ExpP -&gt; Ordering)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; Bool)
-&gt; (ExpP -&gt; ExpP -&gt; ExpP)
-&gt; (ExpP -&gt; ExpP -&gt; ExpP)
-&gt; Ord ExpP
ExpP -&gt; ExpP -&gt; Bool
ExpP -&gt; ExpP -&gt; Ordering
ExpP -&gt; ExpP -&gt; ExpP
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ExpP -&gt; ExpP -&gt; ExpP
$cmin :: ExpP -&gt; ExpP -&gt; ExpP
max :: ExpP -&gt; ExpP -&gt; ExpP
$cmax :: ExpP -&gt; ExpP -&gt; ExpP
&gt;= :: ExpP -&gt; ExpP -&gt; Bool
$c&gt;= :: ExpP -&gt; ExpP -&gt; Bool
&gt; :: ExpP -&gt; ExpP -&gt; Bool
$c&gt; :: ExpP -&gt; ExpP -&gt; Bool
&lt;= :: ExpP -&gt; ExpP -&gt; Bool
$c&lt;= :: ExpP -&gt; ExpP -&gt; Bool
&lt; :: ExpP -&gt; ExpP -&gt; Bool
$c&lt; :: ExpP -&gt; ExpP -&gt; Bool
compare :: ExpP -&gt; ExpP -&gt; Ordering
$ccompare :: ExpP -&gt; ExpP -&gt; Ordering
$cp1Ord :: Eq ExpP
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plated</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>  </span><span id="local-6989586621679439869"><span class="annot"><span class="annottext">plate :: (ExpP -&gt; f ExpP) -&gt; ExpP -&gt; f ExpP
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">plate</span></span></span><span> </span><span id="local-6989586621679439867"><span class="annot"><span class="annottext">f :: ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-type">PairP</span></a></span><span> </span><span id="local-6989586621679439866"><span class="annot"><span class="annottext">a :: ExpP
</span><a href="#local-6989586621679439866"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679439865"><span class="annot"><span class="annottext">b :: ExpP
</span><a href="#local-6989586621679439865"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f (ExpP -&gt; ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439866"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f (ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439865"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-type">SetEnvP</span></a></span><span> </span><span id="local-6989586621679439863"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439863"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679439862"><span class="annot"><span class="annottext">b :: Bool
</span><a href="#local-6989586621679439862"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; Bool -&gt; ExpP
</span><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; Bool -&gt; ExpP) -&gt; f ExpP -&gt; f (Bool -&gt; ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439863"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (Bool -&gt; ExpP) -&gt; f Bool -&gt; f ExpP
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679439862"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-type">DeferP</span></a></span><span> </span><span id="local-6989586621679439861"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439861"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439861"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-type">GateP</span></a></span><span> </span><span id="local-6989586621679439860"><span class="annot"><span class="annottext">l :: ExpP
</span><a href="#local-6989586621679439860"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679439859"><span class="annot"><span class="annottext">r :: ExpP
</span><a href="#local-6989586621679439859"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f (ExpP -&gt; ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439860"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">f (ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439859"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-type">LeftP</span></a></span><span> </span><span id="local-6989586621679439858"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439858"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439858"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-type">RightP</span></a></span><span> </span><span id="local-6989586621679439857"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439857"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; f ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
</span><a href="#local-6989586621679439867"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439857"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679439856"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439856"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; f ExpP
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439856"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">data</span><span> </span><span id="EvalError"><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-var">EvalError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RTE"><span class="annot"><a href="Telomare.Eval.html#RTE"><span class="hs-identifier hs-var">RTE</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TCE"><span class="annot"><a href="Telomare.Eval.html#TCE"><span class="hs-identifier hs-var">TCE</span></a></span></span><span> </span><span class="annot"><a href="Telomare.TypeChecker.html#TypeCheckError"><span class="hs-identifier hs-type">TypeCheckError</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StaticCheckError"><span class="annot"><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CompileConversionError"><span class="annot"><a href="Telomare.Eval.html#CompileConversionError"><span class="hs-identifier hs-var">CompileConversionError</span></a></span></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439847"><span id="local-6989586621679439849"><span class="annot"><span class="annottext">EvalError -&gt; EvalError -&gt; Bool
(EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool) -&gt; Eq EvalError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EvalError -&gt; EvalError -&gt; Bool
$c/= :: EvalError -&gt; EvalError -&gt; Bool
== :: EvalError -&gt; EvalError -&gt; Bool
$c== :: EvalError -&gt; EvalError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439832"><span id="local-6989586621679439834"><span id="local-6989586621679439836"><span id="local-6989586621679439838"><span id="local-6989586621679439840"><span id="local-6989586621679439842"><span id="local-6989586621679439844"><span class="annot"><span class="annottext">Eq EvalError
Eq EvalError =&gt;
(EvalError -&gt; EvalError -&gt; Ordering)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; Bool)
-&gt; (EvalError -&gt; EvalError -&gt; EvalError)
-&gt; (EvalError -&gt; EvalError -&gt; EvalError)
-&gt; Ord EvalError
EvalError -&gt; EvalError -&gt; Bool
EvalError -&gt; EvalError -&gt; Ordering
EvalError -&gt; EvalError -&gt; EvalError
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: EvalError -&gt; EvalError -&gt; EvalError
$cmin :: EvalError -&gt; EvalError -&gt; EvalError
max :: EvalError -&gt; EvalError -&gt; EvalError
$cmax :: EvalError -&gt; EvalError -&gt; EvalError
&gt;= :: EvalError -&gt; EvalError -&gt; Bool
$c&gt;= :: EvalError -&gt; EvalError -&gt; Bool
&gt; :: EvalError -&gt; EvalError -&gt; Bool
$c&gt; :: EvalError -&gt; EvalError -&gt; Bool
&lt;= :: EvalError -&gt; EvalError -&gt; Bool
$c&lt;= :: EvalError -&gt; EvalError -&gt; Bool
&lt; :: EvalError -&gt; EvalError -&gt; Bool
$c&lt; :: EvalError -&gt; EvalError -&gt; Bool
compare :: EvalError -&gt; EvalError -&gt; Ordering
$ccompare :: EvalError -&gt; EvalError -&gt; Ordering
$cp1Ord :: Eq EvalError
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439826"><span id="local-6989586621679439828"><span id="local-6989586621679439830"><span class="annot"><span class="annottext">Int -&gt; EvalError -&gt; ShowS
[EvalError] -&gt; ShowS
EvalError -&gt; String
(Int -&gt; EvalError -&gt; ShowS)
-&gt; (EvalError -&gt; String)
-&gt; ([EvalError] -&gt; ShowS)
-&gt; Show EvalError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EvalError] -&gt; ShowS
$cshowList :: [EvalError] -&gt; ShowS
show :: EvalError -&gt; String
$cshow :: EvalError -&gt; String
showsPrec :: Int -&gt; EvalError -&gt; ShowS
$cshowsPrec :: Int -&gt; EvalError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">type</span><span> </span><span id="ExpFullEnv"><span class="annot"><a href="Telomare.Eval.html#ExpFullEnv"><span class="hs-identifier hs-var">ExpFullEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Telomare.html#ExprA"><span class="hs-identifier hs-type">ExprA</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-type">annotateEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span id="annotateEnv"><span class="annot"><span class="annottext">annotateEnv :: IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var hs-var">annotateEnv</span></a></span></span><span> </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679439820"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679439820"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679439819"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679439819"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439818"><span class="annot"><span class="annottext">at :: Bool
</span><a href="#local-6989586621679439818"><span class="hs-identifier hs-var">at</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439817"><span class="annot"><span class="annottext">na :: ExpP
</span><a href="#local-6989586621679439817"><span class="hs-identifier hs-var">na</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439820"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-53"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679439816"><span class="annot"><span class="annottext">bt :: Bool
</span><a href="#local-6989586621679439816"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439815"><span class="annot"><span class="annottext">nb :: ExpP
</span><a href="#local-6989586621679439815"><span class="hs-identifier hs-var">nb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439819"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679439818"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679439816"><span class="hs-identifier hs-var">bt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439817"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439815"><span class="hs-identifier hs-var">nb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-type">SetEnv</span></a></span><span> </span><span id="local-6989586621679439811"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679439811"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439810"><span class="annot"><span class="annottext">xt :: Bool
</span><a href="#local-6989586621679439810"><span class="hs-identifier hs-var">xt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439809"><span class="annot"><span class="annottext">nx :: ExpP
</span><a href="#local-6989586621679439809"><span class="hs-identifier hs-var">nx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439811"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679439810"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; Bool -&gt; ExpP
</span><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439809"><span class="hs-identifier hs-var">nx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679439810"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Defer"><span class="hs-identifier hs-type">Defer</span></a></span><span> </span><span id="local-6989586621679439807"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679439807"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439806"><span class="annot"><span class="annottext">nx :: ExpP
</span><a href="#local-6989586621679439806"><span class="hs-identifier hs-var">nx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439807"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439806"><span class="hs-identifier hs-var">nx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Gate"><span class="hs-identifier hs-type">Gate</span></a></span><span> </span><span id="local-6989586621679439804"><span class="annot"><span class="annottext">a :: IExpr
</span><a href="#local-6989586621679439804"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679439803"><span class="annot"><span class="annottext">b :: IExpr
</span><a href="#local-6989586621679439803"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439802"><span class="annot"><span class="annottext">at :: Bool
</span><a href="#local-6989586621679439802"><span class="hs-identifier hs-var">at</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439801"><span class="annot"><span class="annottext">na :: ExpP
</span><a href="#local-6989586621679439801"><span class="hs-identifier hs-var">na</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439804"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-60"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679439800"><span class="annot"><span class="annottext">bt :: Bool
</span><a href="#local-6989586621679439800"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439799"><span class="annot"><span class="annottext">nb :: ExpP
</span><a href="#local-6989586621679439799"><span class="hs-identifier hs-var">nb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439803"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679439802"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679439800"><span class="hs-identifier hs-var">bt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439801"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439799"><span class="hs-identifier hs-var">nb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PLeft"><span class="hs-identifier hs-type">PLeft</span></a></span><span> </span><span id="local-6989586621679439797"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679439797"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; (Bool, ExpP) -&gt; (Bool, ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439797"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-63"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#PRight"><span class="hs-identifier hs-type">PRight</span></a></span><span> </span><span id="local-6989586621679439795"><span class="annot"><span class="annottext">x :: IExpr
</span><a href="#local-6989586621679439795"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; ExpP
</span><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; ExpP) -&gt; (Bool, ExpP) -&gt; (Bool, ExpP)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439795"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span> </span><span class="annot"><a href="Telomare.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="Telomare.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span id="local-6989586621679439956"><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-type">fromFullEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679439956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679439956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679439956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span></span><span>
</span><span id="line-67"></span><span id="fromFullEnv"><span class="annot"><span class="annottext">fromFullEnv :: (ExpP -&gt; a IExpr) -&gt; ExpP -&gt; a IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var hs-var">fromFullEnv</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Telomare.Eval.html#ZeroP"><span class="hs-identifier hs-type">ZeroP</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679439792"><span class="annot"><span class="annottext">f :: ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439792"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#PairP"><span class="hs-identifier hs-type">PairP</span></a></span><span> </span><span id="local-6989586621679439791"><span class="annot"><span class="annottext">a :: ExpP
</span><a href="#local-6989586621679439791"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679439790"><span class="annot"><span class="annottext">b :: ExpP
</span><a href="#local-6989586621679439790"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a (IExpr -&gt; IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439792"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439791"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a (IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439792"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439790"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Telomare.Eval.html#VarP"><span class="hs-identifier hs-type">VarP</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679439789"><span class="annot"><span class="annottext">f :: ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439789"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-type">SetEnvP</span></a></span><span> </span><span id="local-6989586621679439788"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439788"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439789"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439788"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679439787"><span class="annot"><span class="annottext">f :: ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439787"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#DeferP"><span class="hs-identifier hs-type">DeferP</span></a></span><span> </span><span id="local-6989586621679439786"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439786"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439787"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439786"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-72"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679439785"><span class="annot"><span class="annottext">f :: ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439785"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#GateP"><span class="hs-identifier hs-type">GateP</span></a></span><span> </span><span id="local-6989586621679439784"><span class="annot"><span class="annottext">a :: ExpP
</span><a href="#local-6989586621679439784"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679439783"><span class="annot"><span class="annottext">b :: ExpP
</span><a href="#local-6989586621679439783"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Gate"><span class="hs-identifier hs-var">Gate</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a (IExpr -&gt; IExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439785"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439784"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a (IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439785"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439783"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-73"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679439782"><span class="annot"><span class="annottext">f :: ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439782"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#LeftP"><span class="hs-identifier hs-type">LeftP</span></a></span><span> </span><span id="local-6989586621679439781"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439781"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439782"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439781"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span id="local-6989586621679439780"><span class="annot"><span class="annottext">f :: ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439780"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#RightP"><span class="hs-identifier hs-type">RightP</span></a></span><span> </span><span id="local-6989586621679439779"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439779"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#PRight"><span class="hs-identifier hs-var">PRight</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr) -&gt; a IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; a IExpr
</span><a href="#local-6989586621679439780"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439779"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Telomare.Eval.html#TraceP"><span class="hs-identifier hs-type">TraceP</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; a IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Telomare.html#TelomareLike"><span class="hs-identifier hs-type">TelomareLike</span></a></span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679439775"><span class="annot"><span class="annottext">fromTelomare :: IExpr -&gt; ExpP
</span><a href="Telomare.html#fromTelomare"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromTelomare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool, ExpP) -&gt; ExpP
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Bool, ExpP) -&gt; ExpP) -&gt; (IExpr -&gt; (Bool, ExpP)) -&gt; IExpr -&gt; ExpP
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; (Bool, ExpP)
</span><a href="Telomare.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679439772"><span class="annot"><span class="annottext">toTelomare :: ExpP -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var hs-var hs-var hs-var">toTelomare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ExpP -&gt; Maybe IExpr) -&gt; ExpP -&gt; Maybe IExpr)
-&gt; ExpP -&gt; Maybe IExpr
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; Maybe IExpr) -&gt; ExpP -&gt; Maybe IExpr
forall (a :: * -&gt; *).
Applicative a =&gt;
(ExpP -&gt; a IExpr) -&gt; ExpP -&gt; a IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-type">partiallyEvaluate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-82"></span><span id="partiallyEvaluate"><span class="annot"><span class="annottext">partiallyEvaluate :: ExpP -&gt; Either RunTimeError IExpr
</span><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-var hs-var">partiallyEvaluate</span></a></span></span><span> </span><span id="local-6989586621679439768"><span class="annot"><span class="annottext">se :: ExpP
</span><a href="#local-6989586621679439768"><span class="hs-identifier hs-var">se</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Eval.html#SetEnvP"><span class="hs-identifier hs-type">SetEnvP</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.html#Defer"><span class="hs-identifier hs-var">Defer</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IExpr)
-&gt; Either RunTimeError IExpr -&gt; Either RunTimeError IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ExpP -&gt; Either RunTimeError IExpr)
 -&gt; ExpP -&gt; Either RunTimeError IExpr)
-&gt; ExpP -&gt; Either RunTimeError IExpr
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; Either RunTimeError IExpr)
-&gt; ExpP -&gt; Either RunTimeError IExpr
forall (a :: * -&gt; *).
Applicative a =&gt;
(ExpP -&gt; a IExpr) -&gt; ExpP -&gt; a IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439768"><span class="hs-identifier hs-var">se</span></a></span><span> </span><span class="annot"><span class="annottext">Either RunTimeError IExpr
-&gt; (IExpr -&gt; Either RunTimeError IExpr)
-&gt; Either RunTimeError IExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; Either RunTimeError IExpr
</span><a href="Telomare.RunTime.html#pureEval"><span class="hs-identifier hs-var">pureEval</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; Either RunTimeError IExpr)
-&gt; (IExpr -&gt; IExpr) -&gt; IExpr -&gt; Either RunTimeError IExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr
</span><a href="Telomare.Optimizer.html#optimize"><span class="hs-identifier hs-var">optimize</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="annot"><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-var">partiallyEvaluate</span></a></span><span> </span><span id="local-6989586621679439765"><span class="annot"><span class="annottext">x :: ExpP
</span><a href="#local-6989586621679439765"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExpP -&gt; Either RunTimeError IExpr)
-&gt; ExpP -&gt; Either RunTimeError IExpr
forall (a :: * -&gt; *).
Applicative a =&gt;
(ExpP -&gt; a IExpr) -&gt; ExpP -&gt; a IExpr
</span><a href="Telomare.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP -&gt; Either RunTimeError IExpr
</span><a href="Telomare.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-var">partiallyEvaluate</span></a></span><span> </span><span class="annot"><span class="annottext">ExpP
</span><a href="#local-6989586621679439765"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Telomare.Eval.html#eval%27"><span class="hs-identifier hs-type">eval'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-86"></span><span id="eval%27"><span class="annot"><span class="annottext">eval' :: IExpr -&gt; Either String IExpr
</span><a href="Telomare.Eval.html#eval%27"><span class="hs-identifier hs-var hs-var">eval'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Either String IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-type">findChurchSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-89"></span><span class="hs-comment">{-
findChurchSize term =
  let abortsAt i = (\(PResult (_, b)) -&gt; b) . fix pEval PZero . fromTelomare $ convertPT i term
      -- evaluating large church numbers is currently impractical, just fail if found
      (ib, ie) = if not (abortsAt 255) then (0, 255) else error &quot;findchurchsize TODO&quot; -- (256, maxBound)
      findC b e | b &gt; e = b
      findC b e = let midpoint = (\n -&gt; trace (&quot;midpoint is now &quot; &lt;&gt; show n) n) $ div (b + e) 2
                  in if abortsAt midpoint then findC (midpoint + 1) e else findC b midpoint
  in convertPT (findC ib ie) term
-}</span><span>
</span><span id="line-99"></span><span id="findChurchSize"><span class="annot"><span class="annottext">findChurchSize :: Term3 -&gt; Term4
</span><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-var hs-var">findChurchSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term3 -&gt; Term4
</span><a href="Telomare.Parser.html#convertPT"><span class="hs-identifier hs-var">convertPT</span></a></span><span> </span><span class="annot"><span class="hs-number">255</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- we should probably redo the types so that this is also a type conversion</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-type">removeChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span>
</span><span id="line-103"></span><span id="removeChecks"><span class="annot"><span class="annottext">removeChecks :: Term4 -&gt; Term4
</span><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-var hs-var">removeChecks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679439759"><span class="annot"><span class="annottext">m :: Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679439759"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679439758"><span class="annot"><span class="annottext">f :: FragExpr a -&gt; FragExpr a
</span><a href="#local-6989586621679439758"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="Telomare.html#AbortFrag"><span class="hs-identifier hs-type">AbortFrag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragExpr a
forall a. FragIndex -&gt; FragExpr a
</span><a href="Telomare.html#DeferFrag"><span class="hs-identifier hs-var">DeferFrag</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679439755"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-106"></span><span>        </span><span id="local-6989586621679439754"><span class="annot"><span class="annottext">x :: FragExpr a
</span><a href="#local-6989586621679439754"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FragExpr a
</span><a href="#local-6989586621679439754"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679439755"><span class="annot"><span class="annottext">ind :: FragIndex
</span><a href="#local-6989586621679439755"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439753"><span class="annot"><span class="annottext">newM :: Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679439753"><span class="hs-identifier hs-var">newM</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Map FragIndex (FragExpr Void)) FragIndex
-&gt; Map FragIndex (FragExpr Void)
-&gt; (FragIndex, Map FragIndex (FragExpr Void))
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">State.runState</span></span><span> </span><span class="annot"><span class="annottext">State (Map FragIndex (FragExpr Void)) FragIndex
forall a. StateT (Map FragIndex (FragExpr a)) Identity FragIndex
</span><a href="#local-6989586621679439751"><span class="hs-identifier hs-var">builder</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679439759"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span id="local-6989586621679439751"><span class="annot"><span class="annottext">builder :: StateT (Map FragIndex (FragExpr a)) Identity FragIndex
</span><a href="#local-6989586621679439751"><span class="hs-identifier hs-var hs-var">builder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-109"></span><span>        </span><span id="local-6989586621679439750"><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679439750"><span class="hs-identifier hs-var">envDefer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FragExpr a
-&gt; StateT (Map FragIndex (FragExpr a)) Identity FragIndex
forall e a. (Ord e, Enum e) =&gt; a -&gt; State (Map e a) e
</span><a href="Telomare.html#insertAndGetKey"><span class="hs-identifier hs-var">insertAndGetKey</span></a></span><span> </span><span class="annot"><span class="annottext">FragExpr a
forall a. FragExpr a
</span><a href="Telomare.html#EnvFrag"><span class="hs-identifier hs-var">EnvFrag</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="annottext">FragExpr a
-&gt; StateT (Map FragIndex (FragExpr a)) Identity FragIndex
forall e a. (Ord e, Enum e) =&gt; a -&gt; State (Map e a) e
</span><a href="Telomare.html#insertAndGetKey"><span class="hs-identifier hs-var">insertAndGetKey</span></a></span><span> </span><span class="annot"><span class="annottext">(FragExpr a
 -&gt; StateT (Map FragIndex (FragExpr a)) Identity FragIndex)
-&gt; FragExpr a
-&gt; StateT (Map FragIndex (FragExpr a)) Identity FragIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FragIndex -&gt; FragExpr a
forall a. FragIndex -&gt; FragExpr a
</span><a href="Telomare.html#DeferFrag"><span class="hs-identifier hs-var">DeferFrag</span></a></span><span> </span><span class="annot"><span class="annottext">FragIndex
</span><a href="#local-6989586621679439750"><span class="hs-identifier hs-var">envDefer</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void) -&gt; Term4
</span><a href="Telomare.html#Term4"><span class="hs-identifier hs-var">Term4</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FragIndex (FragExpr Void) -&gt; Term4)
-&gt; Map FragIndex (FragExpr Void) -&gt; Term4
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FragExpr Void -&gt; FragExpr Void)
-&gt; Map FragIndex (FragExpr Void) -&gt; Map FragIndex (FragExpr Void)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FragExpr Void -&gt; FragExpr Void) -&gt; FragExpr Void -&gt; FragExpr Void
forall a. Plated a =&gt; (a -&gt; a) -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">transform</span></span><span> </span><span class="annot"><span class="annottext">FragExpr Void -&gt; FragExpr Void
forall a. FragExpr a -&gt; FragExpr a
</span><a href="#local-6989586621679439758"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679439753"><span class="hs-identifier hs-var">newM</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-type">runStaticChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-114"></span><span id="runStaticChecks"><span class="annot"><span class="annottext">runStaticChecks :: Term4 -&gt; Maybe String
</span><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-var hs-var">runStaticChecks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Term4"><span class="hs-identifier hs-type">Term4</span></a></span><span> </span><span id="local-6989586621679439744"><span class="annot"><span class="annottext">termMap :: Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679439744"><span class="hs-identifier hs-var">termMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FragIndex -&gt; FragExpr Void)
-&gt; ((PossibleExpr Void Void
     -&gt; FragExpr Void -&gt; Either String (PossibleExpr Void Void))
    -&gt; PossibleExpr Void Void
    -&gt; PossibleExpr Void Void
    -&gt; PossibleExpr Void Void
    -&gt; Either String (PossibleExpr Void Void))
-&gt; PossibleExpr Void Void
-&gt; FragExpr Void
-&gt; Either String (PossibleExpr Void Void)
forall a b (m :: * -&gt; *).
(Show a, Eq a, Show b, Eq b, Monad m) =&gt;
(FragIndex -&gt; FragExpr b)
-&gt; ((PossibleExpr a b -&gt; FragExpr b -&gt; m (PossibleExpr a b))
    -&gt; PossibleExpr a b
    -&gt; PossibleExpr a b
    -&gt; PossibleExpr a b
    -&gt; m (PossibleExpr a b))
-&gt; PossibleExpr a b
-&gt; FragExpr b
-&gt; m (PossibleExpr a b)
</span><a href="Telomare.Possible.html#toPossible"><span class="hs-identifier hs-var">toPossible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679439744"><span class="hs-identifier hs-var">termMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void) -&gt; FragIndex -&gt; FragExpr Void
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PossibleExpr Void Void
 -&gt; FragExpr Void -&gt; Either String (PossibleExpr Void Void))
-&gt; PossibleExpr Void Void
-&gt; PossibleExpr Void Void
-&gt; PossibleExpr Void Void
-&gt; Either String (PossibleExpr Void Void)
forall a b.
(Show a, Eq a, Show b, Eq b) =&gt;
(PossibleExpr a b
 -&gt; FragExpr b -&gt; Either String (PossibleExpr a b))
-&gt; PossibleExpr a b
-&gt; PossibleExpr a b
-&gt; PossibleExpr a b
-&gt; Either String (PossibleExpr a b)
</span><a href="Telomare.Possible.html#staticAbortSetEval"><span class="hs-identifier hs-var">staticAbortSetEval</span></a></span><span> </span><span class="annot"><span class="annottext">PossibleExpr Void Void
forall a b. PossibleExpr a b
</span><a href="Telomare.Possible.html#AnyX"><span class="hs-identifier hs-var">AnyX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void) -&gt; FragExpr Void
forall a. Map FragIndex a -&gt; a
</span><a href="Telomare.html#rootFrag"><span class="hs-identifier hs-var">rootFrag</span></a></span><span> </span><span class="annot"><span class="annottext">Map FragIndex (FragExpr Void)
</span><a href="#local-6989586621679439744"><span class="hs-identifier hs-var">termMap</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.Possible.html#PossibleExpr"><span class="hs-identifier hs-type">PossibleExpr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679439738"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679439738"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439738"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#Term3"><span class="hs-identifier hs-type">Term3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Telomare.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a></span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span>
</span><span id="line-119"></span><span id="compile"><span class="annot"><span class="annottext">compile :: Term3 -&gt; Either EvalError IExpr
</span><a href="Telomare.Eval.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span id="local-6989586621679439736"><span class="annot"><span class="annottext">t :: Term3
</span><a href="#local-6989586621679439736"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679439735"><span class="annot"><span class="annottext">sized :: Term4
</span><a href="#local-6989586621679439735"><span class="hs-identifier hs-var hs-var">sized</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term3 -&gt; Term4
</span><a href="Telomare.Eval.html#findChurchSize"><span class="hs-identifier hs-var">findChurchSize</span></a></span><span> </span><span class="annot"><span class="annottext">Term3
</span><a href="#local-6989586621679439736"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-120"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Maybe String
</span><a href="Telomare.Eval.html#runStaticChecks"><span class="hs-identifier hs-var">runStaticChecks</span></a></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679439735"><span class="hs-identifier hs-var">sized</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-121"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Maybe IExpr
forall a. TelomareLike a =&gt; a -&gt; Maybe IExpr
</span><a href="Telomare.html#toTelomare"><span class="hs-identifier hs-var">toTelomare</span></a></span><span> </span><span class="annot"><span class="annottext">(Term4 -&gt; Maybe IExpr) -&gt; Term4 -&gt; Maybe IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term4 -&gt; Term4
</span><a href="Telomare.Eval.html#removeChecks"><span class="hs-identifier hs-var">removeChecks</span></a></span><span> </span><span class="annot"><span class="annottext">Term4
</span><a href="#local-6989586621679439735"><span class="hs-identifier hs-var">sized</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679439734"><span class="annot"><span class="annottext">i :: IExpr
</span><a href="#local-6989586621679439734"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Either EvalError IExpr
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439734"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-123"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="Telomare.Eval.html#CompileConversionError"><span class="hs-identifier hs-var">CompileConversionError</span></a></span><span>
</span><span id="line-124"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679439733"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679439733"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; Either EvalError IExpr
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(EvalError -&gt; Either EvalError IExpr)
-&gt; EvalError -&gt; Either EvalError IExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; EvalError
</span><a href="Telomare.Eval.html#StaticCheckError"><span class="hs-identifier hs-var">StaticCheckError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439733"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-125"></span><span class="hs-comment">{-
findAllSizes :: Term2 -&gt; (Bool, Term3)
findAllSizes = let doChild (True, x) = TTransformedGrammar $ findChurchSize x
                   doChild (_, x) = TTransformedGrammar $ convertPT 0 x
                   doChildren l = let nl = map findAllSizes l
                                  in case sum (map (fromEnum . fst) nl) of
                                       0 -&gt; (False, map snd nl)
                                       1 -&gt; (True, map snd nl)
                                       _ -&gt; (False, map doChild nl)
               in \case
  TZero -&gt; (False, TZero)
  TPair a b -&gt; let (c, [na, nb]) = doChildren [a,b] in (c, TPair na nb)
  TVar n -&gt; (False, TVar n)
  TApp a b -&gt; let (c, [na, nb]) = doChildren [a,b] in (c, TApp na nb)
  TCheck a b -&gt; let (c, [na, nb]) = doChildren [a,b] in (c, TCheck na nb)
  TITE i t e -&gt; let (c, [ni, nt, ne]) = doChildren [i,t,e] in (c, TITE ni nt ne)
  TLeft x -&gt; TLeft &lt;$&gt; findAllSizes x
  TRight x -&gt; TRight &lt;$&gt; findAllSizes x
  TTrace x -&gt; TTrace &lt;$&gt; findAllSizes x
  TLam lt x -&gt; TLam lt &lt;$&gt; findAllSizes x
  TLimitedRecursion -&gt; (True, TLimitedRecursion)
-}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-type">evalLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span id="evalLoop"><span class="annot"><span class="annottext">evalLoop :: IExpr -&gt; IO ()
</span><a href="Telomare.Eval.html#evalLoop"><span class="hs-identifier hs-var hs-var">evalLoop</span></a></span></span><span> </span><span id="local-6989586621679439731"><span class="annot"><span class="annottext">iexpr :: IExpr
</span><a href="#local-6989586621679439731"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Either String IExpr
</span><a href="Telomare.Eval.html#eval%27"><span class="hs-identifier hs-var">eval'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439731"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679439730"><span class="annot"><span class="annottext">err :: String
</span><a href="#local-6989586621679439730"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; IO ()) -&gt; [String] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;Failed compiling main, &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439730"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679439726"><span class="annot"><span class="annottext">peExp :: IExpr
</span><a href="#local-6989586621679439726"><span class="hs-identifier hs-var">peExp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679439725"><span class="annot"><span class="annottext">mainLoop :: IExpr -&gt; IO ()
</span><a href="#local-6989586621679439725"><span class="hs-identifier hs-var hs-var">mainLoop</span></a></span></span><span> </span><span id="local-6989586621679439724"><span class="annot"><span class="annottext">s :: IExpr
</span><a href="#local-6989586621679439724"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>          </span><span class="hs-comment">-- result &lt;- optimizedEval (app peExp s)</span><span>
</span><span id="line-154"></span><span>          </span><span id="local-6989586621679439723"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439723"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#simpleEval"><span class="hs-identifier hs-var">simpleEval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439726"><span class="hs-identifier hs-var">peExp</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439724"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439723"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>            </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;aborted&quot;</span></span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679439720"><span class="annot"><span class="annottext">disp :: IExpr
</span><a href="#local-6989586621679439720"><span class="hs-identifier hs-var">disp</span></a></span></span><span> </span><span id="local-6989586621679439719"><span class="annot"><span class="annottext">newState :: IExpr
</span><a href="#local-6989586621679439719"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; (IExpr -&gt; String) -&gt; IExpr -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
</span><a href="Telomare.html#g2s"><span class="hs-identifier hs-var">g2s</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IO ()) -&gt; IExpr -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439720"><span class="hs-identifier hs-var">disp</span></a></span><span>
</span><span id="line-159"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439719"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-160"></span><span>                </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;done&quot;</span></span><span>
</span><span id="line-161"></span><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>                  </span><span id="local-6989586621679439717"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439717"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr
</span><a href="Telomare.html#s2g"><span class="hs-identifier hs-var">s2g</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IExpr) -&gt; IO String -&gt; IO IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getLine</span></span><span>
</span><span id="line-163"></span><span>                  </span><span class="annot"><span class="annottext">IExpr -&gt; IO ()
</span><a href="#local-6989586621679439725"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IO ()) -&gt; IExpr -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439717"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439719"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span id="local-6989586621679439714"><span class="annot"><span class="annottext">r :: IExpr
</span><a href="#local-6989586621679439714"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;runtime error, dumped &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439714"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO ()
</span><a href="#local-6989586621679439725"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- |Same as `evalLoop`, but keeping what was displayed.</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-type">evalLoop_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Telomare.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-169"></span><span id="evalLoop_"><span class="annot"><span class="annottext">evalLoop_ :: IExpr -&gt; IO String
</span><a href="Telomare.Eval.html#evalLoop_"><span class="hs-identifier hs-var hs-var">evalLoop_</span></a></span></span><span> </span><span id="local-6989586621679439712"><span class="annot"><span class="annottext">iexpr :: IExpr
</span><a href="#local-6989586621679439712"><span class="hs-identifier hs-var">iexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; Either String IExpr
</span><a href="Telomare.Eval.html#eval%27"><span class="hs-identifier hs-var">eval'</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439712"><span class="hs-identifier hs-var">iexpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679439711"><span class="annot"><span class="annottext">err :: String
</span><a href="#local-6989586621679439711"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String)
-&gt; ([String] -&gt; String) -&gt; [String] -&gt; IO String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; IO String) -&gt; [String] -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;Failed compiling main, &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439711"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679439710"><span class="annot"><span class="annottext">peExp :: IExpr
</span><a href="#local-6989586621679439710"><span class="hs-identifier hs-var">peExp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679439709"><span class="annot"><span class="annottext">mainLoop :: String -&gt; IExpr -&gt; IO String
</span><a href="#local-6989586621679439709"><span class="hs-identifier hs-var hs-var">mainLoop</span></a></span></span><span> </span><span id="local-6989586621679439708"><span class="annot"><span class="annottext">prev :: String
</span><a href="#local-6989586621679439708"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span id="local-6989586621679439707"><span class="annot"><span class="annottext">s :: IExpr
</span><a href="#local-6989586621679439707"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>          </span><span class="hs-comment">-- result &lt;- optimizedEval (app peExp s)</span><span>
</span><span id="line-174"></span><span>          </span><span id="local-6989586621679439706"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439706"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IO IExpr
</span><a href="Telomare.RunTime.html#simpleEval"><span class="hs-identifier hs-var">simpleEval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439710"><span class="hs-identifier hs-var">peExp</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439707"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439706"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-176"></span><span>            </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439708"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;aborted&quot;</span></span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Telomare.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621679439705"><span class="annot"><span class="annottext">disp :: IExpr
</span><a href="#local-6989586621679439705"><span class="hs-identifier hs-var">disp</span></a></span></span><span> </span><span id="local-6989586621679439704"><span class="annot"><span class="annottext">newState :: IExpr
</span><a href="#local-6989586621679439704"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679439703"><span class="annot"><span class="annottext">d :: String
</span><a href="#local-6989586621679439703"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
</span><a href="Telomare.html#g2s"><span class="hs-identifier hs-var">g2s</span></a></span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; String) -&gt; IExpr -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439705"><span class="hs-identifier hs-var">disp</span></a></span><span>
</span><span id="line-179"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439704"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>                </span><span class="annot"><a href="Telomare.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439708"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439703"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\ndone&quot;</span></span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>                  </span><span id="local-6989586621679439702"><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439702"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr
</span><a href="Telomare.html#s2g"><span class="hs-identifier hs-var">s2g</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IExpr) -&gt; IO String -&gt; IO IExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getLine</span></span><span>
</span><span id="line-183"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; IO String
</span><a href="#local-6989586621679439709"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439708"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679439703"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IExpr -&gt; IO String) -&gt; IExpr -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; IExpr -&gt; IExpr
</span><a href="Telomare.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439702"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439704"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-184"></span><span>            </span><span id="local-6989586621679439701"><span class="annot"><span class="annottext">r :: IExpr
</span><a href="#local-6989586621679439701"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;runtime error, dumped &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IExpr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="#local-6989586621679439701"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; IExpr -&gt; IO String
</span><a href="#local-6989586621679439709"><span class="hs-identifier hs-var">mainLoop</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">IExpr
</span><a href="Telomare.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-186"></span></pre></body></html>