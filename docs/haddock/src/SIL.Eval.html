<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">SIL.Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Except.html"><span class="hs-identifier">Control.Monad.Except</span></a><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><a href="SIL.html"><span class="hs-identifier">SIL</span></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><a href="SIL.RunTime.html"><span class="hs-identifier">SIL.RunTime</span></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><a href="SIL.TypeChecker.html"><span class="hs-identifier">SIL.TypeChecker</span></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="SIL.Optimizer.html"><span class="hs-identifier">SIL.Optimizer</span></a><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">data</span><span> </span><a name="ExpP"><a href="SIL.Eval.html#ExpP"><span class="hs-identifier">ExpP</span></a></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ZeroP"><a href="SIL.Eval.html#ZeroP"><span class="hs-identifier">ZeroP</span></a></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PairP"><a href="SIL.Eval.html#PairP"><span class="hs-identifier">PairP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VarP"><a href="SIL.Eval.html#VarP"><span class="hs-identifier">VarP</span></a></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SetEnvP"><a href="SIL.Eval.html#SetEnvP"><span class="hs-identifier">SetEnvP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DeferP"><a href="SIL.Eval.html#DeferP"><span class="hs-identifier">DeferP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AbortP"><a href="SIL.Eval.html#AbortP"><span class="hs-identifier">AbortP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GateP"><a href="SIL.Eval.html#GateP"><span class="hs-identifier">GateP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LeftP"><a href="SIL.Eval.html#LeftP"><span class="hs-identifier">LeftP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RightP"><a href="SIL.Eval.html#RightP"><span class="hs-identifier">RightP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TraceP"><a href="SIL.Eval.html#TraceP"><span class="hs-identifier">TraceP</span></a></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span class="hs-special">,</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">,</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">instance</span><span> </span><a href="SIL.html#EndoMapper"><span class="hs-identifier hs-type">EndoMapper</span></a><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-24"></a><span>  </span><a name="local-8214565720323833196"><a href="SIL.html#endoMap"><span class="hs-identifier">endoMap</span></a></a><span> </span><a name="local-6989586621679190183"><a href="#local-6989586621679190183"><span class="hs-identifier">f</span></a></a><span> </span><a href="SIL.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190183"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="SIL.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190184"><a href="#local-6989586621679190184"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a><span> </span><a name="local-6989586621679190185"><a href="#local-6989586621679190185"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679190186"><a href="#local-6989586621679190186"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190184"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a><span> </span><span class="hs-special">(</span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190184"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190185"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190184"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190186"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190187"><a href="#local-6989586621679190187"><span class="hs-identifier">f</span></a></a><span> </span><a href="SIL.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190187"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="SIL.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190188"><a href="#local-6989586621679190188"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a><span> </span><a name="local-6989586621679190189"><a href="#local-6989586621679190189"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679190190"><a href="#local-6989586621679190190"><span class="hs-identifier">fe</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190188"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a><span> </span><span class="hs-special">(</span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190188"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190189"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679190190"><span class="hs-identifier hs-var">fe</span></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190191"><a href="#local-6989586621679190191"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a><span> </span><a name="local-6989586621679190192"><a href="#local-6989586621679190192"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190191"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190191"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190192"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190193"><a href="#local-6989586621679190193"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#AbortP"><span class="hs-identifier hs-var">AbortP</span></a><span> </span><a name="local-6989586621679190194"><a href="#local-6989586621679190194"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190193"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.Eval.html#AbortP"><span class="hs-identifier hs-var">AbortP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190193"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190194"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190195"><a href="#local-6989586621679190195"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a><span> </span><a name="local-6989586621679190196"><a href="#local-6989586621679190196"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190195"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190195"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190196"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190197"><a href="#local-6989586621679190197"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a><span> </span><a name="local-6989586621679190198"><a href="#local-6989586621679190198"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190197"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190197"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190198"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190199"><a href="#local-6989586621679190199"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a><span> </span><a name="local-6989586621679190200"><a href="#local-6989586621679190200"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190199"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190199"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190200"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-identifier">endoMap</span><span> </span><a name="local-6989586621679190201"><a href="#local-6989586621679190201"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a><span> </span><a name="local-6989586621679190202"><a href="#local-6989586621679190202"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679190201"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.html#endoMap"><span class="hs-identifier hs-var">endoMap</span></a><span> </span><a href="#local-6989586621679190201"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190202"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">data</span><span> </span><a name="EvalError"><a href="SIL.Eval.html#EvalError"><span class="hs-identifier">EvalError</span></a></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="RTE"><a href="SIL.Eval.html#RTE"><span class="hs-identifier">RTE</span></a></a><span> </span><a href="SIL.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TCE"><a href="SIL.Eval.html#TCE"><span class="hs-identifier">TCE</span></a></a><span> </span><a href="SIL.TypeChecker.html#TypeCheckError"><span class="hs-identifier hs-type">TypeCheckError</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span class="hs-special">,</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span class="hs-special">,</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">type</span><span> </span><a name="ExpFullEnv"><a href="SIL.Eval.html#ExpFullEnv"><span class="hs-identifier">ExpFullEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#ExprA"><span class="hs-identifier hs-type">ExprA</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SIL.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">,</span><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><a name="annotateEnv"><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier">annotateEnv</span></a></a><span> </span><a href="SIL.html#Zero"><span class="hs-identifier hs-var">Zero</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">,</span><span> </span><a href="SIL.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679190204"><a href="#local-6989586621679190204"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679190205"><a href="#local-6989586621679190205"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679190206"><a href="#local-6989586621679190206"><span class="hs-identifier">at</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679190207"><a href="#local-6989586621679190207"><span class="hs-identifier">na</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190204"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-46"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679190208"><a href="#local-6989586621679190208"><span class="hs-identifier">bt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679190209"><a href="#local-6989586621679190209"><span class="hs-identifier">nb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190205"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679190206"><span class="hs-identifier hs-var">at</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="#local-6989586621679190208"><span class="hs-identifier hs-var">bt</span></a><span class="hs-special">,</span><span> </span><a href="SIL.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a><span> </span><a href="#local-6989586621679190207"><span class="hs-identifier hs-var">na</span></a><span> </span><a href="#local-6989586621679190209"><span class="hs-identifier hs-var">nb</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-identifier">annotateEnv</span><span> </span><a href="SIL.html#Env"><span class="hs-identifier hs-var">Env</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a><span class="hs-special">,</span><span> </span><a href="SIL.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a><span> </span><a name="local-6989586621679190210"><a href="#local-6989586621679190210"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679190211"><a href="#local-6989586621679190211"><span class="hs-identifier">xt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679190212"><a href="#local-6989586621679190212"><span class="hs-identifier">nx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190210"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679190211"><span class="hs-identifier hs-var">xt</span></a><span class="hs-special">,</span><span> </span><a href="SIL.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a><span> </span><a href="#local-6989586621679190212"><span class="hs-identifier hs-var">nx</span></a><span> </span><a href="#local-6989586621679190211"><span class="hs-identifier hs-var">xt</span></a><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#Defer"><span class="hs-identifier hs-var">Defer</span></a><span> </span><a name="local-6989586621679190213"><a href="#local-6989586621679190213"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679190214"><a href="#local-6989586621679190214"><span class="hs-identifier">nx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190213"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">,</span><span> </span><a href="SIL.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a><span> </span><a href="#local-6989586621679190214"><span class="hs-identifier hs-var">nx</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679190215"><a href="#local-6989586621679190215"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#AbortP"><span class="hs-identifier hs-var">AbortP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190215"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-52"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#Gate"><span class="hs-identifier hs-var">Gate</span></a><span> </span><a name="local-6989586621679190216"><a href="#local-6989586621679190216"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190216"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-53"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a><span> </span><a name="local-6989586621679190217"><a href="#local-6989586621679190217"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190217"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-54"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#PRight"><span class="hs-identifier hs-var">PRight</span></a><span> </span><a name="local-6989586621679190218"><a href="#local-6989586621679190218"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190218"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-55"></a><span class="hs-identifier">annotateEnv</span><span> </span><span class="hs-special">(</span><a href="SIL.html#Trace"><span class="hs-identifier hs-var">Trace</span></a><span> </span><a name="local-6989586621679190219"><a href="#local-6989586621679190219"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="SIL.Eval.html#annotateEnv"><span class="hs-identifier hs-var">annotateEnv</span></a><span> </span><a href="#local-6989586621679190219"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">fromFullEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="#local-6989586621679190203"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679190203"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="SIL.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679190203"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="SIL.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a><span>
</span><a name="line-58"></a><a name="fromFullEnv"><a href="SIL.Eval.html#fromFullEnv"><span class="hs-identifier">fromFullEnv</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="SIL.Eval.html#ZeroP"><span class="hs-identifier hs-var">ZeroP</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="SIL.html#Zero"><span class="hs-identifier hs-var">Zero</span></a><span>
</span><a name="line-59"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190220"><a href="#local-6989586621679190220"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#PairP"><span class="hs-identifier hs-var">PairP</span></a><span> </span><a name="local-6989586621679190221"><a href="#local-6989586621679190221"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679190222"><a href="#local-6989586621679190222"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190220"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190221"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679190220"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190222"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-60"></a><span class="hs-identifier">fromFullEnv</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="SIL.Eval.html#VarP"><span class="hs-identifier hs-var">VarP</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="SIL.html#Env"><span class="hs-identifier hs-var">Env</span></a><span>
</span><a name="line-61"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190223"><a href="#local-6989586621679190223"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a><span> </span><a name="local-6989586621679190224"><a href="#local-6989586621679190224"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#SetEnv"><span class="hs-identifier hs-var">SetEnv</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190223"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190224"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-62"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190225"><a href="#local-6989586621679190225"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#DeferP"><span class="hs-identifier hs-var">DeferP</span></a><span> </span><a name="local-6989586621679190226"><a href="#local-6989586621679190226"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#Defer"><span class="hs-identifier hs-var">Defer</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190225"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190226"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-63"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190227"><a href="#local-6989586621679190227"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#AbortP"><span class="hs-identifier hs-var">AbortP</span></a><span> </span><a name="local-6989586621679190228"><a href="#local-6989586621679190228"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190227"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190228"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-64"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190229"><a href="#local-6989586621679190229"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#GateP"><span class="hs-identifier hs-var">GateP</span></a><span> </span><a name="local-6989586621679190230"><a href="#local-6989586621679190230"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#Gate"><span class="hs-identifier hs-var">Gate</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190229"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190230"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-65"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190231"><a href="#local-6989586621679190231"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#LeftP"><span class="hs-identifier hs-var">LeftP</span></a><span> </span><a name="local-6989586621679190232"><a href="#local-6989586621679190232"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#PLeft"><span class="hs-identifier hs-var">PLeft</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190231"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190232"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-66"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190233"><a href="#local-6989586621679190233"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#RightP"><span class="hs-identifier hs-var">RightP</span></a><span> </span><a name="local-6989586621679190234"><a href="#local-6989586621679190234"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#PRight"><span class="hs-identifier hs-var">PRight</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190233"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190234"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-67"></a><span class="hs-identifier">fromFullEnv</span><span> </span><a name="local-6989586621679190235"><a href="#local-6989586621679190235"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SIL.Eval.html#TraceP"><span class="hs-identifier hs-var">TraceP</span></a><span> </span><a name="local-6989586621679190236"><a href="#local-6989586621679190236"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#Trace"><span class="hs-identifier hs-var">Trace</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679190235"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679190236"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-identifier">partiallyEvaluate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SIL.Eval.html#ExpP"><span class="hs-identifier hs-type">ExpP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="SIL.html#RunTimeError"><span class="hs-identifier hs-type">RunTimeError</span></a><span> </span><a href="SIL.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a><span>
</span><a name="line-70"></a><a name="partiallyEvaluate"><a href="SIL.Eval.html#partiallyEvaluate"><span class="hs-identifier">partiallyEvaluate</span></a></a><span> </span><a name="local-6989586621679190237"><a href="#local-6989586621679190237"><span class="hs-identifier">se</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SIL.Eval.html#SetEnvP"><span class="hs-identifier hs-var">SetEnvP</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.html#Defer"><span class="hs-identifier hs-var">Defer</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><span class="hs-special">(</span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Function.html#fix"><span class="hs-identifier hs-var">fix</span></a><span> </span><a href="SIL.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a><span> </span><a href="#local-6989586621679190237"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-special">(</span><a href="SIL.RunTime.html#pureEval"><span class="hs-identifier hs-var">pureEval</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.Optimizer.html#optimize"><span class="hs-identifier hs-var">optimize</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-identifier">partiallyEvaluate</span><span> </span><a name="local-6989586621679190238"><a href="#local-6989586621679190238"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SIL.Eval.html#fromFullEnv"><span class="hs-identifier hs-var">fromFullEnv</span></a><span> </span><a href="SIL.Eval.html#partiallyEvaluate"><span class="hs-identifier hs-var">partiallyEvaluate</span></a><span> </span><a href="#local-6989586621679190238"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-identifier">eval'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SIL.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="SIL.Eval.html#EvalError"><span class="hs-identifier hs-type">EvalError</span></a><span> </span><a href="SIL.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a><span>
</span><a name="line-74"></a><a name="eval%27"><a href="SIL.Eval.html#eval%27"><span class="hs-identifier">eval'</span></a></a><span> </span><a name="local-6989586621679190239"><a href="#local-6989586621679190239"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="SIL.TypeChecker.html#inferType"><span class="hs-identifier hs-var">inferType</span></a><span> </span><a href="#local-6989586621679190239"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-75"></a><span>  </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-6989586621679190240"><a href="#local-6989586621679190240"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.Eval.html#TCE"><span class="hs-identifier hs-var">TCE</span></a><span> </span><a href="#local-6989586621679190240"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-comment">{-
  Right _ -&gt; case partiallyEvaluate (snd $ annotateEnv expr) of
    Left err -&gt; Left $ RTE err
    Right x -&gt; pure x
-}</span><span>
</span><a name="line-81"></a><span>  </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="#local-6989586621679190239"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">evalLoop</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SIL.html#IExpr"><span class="hs-identifier hs-type">IExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><a name="evalLoop"><a href="SIL.Eval.html#evalLoop"><span class="hs-identifier">evalLoop</span></a></a><span> </span><a name="local-6989586621679190241"><a href="#local-6989586621679190241"><span class="hs-identifier">iexpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="SIL.Eval.html#eval%27"><span class="hs-identifier hs-var">eval'</span></a><span> </span><a href="#local-6989586621679190241"><span class="hs-identifier hs-var">iexpr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-85"></a><span>  </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-6989586621679190242"><a href="#local-6989586621679190242"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Failed compiling main, &quot;</span><span class="hs-special">,</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-6989586621679190242"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">]</span><span>
</span><a name="line-86"></a><span>  </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621679190243"><a href="#local-6989586621679190243"><span class="hs-identifier">peExp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679190244"><a href="#local-6989586621679190244"><span class="hs-identifier">mainLoop</span></a></a><span> </span><a name="local-6989586621679190245"><a href="#local-6989586621679190245"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-88"></a><span>             </span><a name="local-6989586621679190246"><a href="#local-6989586621679190246"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="SIL.RunTime.html#optimizedEval"><span class="hs-identifier hs-var">optimizedEval</span></a><span> </span><span class="hs-special">(</span><a href="SIL.html#app"><span class="hs-identifier hs-var">app</span></a><span> </span><a href="#local-6989586621679190243"><span class="hs-identifier hs-var">peExp</span></a><span> </span><a href="#local-6989586621679190245"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>             </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679190246"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-90"></a><span>               </span><a href="SIL.html#Zero"><span class="hs-identifier hs-var">Zero</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a><span> </span><span class="hs-string">&quot;aborted&quot;</span><span>
</span><a name="line-91"></a><span>               </span><span class="hs-special">(</span><a href="SIL.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679190247"><a href="#local-6989586621679190247"><span class="hs-identifier">disp</span></a></a><span> </span><a name="local-6989586621679190248"><a href="#local-6989586621679190248"><span class="hs-identifier">newState</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-92"></a><span>                 </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SIL.html#g2s"><span class="hs-identifier hs-var">g2s</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679190247"><span class="hs-identifier hs-var">disp</span></a><span>
</span><a name="line-93"></a><span>                 </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679190248"><span class="hs-identifier hs-var">newState</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-94"></a><span>                   </span><a href="SIL.html#Zero"><span class="hs-identifier hs-var">Zero</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a><span> </span><span class="hs-string">&quot;done&quot;</span><span>
</span><a name="line-95"></a><span>                   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-96"></a><span>                     </span><a name="local-6989586621679190249"><a href="#local-6989586621679190249"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="SIL.html#s2g"><span class="hs-identifier hs-var">s2g</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/System.IO.html#getLine"><span class="hs-identifier hs-var">getLine</span></a><span>
</span><a name="line-97"></a><span>                     </span><a href="#local-6989586621679190244"><span class="hs-identifier hs-var">mainLoop</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SIL.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679190249"><span class="hs-identifier hs-var">inp</span></a><span> </span><a href="#local-6989586621679190248"><span class="hs-identifier hs-var">newState</span></a><span>
</span><a name="line-98"></a><span>               </span><a name="local-6989586621679190250"><a href="#local-6989586621679190250"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;runtime error, dumped &quot;</span><span class="hs-special">,</span><span> </span><a href="file:///nix/store/yybnkby6f92rkc095fyb4lqz4wfxw6nj-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-6989586621679190250"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679190244"><span class="hs-identifier hs-var">mainLoop</span></a><span> </span><a href="SIL.html#Zero"><span class="hs-identifier hs-var">Zero</span></a><span>
</span><a name="line-100"></a></pre></body></html>